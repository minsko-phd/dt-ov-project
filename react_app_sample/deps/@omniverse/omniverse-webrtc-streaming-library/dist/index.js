/*! For license information please see index.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["app-streamer"]=t():e["app-streamer"]=t()}(self,(()=>(()=>{var e={318:(e,t,i)=>{(()=>{var t={393:(e,t,i)=>{var n=class{constructor(e){this.$u$=new Map,this.$ca$=e}addListener(e,t){var i=this.$u$.get(e);void 0!==i?i.add(t):((i=new Set).add(t),this.$u$.set(e,i))}removeListener(e,t){null==(e=this.$u$.get(e))||e.delete(t)}removeAllListenersOfEvent(e){this.$u$.delete(e)}removeAllListeners(){this.$u$.clear()}hasListener(e){return void 0!==(e=this.$u$.get(e))&&0<e.size}emit(e,...t){try{let i=this.$u$.get(e);if(i)for(const e of i)this.$ca$?e(...t):window.setTimeout(e,0,...t)}catch(e){console.log("Exception in emit: "+e)}}},s=!0,o=!1;function r(e){if(e)switch(e){case"enable":case"on":case"1":case"true":return!0;case"disable":case"off":case"0":case"false":return!1}}function a(e,t,i,n,s){n=`${n}${function(...e){return e.length?`##${JSON.stringify(e)}`:""}(...s)}`,t={logModule:"R",timeStamp:$(),logLevel:t,logtag:i,logstr:n},e.commit(t)}function $(){var e=new Date;const t=(e,t,i)=>{if(0<(t-=e.length)){let n="";for(let e=0;e<t;e++)n+=i;return n+e}return e};return t(e.getFullYear().toString(),4,"0")+"-"+t((e.getMonth()+1).toString(),2,"0")+"-"+t(e.getDate().toString(),2,"0")+" "+t(e.getHours().toString(),2,"0")+":"+t(e.getMinutes().toString(),2,"0")+":"+t(e.getSeconds().toString(),2,"0")+"."+t(e.getMilliseconds().toString(),3,"0")}var c=class extends n{constructor(){super(!0),this.$g$=[],this.$h$=()=>{},this.$j$=(e,t,...i)=>a(this,"DEBUG",e,t,i),this.$o$=(e,t,...i)=>a(this,"INFO",e,t,i),this.$s$=(e,t,...i)=>a(this,"WARN",e,t,i),this.$l$=(e,t,...i)=>a(this,"ERROR",e,t,i),this.$m$=(e,...t)=>function(e,...t){return e.replace(/{(\d+)}/g,(function(e,i){return void 0!==t[i]?t[i]:e}))}(e,...t)}get d(){return o?console.debug.bind(console,"%s DEBUG [%s] %s@@",$()):s?this.$j$:this.$h$}get w(){return o?console.warn.bind(console,"%s WARN  [%s] %s@@",$()):s?this.$s$:this.$h$}get i(){return o?console.info.bind(console,"%s INFO  [%s] %s@@",$()):s?this.$o$:this.$h$}get e(){return o?console.error.bind(console,"%s ERROR [%s] %s@@",$()):this.$l$}sanitize(e){if(!e)return e;const t=[{$secretBlock$:/(partnerCustomData" *: *")((\\"|[^"])*)(?=")/g,$replaceStr$:"$1***"},{$secretBlock$:/("clientIp" *: *")(\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?=")/g,$replaceStr$:"$1***"}];for(const i of t)e=e.replace(i.$secretBlock$,i.$replaceStr$);return e}get format(){return this.$m$}commit(e){this.hasListener("Log")?this.emit("Log",e):this.$g$.push(e)}addListener(e,t){if(super.addListener(e,t),"Log"==e&&0<this.$g$.length){for(const e of this.$g$)this.commit(e);this.$g$=[]}}},d=new c,l=i(754);function u(){return p||(p=new m),p}function h(e,t,i){const n=e.$g$.startSpan(t);return l.context.with(l.trace.setSpan(l.context.active(),n),(async()=>{try{const e=i();return e instanceof Promise?await e:e}finally{n.end()}}))}var p,m=class{constructor(){this.$g$=l.trace.getTracer("gfn-web-gamestream","2.0")}},f=class{constructor(e,t){var i;this.$g$=0,this.$h$=this.$o$=!1,this.promise=new Promise(((e,t)=>{this.$v$=e,this.$m$=t})),null!=t&&t.aborted?(this.$h$=!0,this.$m$()):(this.$j$=t,this.$l$=this.$s$.bind(this),null===(i=this.$j$)||void 0===i||i.addEventListener("abort",this.$l$),this.$g$=window.setTimeout(this.$u$.bind(this),e))}cancel(){var e;null===(e=this.$j$)||void 0===e||e.removeEventListener("abort",this.$l$),this.$g$&&(window.clearTimeout(this.$g$),this.$g$=0),this.$j$=void 0}$s$(){this.$h$=!0,this.$m$(),this.cancel()}$u$(){this.$o$=!0,this.$v$(),this.$g$=0,this.cancel()}};function g(e){return e.split("\nm=").map(((e,t)=>(0<t?"m="+e:e).trim()+"\r\n"))}function v(e,t){return(i=e,i.trim().split("\n").map((e=>e.trim()))).filter((e=>0===e.indexOf(t)));var i}function A(e){return{algorithm:(e=e.substr(14).split(" "))[0].toLowerCase(),value:e[1].toUpperCase()}}function b(e){return"Xbox"===e.os&&"Edge"===e.browser}function w(e){return"iOS"===e.os||"iPadOS"===e.os}function S(e){return!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)}function y(e){return"0x"+("00000000"+(e>>>0).toString(16).toUpperCase()).slice(-8)}function k(e){return e?"iOS"===e.os:/iPhone|iPod/.test(navigator.userAgent)}function C(e){return"WebOS"===e.os}function _(e){return"ChromeOS"===e.os}function E(e){return"Windows"===e.os}function T(e){return"macOS"===e.os}var I={method:"GET",headers:{},body:"",$retryCount$:0,timeout:0,keepalive:!1};function P(){const e=l.trace.getActiveSpan();e&&e.setAttribute("error","true")}function j(e,t=I,i,n){var s;const o=null!==(s=t.method)&&void 0!==s?s:"GET";return h(u(),o,(()=>{var s=t.headers;const r=l.trace.getActiveSpan();if(r){var a=new Map([["component","rtcutils-core"],["component.version","2.0"],["http.method",o],["http.url",e],["type",""],["http.hostname",""],["http.path",""]]);try{const t=new URL(e);a.set("type",t.protocol),a.set("http.hostname",t.hostname),a.set("http.path",t.pathname)}catch(e){d.e("{d988e7f}","{997fb3a}")}for(const[e,t]of a)r.setAttribute(e,t);r.setAttributes(s)}return function(e,t=I,i,n){var s,o;let r=void 0===t.$retryCount$?1:t.$retryCount$+1;const a=r,$=null!==(s=t.$backOffDelay$)&&void 0!==s?s:500;let c=$;const u=null!==(o=t.method)&&void 0!==o?o:"GET";let h=new Headers;const p=null!=n?n:new AbortController;return(e=>{if(e)switch(e.type){case 1:e.token&&h.set("authorization","GFNJWT "+e.token);break;case 2:e.token&&h.set("authorization","GFNPartnerJWT auth="+e.token)}void 0!==t.headers&&Object.keys(t.headers).forEach((e=>{h.set(e,t.headers[e])})),e={},l.propagation.inject(l.context.active(),e);for(const[t,i]of Object.entries(e))h.set(t,i)})(i),new Promise(((i,n)=>{const s=e=>{P(),n(e)},o=()=>{if(navigator.onLine){let m,g={method:u,headers:h,mode:"cors",keepalive:t.keepalive,signal:p.signal};"GET"!==u&&"HEAD"!==u&&(g.body=t.body);const v=[0,DOMException.NETWORK_ERR,DOMException.TIMEOUT_ERR,503],A=t.timeout?new f(t.timeout):void 0,b=[];b.push(fetch(e,g)),A&&b.push(A.promise),Promise.race(b).then((t=>{if(null!=A&&A.$o$)throw d.w("{d988e7f}","{5a69b89}",e),{code:DOMException.TIMEOUT_ERR,message:"Timeout while performing HTTP request"};if(t instanceof globalThis.Response)return m=t.status,t.text()})).then((e=>{if(!e&&v.includes(m)){if(1<r)throw{code:m,message:"Internal server error."};d.w("{d988e7f}","{d639e52}",m,a)}var t=(e={status:m,data:null!=e?e:"",$retries$:a-r}).status;const n=l.trace.getActiveSpan();n&&(n.setAttribute("error","false"),n.setAttribute("http.status_code",t.toString())),i(e)})).catch((e=>{const i=e=>[0,DOMException.NETWORK_ERR,DOMException.TIMEOUT_ERR].includes(e)?(d.d("{d988e7f}","{0a9fabe}"),3237089282):e==DOMException.ABORT_ERR?(d.d("{d988e7f}","{235387a}"),15867905):(d.w("{d988e7f}","{f116c88}",e),3237089284);d.d("{d988e7f}","{ec768a1}",JSON.stringify(e),e),0==(e=(e=>{let t=0;return null!=e&&e.code?t=null==e?void 0:e.code:null!=e&&e.name&&("AbortError"===e.name?t=DOMException.ABORT_ERR:"NetworkError"===e.name?t=DOMException.NETWORK_ERR:"TimeoutError"===e.name&&(t=DOMException.TIMEOUT_ERR)),t})(e))&&t.keepalive&&(t.keepalive=!1),v.includes(e)?(e=>{if(1<r){r--,d.d("{d988e7f}","{97555ed}",e,r);const t=new f(c,p.signal);return t.promise.then(o).catch((e=>{t.$h$?(e={code:15867905,$retries$:a-r},P(),n(e)):(d.w("{d988e7f}","{d3ca39d}",JSON.stringify(e)),e={code:3237089284,$retries$:a-r},P(),n(e))})),c+=$,!0}return!1})(e)||(d.w("{d988e7f}","{dff1a05}",a,e),s({code:i(e),$retries$:a-r})):s({code:i(e),$retries$:a-r})})).finally((()=>{null==A||A.cancel()}))}else s({code:3237089281,description:"No network",$retries$:a-r})};o()}))}(e,t,i,n)}))}function R(){var e,t;return null===(t=null===(e=window.matchMedia)||void 0===e?void 0:e.call(window,"(pointer:coarse)"))||void 0===t?void 0:t.matches}function D(){var e,t;return!!window.TouchEvent&&(null===(t=null===(e=window.matchMedia)||void 0===e?void 0:e.call(window,"(any-pointer:coarse)"))||void 0===t?void 0:t.matches)}function x(e){return"Tizen"===e.os||"WebOS"===e.os}function M(){let e=new Uint8Array(36);window.crypto.getRandomValues(e);let t="";for(let i=0;36>i;i++){let n=e[i]%16;8==i||13==i||18==i||23==i?t+="-":14==i?t+="4":(19==i&&(n=3&n|8),t+=n.toString(16))}return d.i("{d988e7f}","{534eaf4}",t),t}function L(e,t){for(let i=0;i<t.length&&i<e.length;++i){const n=e[i],s=t[i];if(n>s)break;if(n<s)return!1}return!0}function O(e,t,i,n,s){if("Chrome"!=e.browser)return!1;t=[t,null!=i?i:0,null!=n?n:0,null!=s?s:0];try{return L(e.browserFullVer.split(".").map((e=>Number.parseInt(e))),t)}catch(e){d.w("{d988e7f}","{bcd8f94}")}return!0}function B(e,t,i,n){if(!w(e))return!1;const s=[i,null!=n?n:0];try{const i=e.osVer.replace(/[^0-9.]/,"").split(".").map((e=>Number.parseInt(e)));return 1===i.length&&i.push(0),t?i.every(((e,t)=>e===s[t])):L(i,s)}catch(e){d.w("{d988e7f}","{cf4149f}")}return!t}function N(e,t,i){return{code:e,description:t,error:null!==i?i:void 0}}function F(e,t){var i=K,n=J;let s=[];var o=e;let r=[];do{r.push(o),o=Object.getPrototypeOf(o)}while(""!=o.name);r.reverse();for(let e of r)s.push(e.toString().replace(/(extends )[^ {]*\.([^ ]*[ {])/,"$1$2"));return s.push(`${i.toString()}`),t?(s.push(`${t.toString()}`),s.push(`onconnect = (event) => { ${t.name}(${e.name}, event, ${i.name}); };`)):s.push(`onmessage = (event) => { ${i.name}(${e.name}, event); };`),s.push(`${n.toString()}`),s.push(`onerror = (event) => { ${n.name}(event); };`),URL.createObjectURL(new Blob(s,{type:"text/javascript"}))}function V(e,t,i){if(!e.prototype.$doWork$)throw Error("Invalid Worker class provided");e=F(e);const n=new Worker(e);URL.revokeObjectURL(e),z(n,t,i)}function U(e,t,i){var n=window;if(void 0===n.SharedWorker)throw Error("SharedWorker not supported");if(!e.prototype.$doWork$)throw Error("Invalid Worker class provided");return e=F(e,W),n=new n.SharedWorker(e),URL.revokeObjectURL(e),z(n,t,i),n}const G=new Map;function H(e){if(!G.has(e)){e.postMessage.bind(e)({$cmd$:2,data:null});var t=window.setTimeout((()=>{const t=G.get(e);t&&(clearTimeout(t),G.delete(e)),e instanceof Worker?e.terminate():e instanceof MessagePort&&e.close()}),150);G.set(e,t)}}function z(e,t,i){const n="port"in e?e.port:e,s=n.postMessage.bind(n);let o=!1;const r=e=>{o||(o=!0,d.e("{10ca8e2}","{03baf25}",e,typeof e),H(n),i(e))};n.onmessage=e=>{let i=(e=e.data).data;switch(e.$cmd$){case 1:s({$cmd$:3,data:null});break;case 4:t(i),H(n);break;case 5:r(i)}},"onmessageerror"in n&&(n.onmessageerror=r),e.onerror=r,s({$cmd$:0,data:null})}function W(e,t,i){const n=globalThis;n.port=t.ports[0],n.port.onmessage=i.bind(self,e)}function K(e,t){var i;const n=globalThis;n.$msgHandlers$=null!==(i=n.$msgHandlers$)&&void 0!==i?i:{},t=(i=t.data).$cmd$,i=i.data;let s="port"in n?n.port:self;switch(t){case 0:var o=new e;n.$msgHandlers$[e.name]=o,s.postMessage({$cmd$:1,data:null});break;case 2:null===(o=null===self||void 0===self?void 0:self.close)||void 0===o||o.call(self);break;case 3:Promise.resolve(n.$msgHandlers$[e.name].$doWork$()).then((e=>{s.postMessage({$cmd$:4,data:e})}));break;default:throw Error(`Unknown message: ${t}:${i}`)}}function J(e){const t=globalThis;("port"in t?t.port:self).postMessage({$cmd$:5,data:e})}function q(e){return e.start=performance.now(),new Promise((t=>{e.$rb$?t(e.$platformDetails$):async function(e){var t,i,n,s,o,r=Promise,a=r.all,$=(s=e,new Promise((e=>{let t=!1;const i=i=>{if(s.$$$)clearTimeout(s.$$$),s.$$$=0;else if(t)return d.w("{3c72abb}","{c1bb269}"),void Q(s,"GL",s.$Ua$-performance.now());if(!s.$Ma$){var n=i.$rendererName$;n.includes("SraKmd")?(s.$D$=!0,n.includes("SraKmd_arden")&&(s.$oa$=!0),(n=/D3D11-(\d{2,}\.\d{1,}\.\d{5,}\.\d{4,})/.exec(n))&&1<n.length&&(s.$v$=n[1])):n.includes("AMD VANGOGH")&&(s.$Fa$=!0),s.$Va$=i.$present$,s.$Ma$=!0}e()};let n=!1,o=!1;const r=e=>{"string"==typeof e?Z(s,"GL",e):"data"in e?ee(s,"GL",e):te(s,"GL",e),o=!0,d.e("{3c72abb}","{9e45306}",e)};let a=0;try{self.OffscreenCanvas&&(n=!0,V(ge,i,r),a=150)}catch(e){o=!0,ie(s,"GL",e),d.w("{3c72abb}","{caf8cd7}",e)}window.setTimeout((()=>{s.$Ma$||(s.$$$=window.setTimeout((()=>{s.$$$=0,s.$Ua$=performance.now(),o?d.w("{3c72abb}","{fbe663c}"):n?(d.w("{3c72abb}","{2577061}"),ne(s,"GL")):(d.i("{3c72abb}","{95c252e}"),se(s,"GL"));const e=(new ge).$doWork$();i(e),t=!0}),a))}),0)}))),c=(n=e,new Promise((e=>{if(navigator.userAgentData){n.$aa$=!0;var t=t=>{t&&(n.$ha$&&(clearTimeout(n.$ha$),n.$ha$=0),(e=>{var t;if(!n.$sb$){var i=e.model,s=e.platform,o=e.platformVersion,r=e.uaFullVersion,a=e.bitness;""==i&&""==s&&""==o&&""==r?n.$Ea$&&n.$U$||n.$pa$||null==a||(n.$s$=!0):""==a&&"Android"!=s&&(n.$s$=!0),i&&("Xbox"===i?n.$P$=!0:i.startsWith("AFT")?(n.$fb$=!0,n.$H$=!0):i.includes("BRAVIA")?(n.$H$=!0,n.$cb$=!0):"Chromecast"===i?(n.$H$=!0,n.$eb$=!0,n.deviceName="CHROMECAST"):"SHIELD Android TV"===i?(n.$H$=!0,n.$ib$=!0,n.deviceName="SHIELDTV"):i.startsWith("MiTV")?(n.$H$=!0,n.$gb$=!0,n.deviceName="MITV"):i.startsWith("TVision")&&(n.$H$=!0,n.$jb$=!0,n.deviceName="TVISION")),"Windows"===s?n.$J$=!0:"macOS"===s?n.$F$=!0:"Chrome OS"===s||"ChromeOS"===s?n.$I$=!0:"Chromium OS"===s?n.$S$=!0:"Android"===s?n.$R$=!0:"Linux"===s&&(""==o?(n.$R$=!0,n.$kb$=!0):n.$da$=!0),i=e=>{if(e&&"string"==typeof e)return e.replace(/[-._,:;|#@]/g,".")},s=e=>n.$J$&&!n.$P$?(e=>{if(!e||!n.$ga$||95>+n.$ga$)return e;switch(e.split(".").map((e=>Number.parseInt(e)))[0]){case 0:return"8-";case 1:return"10.0.10240";case 2:return"10.0.10586";case 3:return"10.0.14393";case 4:return"10.0.15063";case 5:return"10.0.16299";case 6:return"10.0.17134";case 7:return"10.0.17763";case 8:return"10.0.18362+";case 9:return"10.0.9";case 10:return"10.0.19041+";case 11:return"10.0.11";case 12:return"10.0.12";case 13:return"11.0.0";case 14:return"11.0.22000.0";case 15:return"11.0.22621.0";default:return"11.0.22621.0+"}})(e):e,e.brands&&function(e,t){var i;e.$aa$=!0,t.mobile&&(e.$Ga$=!0);var n=t.brands||[];t=0;for(const s of n){n=s.brand;const o=s.version;"Google Chrome"===n?(e.$ia$=!0,e.$o$=o):"Microsoft Edge"===n?(e.$za$=!0,e.$o$=o):"Opera"===n?(e.$ja$=!0,e.$o$=o):"Yandex"===n?(e.$Aa$=!0,e.$o$=o):"Chromium"===n?(e.$N$=!0,e.$o$=null!==(i=e.$o$)&&void 0!==i?i:o,e.$ga$=o):t++}2<t&&(e.$Wa$=!0)}(n,e),n.browserFullVer=i(r),n.$cc$=o,n.$v$=null!==(t=n.$v$)&&void 0!==t?t:s(i(o)),n.$sb$=!0}})(t),e())},i=!1,s=!1,o=0;try{if(self.SharedWorker){i=!0;var r=U(ve,t,(e=>{"string"==typeof e?Z(n,"HE",e):"data"in e?ee(n,"HE",e):te(n,"HE",e),s=!0,d.e("{3c72abb}","{217e106}",e)}));o=300}}catch(e){s=!0,d.w("{3c72abb}","{a583546}",e),ie(n,"HE",e)}n.$ha$=window.setTimeout((()=>{r&&H("port"in r?r.port:r),s?d.w("{3c72abb}","{dbf4b42}"):i?(d.w("{3c72abb}","{0bf7a38}"),ne(n,"HE"),n.$Ra$=!0):(d.i("{3c72abb}","{7a82b59}"),se(n,"HE")),(new ve).$doWork$().then((e=>{t(e)}))}),o)}else e()}))),l=async function(e){e.$Pa$=!!window.chrome&&await async function(){if(!window.createImageBitmap)return!1;const e=await fetch("data:image/avif;base64,AAAAGGZ0eXBhdmlmAAAAAGF2aWZtaWYxAAADm21ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAHBpY3QAAAAAAAAAAAAAAAAAAAAADnBpdG0AAAAAAAEAAAAiaWxvYwAAAABEQAABAAEAAAAAA7sAAQAAAAAAAAAjAAAAI2lpbmYAAAAAAAEAAAAVaW5mZQIAAAAAAQAAYXYwMQAAAAMbaXBycAAAAvxpcGNvAAACrGNvbHJwcm9mAAACoGxjbXMEMAAAbW50clJHQiBYWVogB+UACAAJAAsAEAAFYWNzcE1TRlQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPbWAAEAAAAA0y1sY21zAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANZGVzYwAAASAAAABAY3BydAAAAWAAAAA2d3RwdAAAAZgAAAAUY2hhZAAAAawAAAAsclhZWgAAAdgAAAAUYlhZWgAAAewAAAAUZ1hZWgAAAgAAAAAUclRSQwAAAhQAAAAgZ1RSQwAAAhQAAAAgYlRSQwAAAhQAAAAgY2hybQAAAjQAAAAkZG1uZAAAAlgAAAAkZG1kZAAAAnwAAAAkbWx1YwAAAAAAAAABAAAADGVuVVMAAAAkAAAAHABHAEkATQBQACAAYgB1AGkAbAB0AC0AaQBuACAAcwBSAEcAQm1sdWMAAAAAAAAAAQAAAAxlblVTAAAAGgAAABwAUAB1AGIAbABpAGMAIABEAG8AbQBhAGkAbgAAWFlaIAAAAAAAAPbWAAEAAAAA0y1zZjMyAAAAAAABDEIAAAXe///zJQAAB5MAAP2Q///7of///aIAAAPcAADAblhZWiAAAAAAAABvoAAAOPUAAAOQWFlaIAAAAAAAACSfAAAPhAAAtsRYWVogAAAAAAAAYpcAALeHAAAY2XBhcmEAAAAAAAMAAAACZmYAAPKnAAANWQAAE9AAAApbY2hybQAAAAAAAwAAAACj1wAAVHwAAEzNAACZmgAAJmcAAA9cbWx1YwAAAAAAAAABAAAADGVuVVMAAAAIAAAAHABHAEkATQBQbWx1YwAAAAAAAAABAAAADGVuVVMAAAAIAAAAHABzAFIARwBCAAAADGF2MUOBDQwAAAAAFGlzcGUAAAAAAAAAEAAAABAAAAAoY2xhcAAAAAEAAAABAAAAAQAAAAH////xAAAAAv////EAAAACAAAAF2lwbWEAAAAAAAAAAQABBIGCA4QAAAArbWRhdBIACgkfzP/IIEBA0oAyFGW+OwPr0bIHHHHBATZPtaQ3RWTA").then((e=>e.blob()));return createImageBitmap(e).then((()=>!0),(()=>!1))}()}(e),u=function(e){const t=window.speechSynthesis;if(t){const i=t.getVoices;let n=(null==i?void 0:i.call(t))||[];return new Promise((s=>{if(!i||n.length)Y(e,n),s();else{let o=0;const r=()=>{n=i.call(t);const a=performance.now();0==n.length&&(0==o||600>a-o)?(e.$L$&&clearTimeout(e.$L$),e.$L$=window.setTimeout(r,150)):(e.$L$&&(clearTimeout(e.$L$),e.$L$=0),Y(e,n),s())};void 0!==t.onvoiceschanged&&(t.onvoiceschanged=r),window.setTimeout((()=>{n=i.call(t),n.length?r():(e.$L$=window.setTimeout(r,150),o=performance.now())}),0)}}))}return new Promise((e=>{e()}))}(e),h=(i=e,new Promise((e=>{var t=/Chrome\/(([0-9]+\.)*[0-9]+)/,n=navigator.userAgent;n&&(t=n.match(t),i.$Z$=null==t?void 0:t[1],i.$Z$&&(n=n.match(/Chrome\/([0-9]+)/),i.$xa$=null==n?void 0:n[1])),e()}))),p=function(e){var t,i,n,s,o,r,a,$,c,d,l;const u=window,h=u.hasOwnProperty,p=u.navigator;h.call(u,"MSMediaKeys")?e.$Xa$=!0:h.call(u,"_firefoxTV_cachedScrollPosition")?e.$Ya$=!0:void 0!==u.__edgeActiveElement||u.__edgeTrackingPreventionStatistics?e.$Ca$=!0:u.safari?e.$bb$=!0:u.opr?e.$Za$=!0:u.oprt?e.$$a$=!0:p.brave?e.$ka$=!0:void 0!==u.OperaTouch||u.ethereum?(e.$Ea$=!0,e.$U$=!0):u.yandex?e.$na$=!0:u.QuickAccess?e.$ma$=!0:u.chrome?e.$ca$=!0:u.netscape?e.$la$=!0:u.__firefox__?e.$Da$=!0:u.__gCrWeb?e.$Ba$=!0:u.ReactNativeWebView&&(e.$ab$=!0),void 0!==u.contacts||void 0!==u.ContactsManager?e.$U$=!0:h.call(u,"onwebOSAccessibilityAlertDone")||u.webOSSystem||h.call(u,"onwebosaccessibilityalertdone")?e.$nb$=!0:u.tizen||u.TizenTVApiInfo||u.addEdgeEffectONSCROLLTizenUIF||u.tizentvwasm?e.$pa$=!0:u.HardkeyEvent&&(e.$mb$=!0);const m=u.Intl;null!==(t=p.mediaCapabilities)&&void 0!==t&&t.decodingInfo&&(e.$Hb$=!0),u.BigInt&&(e.$zb$=!0,u.BigInt64Array&&(e.$Ab$=!0)),u.PerformanceNavigationTiming&&(e.$Qb$=!0),u.WebAssembly&&u.WebAssembly.Exception&&(e.$Ub$=!0),u.BroadcastChannel&&(e.$Bb$=!0),u.GPUBuffer&&(e.$Lb$=!0),u.SharedWorker&&(e.$Sb$=!0),u.MediaRecorder&&(e.$Ob$=!0),u.CSSCounterStyleRule&&(e.$Db$=!0),h.call(u,"ondevicelight")&&(e.$Ib$=!0),null!==(i=u.AbortSignal)&&void 0!==i&&i.abort&&(e.$vb$=!0),h.call(u,"onbeforeinput")&&(e.$yb$=!0),m&&(m.DisplayNames&&(e.$sa$=!0),e.$Mb$="pinyin"==(null===(n=new m.Collator("zh",{collation:"pinyin"}).resolvedOptions())||void 0===n?void 0:n.collation)),u.Credential&&(e.$Gb$=!0),null!==(s=u.browser)&&void 0!==s&&s.runtime&&(e.$Cb$=!0),u.LargestContentfulPaint&&(e.$Nb$=!0),null!==(o=u.CSS)&&void 0!==o&&o.registerProperty&&(e.$Fb$=!0),p.xr&&(e.$Wb$=!0),p.getInstalledRelatedApps&&(e.$Kb$=!0),u.BarcodeDetector&&(e.$xb$=!0),u.WakeLock&&(e.$Tb$=!0),null!==(r=u.Promise)&&void 0!==r&&r.any&&(e.$Rb$=!0),u.FileSystemHandle&&(e.$Jb$=!0),null!==(a=u.Atomics)&&void 0!==a&&a.waitAsync&&(e.$wb$=!0),null!==(c=null===($=u.CSS)||void 0===$?void 0:$.supports)&&void 0!==c&&c.call($,"aspect-ratio: auto")&&(e.$Eb$=!0),u.HID&&(e.$Vb$=!0),null!==(l=null===(d=u.CSS)||void 0===d?void 0:d.supports)&&void 0!==l&&l.call(d,"overflow: clip")&&(e.$Pb$=!0)}(e),m=(t=e,new Promise((e=>{let i=!1;const n=n=>{if(t.$fa$)clearTimeout(t.$fa$),t.$fa$=0;else if(i)return d.w("{3c72abb}","{b02109c}"),void Q(t,"Plat",t.$ub$-performance.now());t.$Na$||("MacIntel"===(n=n.platform)?t.$V$=!0:"iPhone"===n?t.$qa$=!0:"Win32"===n?t.$W$=!0:"iPad"===n?t.$Ha$=!0:"FreeBSD amd64"===n?t.$ea$=!0:"Windows"===n&&(t.$W$=!0,t.$O$=!0),n.startsWith("Linux")&&(t.$K$=!0),t.$Na$=!0),e()};let s=!1,o=!1;const r=e=>{"string"==typeof e?Z(t,"Plat",e):"data"in e?ee(t,"Plat",e):te(t,"Plat",e),o=!0,d.e("{3c72abb}","{6350135}",e)};let a=0;try{s=!0,V(be,n,r),a=150}catch(e){o=!0,ie(t,"Plat",e),d.w("{3c72abb}","{79668e5}",e)}window.setTimeout((()=>{t.$Na$||(t.$fa$=window.setTimeout((()=>{t.$fa$=0,t.$ub$=performance.now(),o?d.w("{3c72abb}","{d9e1e01}"):s?(d.w("{3c72abb}","{a8d68cb}"),ne(t,"Plat")):(d.i("{3c72abb}","{53e2225}"),se(t,"Plat"));const e=(new be).$doWork$();n(e),i=!0}),a))}),0)}))),f=function(e){const t=window;t.ApplePaySession&&t.ApplePaySession.canMakePayments&&(e.$Oa$=!0)}(e),g=function(e){var t=navigator.plugins;for(const i of t)"Native Client"!==(t=i.name)&&(t.startsWith("Microsoft Edge PDF")?e.$qb$=!0:t.startsWith("Chrome PDF")?e.$ob$=!0:t.startsWith("Chromium PDF")?e.$pb$=!0:t.startsWith("PPAPI SAMSUNGHEALTH")&&(e.$pa$=!0))}(e);navigator.maxTouchPoints&&0<navigator.maxTouchPoints&&(e.$T$=!0),await a.call(r,[$,c,l,u,h,p,m,f,g,void 0,X(e),(o=e,new Promise((e=>{const t=t=>{o.$ra$&&(clearTimeout(o.$ra$),o.$ra$=0),t.$isKnownTVDevice$&&(o.$lb$=t.$isKnownTVDevice$,o.$bc$=t.$vendorName$,o.$ac$=t.$modelName$),e()};let i=!1,n=!1;const s=e=>{"string"==typeof e?Z(o,"TV",e):"data"in e?ee(o,"TV",e):te(o,"TV",e),n=!0,d.e("{3c72abb}","{f49e1b4}",e)};let r,a=0;try{self.SharedWorker&&(i=!0,r=U(Ae,t,s),a=150)}catch(e){n=!0,d.w("{3c72abb}","{2066dd6}",e),ie(o,"TV",e)}o.$ra$=window.setTimeout((()=>{r&&H("port"in r?r.port:r),n?d.w("{3c72abb}","{cdb3848}"):i?(d.w("{3c72abb}","{f01188c}"),ne(o,"TV"),o.$Ra$=!0):(d.i("{3c72abb}","{db9e3f4}"),se(o,"TV")),(new Ae).$doWork$().then((e=>{t(e)}))}),a)})))]).then((()=>{var t,i,n,s,o,r,a,$,c,l,u,h,p,m,f,g,v,A,b;if(e.$aa$&&(e.$V$==e.$F$&&e.$W$==e.$J$||(e.$s$=!0),(e.$I$||e.$S$||e.$R$||e.$da$)&&!e.$K$&&(e.$s$=!0),e.$o$&&e.browserFullVer&&!oe(e.$o$,e.browserFullVer)&&(e.$ja$?e.$ga$&&!oe(e.$ga$,e.browserFullVer)&&(e.$s$=!0):e.$s$=!0),(e.$I$&&!e.$ia$||e.$S$&&!e.$N$)&&(e.$s$=!0),e.$ua$?(e.$M$&&!e.$J$||e.$B$&&!e.$F$)&&(e.$s$=!0):e.$va$?e.$I$||(e.$s$=!0):e.$wa$?e.$s$=!0:e.$M$||!e.$B$||e.$F$||(e.$s$=!0),e.$u$=e.$aa$&&!e.$s$,e.$ba$=e.$aa$&&e.$s$),!e.$Va$&&e.$ca$)e.$g$="Unknown",e.$h$="Unknown",e.$O$=!0,e.$l$=3,e.$v$="0",e.$o$="0",e.browserFullVer="0",d.d("{3c72abb}","{049d298}");else if(e.$va$)e.$g$="ChromeOS",re(e);else if(e.$ua$)re(e),e.$M$?e.$g$="Windows":e.$B$?(e.$g$="macOS",e.$j$="APPLE"):e.$u$?e.$J$?e.$g$="Windows":e.$F$?(e.$g$="macOS",e.$j$="APPLE"):e.$I$||e.$S$?(e.$g$="ChromeOS",e.$O$=!0,e.$l$=7):e.$da$&&(e.$g$=ae(e)):e.$W$?e.$g$="Windows":e.$V$?(e.$g$="macOS",e.$j$="APPLE"):e.$K$?e.$g$=ae(e):e.$ea$?e.$g$="FreeBSD":(e.$g$="Unknown",e.$l$=5,d.d("{3c72abb}","{101497c}"));else if(e.$wa$)$e(e),e.$M$?e.$g$="Windows":e.$B$?(e.$g$="macOS",e.$j$="APPLE"):e.$Zb$?(e.$g$="Android",ce(e)):e.$K$?e.$g$=ae(e):e.$ea$?e.$g$="FreeBSD":(e.$g$="Unknown",e.$l$=5,d.d("{3c72abb}","{49fcccb}"));else if(e.$Yb$)e.$h$="Edge",e.$Qa$?e.$u$&&e.$P$||e.$D$?(e.$g$="Xbox",e.$j$="MICROSOFT",e.$oa$?e.$G$="XBOXSERIES":e.$D$&&(e.$G$="XBOXONE")):e.$g$="Windows":e.$B$?(e.$g$="macOS",e.$j$="APPLE"):e.$ta$?(e.$g$="Android",ce(e)):e.$u$?e.$P$?(e.$g$="Xbox",e.$j$="MICROSOFT",e.$oa$?e.$G$="XBOXSERIES":e.$D$&&(e.$G$="XBOXONE")):e.$J$?e.$g$="Windows":e.$F$?(e.$g$="macOS",e.$j$="APPLE"):e.$I$||e.$S$?(e.$g$="ChromeOS",e.$O$=!0,e.$l$=7):e.$R$?(e.$g$="Android",ce(e)):e.$da$&&(e.$g$=ae(e)):e.$W$?e.$g$="Windows":e.$V$?(e.$g$="macOS",e.$j$="APPLE"):e.$U$?(e.$g$="Android",ce(e)):e.$K$?e.$g$=ae(e):e.$ea$?e.$g$="FreeBSD":(e.$g$="Unknown",e.$l$=5);else if(e.$M$)e.$Qa$?de(e):(de(e),e.$O$=!0,e.$l$=5);else if(e.$B$)le(e);else if(e.$ta$)ue(e);else if(e.$u$&&(e.$P$||e.$J$)||e.$W$||e.$D$)de(e);else if(e.$u$&&e.$F$||e.$Ha$||e.$qa$||e.$V$)le(e);else if(e.$u$&&(e.$I$||e.$S$))e.$g$="ChromeOS",re(e);else if(e.$mb$)e.$g$="ccOS",e.$j$="HKMC",e.$h$="Chromium";else if(e.$u$&&e.$R$||e.$U$)ue(e);else if(e.$u$&&e.$da$)e.$g$=ae(e),e.$Ga$||e.$T$?(e.$h$="Unknown",e.$l$=3):he(e)||(e.$h$="Unknown",e.$l$=5,d.d("{3c72abb}","{54c6569}"));else if(e.$nb$)e.$g$="WebOS",e.$j$="LG",e.$h$="Chromium";else if(e.$pa$){if(e.$g$="Tizen",e.$h$="Samsung",null!==(b=window.webapis)&&void 0!==b&&b.productinfo)try{e.$v$=window.webapis.productinfo.getFirmware(),e.deviceName=window.webapis.productinfo.getRealModel(),e.$ya$=window.webapis.productinfo.getLicensedVendor()}catch(e){d.e("{3c72abb}","{bc7dd9b}")}else d.e("{3c72abb}","{844af47}"),e.$v$="0",e.deviceName="";e.$j$="Samsung"!==e.$ya$&&e.$ya$?"TIZENLICENSED":"SAMSUNG",b=/(([0-9]+\.)*[0-9]+)\/(([0-9]+\.)*[0-9]+)/;const t=navigator.userAgent;t&&(b=t.match(b),e.browserFullVer=null==b?void 0:b[0],e.$Z$=null==b?void 0:b[1],e.$Z$&&(b=e.$Z$.split("."),e.$xa$=null==b?void 0:b[0],e.$o$=e.$xa$))}else e.$K$?e.$Ya$?(e.$g$="Android",e.$j$="AMAZON",$e(e),e.$C$="TV"):e.$ma$?(e.$g$="Android",e.$j$="SAMSUNG",e.$h$="Samsung",ce(e)):he(e)?e.$ba$?e.$g$=ae(e):!e.$pb$||e.$ob$||e.$qb$?e.$K$&&(e.$g$="Linux"):(e.$g$=ae(e),e.$h$="Chromium",e.$l$=7):(e.$g$="Unknown",e.$h$="Unknown",e.$l$=0,d.d("{3c72abb}","{be86380}")):e.$ea$?(e.$g$="FreeBSD",e.$ca$?e.$h$="Chrome":e.$la$?$e(e):(e.$h$="Unknown",e.$l$=3,d.d("{3c72abb}","{a2c16e4}"))):e.$Ba$||e.$Da$||e.$Ca$?(e.$qa$=!0,le(e),e.$l$=7):e.$ma$?(ue(e),e.$l$=7):(e.$g$="Unknown",e.$h$="Unknown",e.$l$=0,d.d("{3c72abb}","{f2eecc9}"));switch(e.$ba$&&(e.$v$="0",e.$o$="0",e.browserFullVer="0"),e.$Sa$=performance.now(),e.$platformDetails$.os=null!==(t=e.$g$)&&void 0!==t?t:"Unknown",e.$platformDetails$.browser=null!==(i=e.$h$)&&void 0!==i?i:"Unknown",e.$platformDetails$.osRawVer=null!==(n=e.$cc$)&&void 0!==n?n:"0",e.$platformDetails$.osVer=null!==(s=e.$v$)&&void 0!==s?s:"0",e.$platformDetails$.browserVer=null!==(r=null!==(o=e.$o$)&&void 0!==o?o:"WebOS"===e.$g$?e.$xa$:void 0)&&void 0!==r?r:"0",e.$platformDetails$.browserFullVer=null!==($=null!==(a=e.browserFullVer)&&void 0!==a?a:"WebOS"===e.$g$?e.$Z$:void 0)&&void 0!==$?$:"0",e.$platformDetails$.confidence=null!==(p=null!==(h=null!==(u=null!==(l=null!==(c=e.$l$)&&void 0!==c?c:"Unknown"===e.$g$?0:void 0)&&void 0!==l?l:"Unknown"===e.$h$?5:void 0)&&void 0!==u?u:e.$Ra$?6:void 0)&&void 0!==h?h:e.$ba$?8:void 0)&&void 0!==p?p:10,e.$platformDetails$.forging=null!==(m=e.$O$)&&void 0!==m&&m,e.$platformDetails$.spoofing=null!==(f=e.$ba$)&&void 0!==f&&f,e.$platformDetails$.vendor=null!==(g=e.$j$)&&void 0!==g?g:"",e.$platformDetails$.vendorFull=null!==(v=e.$ya$)&&void 0!==v?v:e.$platformDetails$.vendor,t=void 0,e.$platformDetails$.os){case"ChromeOS":t="CHROMEOS";break;case"Windows":t="WINDOWS";break;case"macOS":t="MACOS";break;case"Linux":t="LINUX";break;case"iOS":t="IOS";break;case"iPadOS":t="IPADOS";break;case"Tizen":t="TIZEN";break;case"WebOS":t="WEBOS";break;case"Android":t="ANDROID";break;case"Xbox":t="XBOX";break;case"SteamOS":t="STEAMOS";break;case"ccOS":t="CCOS"}e.$platformDetails$.deviceOS=t,e.$Fa$?e.$platformDetails$.deviceModel="STEAMDECK":e.$G$&&(e.$platformDetails$.deviceModel=e.$G$),e.$platformDetails$.deviceType=null!==(A=e.$C$)&&void 0!==A?A:function(e,t){if("STEAMDECK"===t)return"CONSOLE";switch(e){case"iOS":return"PHONE";case"iPadOS":return"TABLET";case"Xbox":return"CONSOLE";case"WebOS":case"Tizen":return"TV";default:return"DESKTOP"}}(e.$platformDetails$.os,e.$platformDetails$.deviceModel),e.$platformDetails$.totalTime=e.$Sa$-e.start}))}(e).then((()=>{e.$rb$=!0,t(e.$platformDetails$)}))}))}function Y(e,t){if(!e.$tb$){for(const i of t)(t=i.voiceURI||"").startsWith("Chrome OS")?e.$va$=!0:t.startsWith("Google")?e.$ua$=!0:t.includes("moz-tts")?(t.includes("android")&&(e.$Zb$=!0,e.$U$=!0),e.$wa$=!0):"English United States"==t&&(e.$ta$=!0),t.includes("Microsoft")?(e.$M$=!0,t.includes("Online")?e.$Yb$=!0:e.$Qa$=!0):t.includes("com.apple")?(e.$B$=!0,t.includes("Ellen")&&(e.$Xb$=!0)):"Zuzana"==t&&(e.$B$=!0);e.$$b$=e.$B$||e.$M$||e.$ua$||e.$va$||e.$wa$||e.$ta$,e.$tb$=!0}}function X(e){const t=window;e.$Ka$=t.matchMedia("(hover: hover)").matches,e.$La$=t.matchMedia("(hover: none)").matches,e.$Ia$=t.matchMedia("(pointer: coarse)").matches,e.$Ja$=t.matchMedia("(pointer: fine)").matches}function Q(e,t,i){e.$m$?e.$m$.$emitDebugEvent$("WorkerOverlongDelay",t,i.toString()):e.$A$.push({type:"WorkerOverlongDelay",name:t,data:i})}function Z(e,t,i){e.$m$?e.$m$.$emitDebugEvent$("WebWorkerProblem",t,i):e.$A$.push({type:"ErrorString",name:t,data:i})}function ee(e,t,i){e.$m$?e.$m$.$emitDebugEvent$("WorkerMessageProblem",JSON.stringify(i)):e.$A$.push({type:"MessageEvent",name:t,data:i})}function te(e,t,i){e.$m$?e.$m$.$emitDebugEvent$("WorkerProblem",t,`${i.message} in ${i.filename}@${i.lineno}:${i.colno}`,JSON.stringify(i.error)):e.$A$.push({type:"ErrorEvent",name:t,data:i})}function ie(e,t,i){var n;e.$m$?e.$m$.$emitDebugEvent$("WorkerCreateFailure",t,null!==(n=null==i?void 0:i.stack)&&void 0!==n?n:"",JSON.stringify(i)):e.$A$.push({type:"WorkerCreateFailure",name:t,data:i})}function ne(e,t){e.$m$?e.$m$.$emitDebugEvent$("WorkerTimeout",t):e.$A$.push({type:"WorkerTimeout",name:t})}function se(e,t){e.$m$?e.$m$.$emitDebugEvent$("WorkerUnused",t):e.$A$.push({type:"WorkerUnused",name:t})}function oe(e,t){if(e==t)return!1;let i=/^(\d+)[.]?(.*)/;if(e=i.exec(e),t=i.exec(t),null==e){if(null==t)return!0}else if(null!=t&&e[1]==t[1]&&""==e[2])return!0;return!1}function re(e){e.$h$="Chrome",!e.$o$&&e.$Nb$&&(e.$o$=e.$Fb$?e.$Wb$?e.$Kb$?e.$sa$?e.$xb$?e.$Tb$?e.$Rb$?e.$Jb$?e.$wb$?e.$Eb$?e.$Vb$?e.$Pb$?"90+":"89":"88":"87":"86":"85":"84":"83":"81":"80":"79":"78":"77")}function ae(e){return e.$Fa$?"SteamOS":"Linux"}function $e(e){e.$h$="Firefox",e.$o$=e.$Mb$?e.$sa$?e.$yb$?e.$vb$?e.$Ib$?"88":"89+":"87":"86":"85":"84-"}function ce(e){var t,i,n,s;e.$u$&&e.$H$?e.$C$="TV":e.$Ga$||e.$T$||!e.$lb$?e.$Ka$&&!e.$Ja$||(e.$R$?e.$kb$?e.$La$&&e.$Ia$||(e.$C$="DESKTOP"):e.$Ka$&&e.$Ja$&&(e.$C$="DESKTOP"):e.$La$&&e.$Ia$||(e.$C$="DESKTOP")):(e.$C$="TV",e.$j$=null!==(i=null!==(t=e.$j$)&&void 0!==t?t:e.$bc$)&&void 0!==i?i:"",e.deviceName=null!==(s=null!==(n=e.deviceName)&&void 0!==n?n:e.$ac$)&&void 0!==s?s:"UNKNOWN",e.$l$=7),e.$C$||(e.$C$=600<=(screen.width<screen.height?screen.width:screen.height)?"TABLET":"PHONE")}function de(e){e.$g$="Windows",he(e)||(e.$h$="Unknown",e.$l$=5,d.d("{3c72abb}","{44ce1e0}"))}function le(e){e.$j$="APPLE",e.$u$&&e.$F$?(e.$g$="macOS",he(e)||(e.$h$="Unknown",e.$l$=5,d.d("{3c72abb}","{b80b712}"))):e.$V$?e.$T$?(e.$g$="iPadOS",me(e)):(e.$g$="macOS",he(e)||(e.$h$="Unknown",e.$l$=5,d.d("{3c72abb}","{0f3296f}"))):e.$qa$?(e.$g$="iOS",me(e)):e.$Ha$?(e.$g$="iPadOS",me(e)):(e.$O$=!0,e.$l$=5,e.$T$?(e.$g$="iOS",me(e),d.d("{3c72abb}","{cf1c572}")):(e.$g$="macOS",e.$h$="Unknown",d.d("{3c72abb}","{1eb1815}")))}function ue(e){e.$g$="Android",e.$la$?$e(e):e.$ma$?(e.$h$="Samsung",e.$j$="SAMSUNG"):e.$ka$?e.$h$="Brave":e.$na$?e.$h$="Yandex":e.$Ea$?e.$h$="Opera":e.$u$?e.$za$?e.$h$="Edge":e.$ja$?e.$h$="Opera":e.$Aa$?e.$h$="Yandex":e.$ia$?(re(e),pe(e)):e.$N$&&(e.$h$="Chromium",pe(e)):e.$ca$?e.$Pa$?re(e):e.$h$=e.$T$?"Edge":"Silk":(re(e),e.$l$=7),ce(e)}function he(e){var t;if(e.$la$)$e(e);else if(e.$Za$)e.$h$="Opera";else if(e.$ka$)e.$h$="Brave";else if(e.$na$)e.$h$="Yandex";else if(e.$ca$)e.$D$?(e.$g$="Xbox",e.$j$="MICROSOFT",e.$h$="Edge",e.$oa$?e.$G$="XBOXSERIES":e.$D$&&(e.$G$="XBOXONE")):e.$u$?e.$P$?(e.$g$="Xbox",e.$j$="MICROSOFT",e.$h$="Edge"):e.$za$?e.$h$="Edge":e.$ja$?e.$h$="Opera":e.$Aa$?e.$h$="Yandex":e.$ia$?re(e):e.$N$&&!e.$Wa$&&(e.$h$="Chromium"):e.$Pa$?e.$u$&&e.$N$?(e.$h$="Chromium",e.$l$=9):e.$$b$?e.$h$="Chromium":(e.$h$="Chromium",e.$l$=7):(e.$h$="Edge",e.$g$=null!==(t=e.$g$)&&void 0!==t?t:"Unknown",e.$l$=7);else if(e.$bb$||e.$Oa$)e.$h$="Safari";else{if(!e.$Xa$)return!1;e.$D$&&(e.$g$="Xbox",e.$j$="MICROSOFT"),e.$h$="Edge_Legacy"}return!0}function pe(e){e.$fb$?(e.$j$="AMAZON",e.$N$&&(e.$h$="Silk")):e.$cb$?e.$j$="SONY":e.$eb$?e.$j$="GOOGLE":e.$ib$?e.$j$="NVIDIA":e.$gb$?e.$j$="XIAOMI":e.$jb$&&(e.$j$="TVISION")}function me(e){e.$v$=e.$zb$?e.$sa$?e.$Ab$?e.$Db$?"17+":e.$Sb$?"16+":e.$Lb$?e.$Xb$?"15.6+":"15.5+":e.$Bb$?"15.4+":e.$Ub$?"15.2+":e.$Qb$?"15.1+":"15+":"14.5+":e.$Ob$?"14.3+":"14+":e.$Hb$?"13+":"12-";var t=e.$v$;const i=!e.$Gb$&&!(t.startsWith("12")||t.startsWith("13"));t=!e.$Cb$&&!(t.startsWith("12")||t.startsWith("13")||t.startsWith("14")||t.startsWith("15")),e.$Da$?e.$h$="Firefox":e.$$a$?e.$h$="Opera":e.$ka$?e.$h$="Brave":e.$na$?e.$h$="Yandex":e.$Ca$?e.$h$="Edge":e.$Ba$?e.$h$="Chrome":!e.$Oa$||i||t?e.$ab$?e.$h$="ReactNative":i?(e.$h$="Unknown",e.$l$=7,d.d("{3c72abb}","{5a39f60}")):(e.$h$="Unknown",e.$l$=5,d.d("{3c72abb}","{147d6b4}")):e.$h$="Safari"}function fe(e){var t,i=we;null===(t=i.$m$)||void 0===t||t.$emitDebugEvent$("TelemetryHandlerChanged"),i.$m$=e;for(const n of i.$A$)switch(e=n.name,t=n.data,n.type){case"ErrorEvent":te(i,e,t);break;case"MessageEvent":ee(i,e,t);break;case"WorkerUnused":se(i,e);break;case"WorkerTimeout":ne(i,e);break;case"WorkerCreateFailure":ie(i,e,t);break;case"ErrorString":Z(i,e,t);break;case"WorkerOverlongDelay":Q(i,e,t)}i.$A$=[]}class ge{$doWork$(){const e=(self.OffscreenCanvas?new OffscreenCanvas(1,1):document.createElement("canvas")).getContext("webgl"),t=e&&e.getExtension("WEBGL_debug_renderer_info");return t?{$vendorName$:e&&e.getParameter(t.UNMASKED_VENDOR_WEBGL),$rendererName$:e&&e.getParameter(t.UNMASKED_RENDERER_WEBGL),$present$:!0}:{$vendorName$:"",$rendererName$:"",$present$:!1}}}class ve{$doWork$(){const e=navigator.userAgentData;return e?e.getHighEntropyValues("platform architecture uaFullVersion platformVersion model bitness".split(" ")).then((t=>(t||(t={}),t.brands||(t.brands=e.brands),t.mobile||(t.mobile=e.mobile),t))):Promise.resolve(void 0)}}class Ae{$doWork$(){let e={$isKnownTVDevice$:!1,$modelName$:"",$vendorName$:""};if(navigator.userAgent){var t=navigator.userAgent.toUpperCase();const i="BRAVIA TIZEN PHILIPSTV GOOGLETV CRKEY CHROMECAST SHIELDTV".split(" "),n="SONY SAMSUNG PHILIPS GOOGLE GOOGLE GOOGLE NVIDIA".split(" ");if(RegExp("BRAVIA|SMARTTV|SMART-TV|PHILIPSTV|GOOGLETV|CRKEY|CHROMECAST|SHIELD Android TV","i").test(t)&&(e.$isKnownTVDevice$=!0,t=t.match(i.join("|"))))for(let s=0;s<i.length;s++)t[0]==i[s]&&(e.$modelName$=i[s],e.$vendorName$=n[s],"CRKEY"==t[0]&&(e.$modelName$="CHROMECAST"))}return Promise.resolve(e)}}class be{$doWork$(){return{platform:navigator.platform}}}const we=new class{constructor(){this.$Sa$=this.start=0,this.$Qa$=this.$Yb$=this.$B$=this.$M$=this.$ta$=this.$Zb$=this.$wa$=this.$ua$=this.$va$=!1,this.$Xb$=!0,this.$Na$=this.$sb$=this.$Ma$=this.$tb$=this.$rb$=this.$Ra$=this.$ba$=this.$u$=this.$s$=this.$aa$=this.$Va$=this.$Ja$=this.$Ia$=this.$La$=this.$Ka$=this.$Pb$=this.$Vb$=this.$Eb$=this.$wb$=this.$Jb$=this.$Rb$=this.$Tb$=this.$xb$=this.$Kb$=this.$Wb$=this.$Fb$=this.$Nb$=this.$Db$=this.$Sb$=this.$Cb$=this.$Gb$=this.$Oa$=this.$Mb$=this.$sa$=this.$yb$=this.$vb$=this.$Ib$=this.$Ob$=this.$Lb$=this.$Bb$=this.$Ub$=this.$Qb$=this.$Hb$=this.$Ab$=this.$zb$=this.$Pa$=this.$lb$=this.$H$=this.$kb$=this.$da$=this.$R$=this.$S$=this.$I$=this.$F$=this.$J$=this.$jb$=this.$gb$=this.$ib$=this.$eb$=this.$cb$=this.$fb$=this.$P$=this.$Fa$=this.$oa$=this.$D$=this.$T$=this.$Ga$=this.$Wa$=this.$N$=this.$Aa$=this.$ja$=this.$za$=this.$ia$=this.$qb$=this.$pb$=this.$ob$=this.$mb$=this.$pa$=this.$nb$=this.$U$=this.$ea$=this.$K$=this.$Ha$=this.$W$=this.$qa$=this.$V$=this.$ab$=this.$ma$=this.$na$=this.$ka$=this.$Ea$=this.$$a$=this.$Za$=this.$Ya$=this.$Da$=this.$la$=this.$Ba$=this.$ca$=this.$bb$=this.$Ca$=this.$Xa$=this.$$b$=!1,this.$ub$=this.$Ua$=this.$fa$=this.$ra$=this.$ha$=this.$$$=this.$L$=0,this.$platformDetails$={os:"Unknown",osRawVer:"0",osVer:"0",browser:"Unknown",browserVer:"0",browserFullVer:"0",forging:!0,spoofing:!0,confidence:0,totalTime:0,vendor:""},this.$A$=[]}};var Se=class extends n{constructor(e){super(e),this.$J$=[]}$N$(e){this.hasListener("Log")?this.emit("Log",e):this.$J$.push(e)}addListener(e,t){if(super.addListener(e,t),"Log"==e&&0<this.$J$.length){for(const e of this.$J$)this.emit("Log",e);this.$J$=[]}}};function ye(e){switch(e){case"CONSOLE":return"Console";case"TABLET":return"Tablet";case"PHONE":return"Phone";case"TV":return"TV";case"LAPTOP":return"Laptop";case"DESKTOP":return"Desktop";default:return"undefined"}}function ke(e){switch(e){case"Chrome":return"Chrome";case"Safari":return"Safari";case"Yandex":return"Yandex";case"Edge":return"Edge";case"Edge_Legacy":return"Edge_legacy";case"Firefox":return"Firefox";case"Samsung":return"Samsung";case"Chromium":return"Chromium";case"Opera":return"Opera";case"Brave":return"Brave";case"Silk":return"Silk";default:return"undefined"}}function Ce(e){switch(e){case"Windows":return"Windows";case"macOS":return"MacOS";case"ChromeOS":return"ChromeOS";case"Linux":return"Linux";case"iOS":return"iOS";case"iPadOS":return"iPadOS";case"Tizen":return"Tizen";case"WebOS":return"WebOS";case"Xbox":return"Xbox";case"Android":return"Android";case"SteamOS":return"SteamOS";default:return"undefined"}}class _e{constructor(e){e=this.$g$=e,this.$j$={os:Ce(e.os),browser:ke(e.browser),deviceType:ye(e.deviceType)},e=this.$g$,this.$l$={os:Ee(Ce(e.os)),browser:Ie(ke(e.browser)),deviceType:Te(ye(e.deviceType))}}get $m$(){return this.$j$}get $o$(){return this.$l$}get $h$(){return this.$g$}}var Ee=e=>{switch(e){case"Windows":return"WINDOWS";case"MacOS":return"MACOS";case"Linux":return"LINUX";case"ChromeOS":return"CHROMEOS";case"iOS":return"IOS";case"iPadOS":return"IPADOS";case"WebOS":return"WEBOS";case"Tizen":return"TIZEN";case"Xbox":return"XBOX";case"Android":return"ANDROID";case"SteamOS":return"STEAMOS";case"Shield":return"SHIELD";default:return"UNKNOWN"}},Te=e=>{switch(e){case"Desktop":default:return"DESKTOP";case"Laptop":return"LAPTOP";case"TV":return"TV";case"Phone":return"PHONE";case"Tablet":return"TABLET";case"Console":return"CONSOLE"}},Ie=e=>{switch(e){case"Chrome":return"CHROME";case"Safari":return"SAFARI";case"Yandex":return"YANDEX";case"Edge":return"EDGE";case"Edge_legacy":return"EDGE_LEGACY";case"Firefox":return"FIREFOX";case"Samsung":return"SAMSUNG";case"Chromium":return"CHROMIUM";case"Opera":return"OPERA";case"Brave":return"BRAVE";case"Silk":return"SILK";default:return"UNKNOWN"}};let Pe;window.RtcUtils=window.RtcUtils||{};var je={$commonConfig$:{},$remoteOverrideInfo$:{type:"UNKNOWN",version:""},$loggingEnabled$:!0,$consoleLoggingEnabled$:!1,$webSocketSignaling$:!0,$webRtcStreamer$:!1};function Re(e){var t,i,n,a,$;if(d.i("{27b0dc4}","{539b3db}",JSON.stringify(e)),function(e){var t,i;if(e.overrideData){const n=new URLSearchParams(e.overrideData.toLowerCase());"lean"===n.get("mode")&&(s=!1),o=(s=null!==(t=(e=e=>r(e=n.get(e)))("log"))&&void 0!==t?t:s)&&(null!==(i=e("console"))&&void 0!==i?i:o)}}(e),e.gxtOverrideData){var c=JSON.parse(e.gxtOverrideData);if(c.params)for(const e of c.params)"pmCommunication"===e.name&&(je.$commonConfig$.pmCommunication=e.value,je.$remoteOverrideInfo$={type:"GXT",version:e.version})}else e.remoteConfigData&&e.remoteConfigData.common&&(je.$commonConfig$=JSON.parse(e.remoteConfigData.common),je.$remoteOverrideInfo$={type:"RCONFIG",version:null!==(c=e.remoteConfigData.version)&&void 0!==c?c:""});if(e.overrideData){const s=new URLSearchParams(e.overrideData.toLowerCase());"lean"===s.get("mode")&&(je.$loggingEnabled$=!1),e=e=>r(e=s.get(e)),je.$loggingEnabled$=null!==(t=e("log"))&&void 0!==t?t:je.$loggingEnabled$,je.$consoleLoggingEnabled$=je.$loggingEnabled$&&(null!==(i=e("console"))&&void 0!==i?i:je.$consoleLoggingEnabled$),je.$webSocketSignaling$=null!==(n=e("websocketsignaling"))&&void 0!==n?n:je.$webSocketSignaling$,je.$webRtcStreamer$=null!==(a=e("webrtcstreamer"))&&void 0!==a?a:je.$webRtcStreamer$,je.hdr=null!==($=e("hdr"))&&void 0!==$?$:je.hdr}}var De=class{constructor(e){this.name="",this.gdprLevel="behavioral",this.parameters=e,this.ts=(new Date).toISOString()}},xe=class extends De{constructor(e){super(e),this.name="GridServer_GameLaunch_Request",this.gdprLevel="functional"}},Me=class extends De{constructor(e){super(e),this.name="GS_DebugInfo",this.gdprLevel="technical"}},Le=class extends De{constructor(e){super(e),this.name="GS_ExceptionInfo",this.gdprLevel="technical"}},Oe=class extends De{constructor(e){super(e),this.name="GS_ClientMetricEvent",this.gdprLevel="functional"}},Be=class extends De{constructor(e){super(e),this.name="GS_Sleep_Event",this.gdprLevel="technical"}},Ne=class extends De{constructor(e){super(e),this.name="GS_HttpCallResult",this.gdprLevel="functional"}};function Fe(e,t){e.$g$.emit("TelemetryEvent",{name:t.name,parameters:t.parameters,gdprLevel:t.gdprLevel,ts:t.ts,clientConfig:e.$l$})}function Ve(e,t,i,n,s){return{requestedZoneAddress:t,zoneName:"",networkSessionId:null!=n?n:"",sessionId:null!=s?s:"",subSessionId:"",resumeType:i?"MANUAL":"NONE",overrideConfigType:je.$remoteOverrideInfo$.type,overrideConfigVersion:je.$remoteOverrideInfo$.version,result:"",codec:"UNKNOWN",ipVersion:"UNKNOWN",launchDuration:0,networkType:e.networkType,streamingProfileGuid:"",systemInfoGuid:"",cmsId:String(e.cmsId)}}function Ue(e,t){e.$g$.hasListener("TelemetryEvent")&&Fe(e,t=new Ne({callDuration:t.callDuration,verb:t.verb,sessionId:t.sessionId,subSessionId:t.subSessionId,serverId:t.serverId,url:t.url,overrideConfigType:je.$remoteOverrideInfo$.type,overrideConfigVersion:je.$remoteOverrideInfo$.version,requestStatusCode:t.requestStatusCode,requestId:t.requestId,networkType:e.networkType,statusCode:t.statusCode,cmsId:String(e.cmsId),moduleName:"GRID_SERVER"}))}function Ge(e,t){var i,n;e.$g$.hasListener("TelemetryEvent")&&((t=new xe(t)).parameters.sessionId=e.sessionId,t.parameters.subSessionId=e.subSessionId,t.parameters.systemInfoGuid=null!==(i=e.telemetryEventIds.systemInfoGuid)&&void 0!==i?i:"",t.parameters.streamingProfileGuid=null!==(n=e.telemetryEventIds.streamingProfileGuid)&&void 0!==n?n:"",Fe(e,t))}function He(e,t,i){var n,s;if(50<=e.$j$)var o=!1;else{var r=null!==(o=e.$h$.get(i))&&void 0!==o?o:0;10<=r?o=!1:(e.$j$++,e.$h$.set(i,r+1),o=!0)}o&&(!n&&t&&(n=t.name+": "+t.message),Fe(e,t=new Le({filename:"gridserver.ts",lineno:0,stacktrace:null!==(s=null==t?void 0:t.stack)&&void 0!==s?s:"",colno:0,handled:"TRUE",category:null!=n?n:"",message:i,moduleName:"GRID_SERVER",sessionId:e.sessionId,subSessionId:e.subSessionId})))}var ze=class{constructor(e){this.networkType="UNKNOWN",this.subSessionId=this.sessionId=this.cmsId="",this.telemetryEventIds={},this.$h$=new Map,this.$j$=0,this.$l$={clientId:"93289439828086895",clientName:"GFN_GridServer",eventSchemaVer:"2.0"},this.$g$=e}updateTelemetryEventIds(e){this.telemetryEventIds=e}$emitDebugEvent$(e,t,i,n,s){this.$g$.hasListener("TelemetryEvent")&&Fe(this,e=new Me({key1:null!=e?e:"",key2:null!=t?t:"",key3:null!=i?i:"",key4:null!=n?n:"",key5:null!=s?s:"",moduleName:"GRID_SERVER",networkType:this.networkType,overrideConfigType:je.$remoteOverrideInfo$.type,overrideConfigVersion:je.$remoteOverrideInfo$.version,cmsId:String(this.cmsId),sessionId:this.sessionId,subSessionId:this.subSessionId}))}setNetworkType(e){this.networkType=e}};function We(e){switch(e){case 1:return"initializing";case 2:return"ready_for_connection";case 3:return"streaming";case 4:case 5:return"paused";case 6:return"resuming";case 7:return"finished";default:return"unknown"}}function Ke(e){switch(e){case 15859712:return"success";case 3237093379:case 3237093381:return"Invalid server response";case 3237093384:return"Exception";case 15867905:case 15867906:return"cancelled";case 15868417:return"no network";case 3237089282:return"network error";default:return"server error"}}function Je(e,t){var i;let n={sessionId:t.sessionId,subSessionId:t.sessionId===e.getSessionId()?e.getSubSessionId():"",signalConnectionInfo:{ip:"",port:0,protocol:""},mediaConnectionInfo:[],streamInfo:[],appId:0,state:We(t.status),appLaunchMode:0,zoneName:"",zoneAddress:"",gpuType:"",clientLocale:null!==(i=e.clientLocale)&&void 0!==i?i:""};if(n.appId=t.sessionRequestData?t.sessionRequestData.appId:0,t.connectionInfo)for(n.mediaConnectionInfo=t.connectionInfo,i=0;i<n.mediaConnectionInfo.length;i++){var s=n.mediaConnectionInfo[i];14==s.usage&&s.ip?(n.signalConnectionInfo.ip=s.ip,n.signalConnectionInfo.port=s.port,n.signalConnectionInfo.protocol=5===s.appLevelProtocol?"https":"http",5!=s.appLevelProtocol&&e.$A$&&(n.signalConnectionInfo.port=49100,n.signalConnectionInfo.protocol="https",s.ip.includes(".com")||s.ip.includes(".net")?n.signalConnectionInfo.ip=s.ip:(s=s.ip.split("."),n.signalConnectionInfo.ip=s[0]+"-"+s[1]+"-"+s[2]+"-"+s[3],n.signalConnectionInfo.ip+=t.sessionControlInfo.ip.substring(t.sessionControlInfo.ip.indexOf(".")),d.d("{6bae601}","{7d16374}",n.signalConnectionInfo.ip)))):2==s.usage&&(n.signalConnectionInfo.port=49100,n.signalConnectionInfo.protocol="https",s=s.ip.split("."),n.signalConnectionInfo.ip=s[0]+"-"+s[1]+"-"+s[2]+"-"+s[3],n.signalConnectionInfo.ip+=t.sessionControlInfo.ip.substring(t.sessionControlInfo.ip.indexOf(".")),d.d("{6bae601}","{cf7d7ea}",n.signalConnectionInfo.ip))}if(t.monitorSettings)for(var o of i=t.monitorSettings)n.streamInfo.push({width:o.widthInPixels,height:o.heightInPixels,fps:o.framesPerSecond,sdrHdrMode:o.sdrHdrMode});if(t.gpuType&&(n.gpuType=t.gpuType),t.sessionRequestData)switch(t.sessionRequestData.appLaunchMode){case 3:n.appLaunchMode=2;break;case 2:n.appLaunchMode=1}return t.sessionControlInfo&&(o=t.sessionControlInfo.ip,t=t.sessionControlInfo.port,o&&t&&(e.$j$.has(n.sessionId)&&((null==(i=e.$j$.get(n.sessionId))?void 0:i.server)===o&&(null==i?void 0:i.port)===t||d.i("{6bae601}","{f09f5be}",n.sessionId,null==i?void 0:i.server,null==i?void 0:i.port,o,t)),e.$j$.set(n.sessionId,{server:o,port:t})),n.zoneAddress=o,n.zoneName=o.split(".")[0].toUpperCase()),n}function qe(e,t){let i=[];return t.forEach((t=>{let n=Je(e,t);i.push({sessionId:n.sessionId,appId:n.appId,state:n.state,appLaunchMode:n.appLaunchMode}),t.$sessionControlInfo$&&e.$j$.set(t.sessionId,{server:t.$sessionControlInfo$.ip,port:t.$sessionControlInfo$.port})})),i}function Ye(e){var t,i;const n=l.trace.getActiveSpan();if(n){var s=new Map([["component","gridserver-core"],["component.version","2.0"],["client.name",e.$h$.clientIdentification],["client.version",e.$h$.clientVersion],["client.os",null!==(t=e.$h$.deviceOs)&&void 0!==t?t:""],["client.os.version",null!==(i=e.$h$.deviceOsVer)&&void 0!==i?i:""]]);for(const[e,t]of s)n.setAttribute(e,t)}}function Xe(e){var t;const i=l.trace.getActiveSpan();null==i||i.setAttribute("error","true"),null==i||i.setAttribute("error.description",null!==(t=e.description)&&void 0!==t?t:"")}function Qe(e,t,i,n,s,o){var r;const a=e=>15867905!==e&&(15859712!==e||3!==t);let $={method:(()=>{switch(t){case 0:return"POST";case 2:return"DELETE";case 1:case 4:return"PUT";default:return"GET"}})(),headers:e.$l$.headers,body:n,$retryCount$:e.$l$.$retryCount$,timeout:e.$l$.timeout};2!==t&&4!==t||($.keepalive=!0,e.$platformDetails$&&"Chrome"==e.$platformDetails$.browser&&!O(e.$platformDetails$,81)&&($.keepalive=!1));const c=performance.now();let l=(u=e.$g$,{url:i,verb:null!==(r=$.method)&&void 0!==r?r:"",statusCode:"0",requestStatusCode:"",sessionId:null!=(h=o)?h:"",subSessionId:u.subSessionId,requestId:"",serverId:"",callDuration:0});var u,h;return l.statusCode="0",j(i,$,e.$C$,s).then((i=>{var n,s=performance.now();if(l.statusCode=String(null!==(n=i.status)&&void 0!==n?n:"0"),l.callDuration=Math.round(s-c),!i.data)throw d.e("{6bae601}","{ea40865}"),new SyntaxError("The response from server does not contain any data");if(!(n=JSON.parse(i.data)).requestStatus)throw d.e("{6bae601}","{862f264}",d.sanitize(i.data)),new SyntaxError("RequestStatus missing in response");i=n.requestStatus.serverId.toUpperCase(),l.requestId=n.requestStatus.requestId,l.serverId=i,l.requestStatusCode=String(n.requestStatus.statusDescription);let o=3237093632;if((s=n.requestStatus)&&void 0!==s.statusCode){let e=s.statusCode;1==e?o=15859712:0<e&&255>e&&(o=3237093632+e),3237093636!=o&&3237093672!=o||!s.unifiedErrorCode||(o=s.unifiedErrorCode)}return i={result:o,$jsonResponse$:n,serverId:i},5===t?i.sessionList=qe(e,n.sessions):2!==t&&((s=Je(e,n.session)).subSessionId=e.subSessionId,l.sessionId=s.sessionId,i.$session$=s,n.otherUserSessions&&(i.sessionList=qe(e,n.otherUserSessions),i.sessionList.length&&d.d("{6bae601}","{ba4be1c}",i.sessionList.length))),l&&a(i.result)&&(Ue(e.$g$,l),l=void 0),i})).catch((t=>{let n={result:3237089282};const s=performance.now();if(t.code){var o=3237093384;3237089281===(t=t.code)?o=15868417:3237089282===t?o=3237089282:3237093377===t?o=3237093377:3237093379===t?o=3237093379:3237089283===t?o=3237089283:15867905==t&&(o=15867905),n.result=o}else o=!1,(t instanceof SyntaxError||t instanceof TypeError&&t.message&&t.message.includes("Cannot read property"))&&(o=!0,d.e("{6bae601}","{d8979bb}",t.name,t.message)),o?n.result=3237093379:(n.result=3237093384,d.e("{6bae601}","{94d55bb}",t,t.stack),He(e.$g$,t,"performSessionRequest"));return l&&a(n.result)&&(l.callDuration=Math.round(s-c),Ue(e.$g$,l)),d.e("{6bae601}","{c29dc20}",$.method,i),d.e("{6bae601}","{200d7ba}",n.result,Ke(n.result)),n}))}function Ze(e,t,i=""){d.d("{6bae601}","{1e04fe6}",i,t),e.subSessionId=t,e.$g$.sessionId=i;var n=e.$g$;n.subSessionId=t,n.$h$.clear(),n.$j$=0,void 0===(n=e.$B$.get(t))||""===n?e.$B$.set(t,i):d.w("{6bae601}","{7dd264b}",i)}function et(e){return Xe(e),Promise.reject(e)}function tt(e,t){e.zoneAddress=t.zoneAddress||e.zoneAddress,e.zoneName=t.zoneName||e.zoneName,e.gpuType=t.gpuType||e.gpuType}function it(e,t){let i=e.protocol;return t&&e.$j$.has(t)?void 0!==(e=e.$j$.get(t))&&(i+=e.server,0!=e.port&&(i+=":"+e.port)):i+=e.$h$.serverAddress,i+="/v2/session",t&&(i+="/"+t),i}var nt=class extends Se{constructor(e,t){var i,n,s,o,r,a,$,c,l,u,h,p,m,f;super(t),this.$j$=new Map,this.$l$=I,this.protocol="https://",this.$A$=!0,this.subSessionId="",this.queuePosition=Number.MAX_VALUE,this.$C$={type:1},this.$B$=new Map,this.$D$=this.$N$.bind(this),this.$o$=new Map,d.hasListener("Log")||d.addListener("Log",this.$D$),this.$platformDetails$=e,e=0,void 0!==(null===(i=je.$commonConfig$.pmCommunication)||void 0===i?void 0:i.httpConnectionTimeout)&&(e+=je.$commonConfig$.pmCommunication.httpConnectionTimeout),void 0!==(null===(n=je.$commonConfig$.pmCommunication)||void 0===n?void 0:n.httpDataReceiveTimeout)&&(e+=je.$commonConfig$.pmCommunication.httpDataReceiveTimeout),this.$l$.timeout=e?1e3*e:13e3,this.$l$.$retryCount$=null!==(o=null===(s=je.$commonConfig$.pmCommunication)||void 0===s?void 0:s.httpRetryCount)&&void 0!==o?o:3,this.$l$.$backOffDelay$=null!==(a=null===(r=je.$commonConfig$.pmCommunication)||void 0===r?void 0:r.httpBackOffDelay)&&void 0!==a?a:500,"http:"===window.location.protocol&&(this.$A$=!1),this.$m$={$minInterval$:null!==(c=null===($=je.$commonConfig$.pmCommunication)||void 0===$?void 0:$.pollingIntervalMin)&&void 0!==c?c:1e3,$maxInterval$:null!==(u=null===(l=je.$commonConfig$.pmCommunication)||void 0===l?void 0:l.pollingIntervalMax)&&void 0!==u?u:1e4,step:null!==(p=null===(h=je.$commonConfig$.pmCommunication)||void 0===h?void 0:h.pollingIntervalStep)&&void 0!==p?p:1e3,$queueSizePerStep$:null!==(f=null===(m=je.$commonConfig$.pmCommunication)||void 0===m?void 0:m.pollingQueueSizePerStep)&&void 0!==f?f:50},this.$g$=new ze(this)}initialize(e){d.i("{6bae601}","{6802390}","Local"),this.$h$=e,e=this.$l$.headers;var t=this.$h$;if(e["content-type"]="application/json",void 0!==t.deviceOs&&(e["nv-device-os"]=t.deviceOs),void 0!==t.deviceType&&(e["nv-device-type"]=t.deviceType),void 0!==t.deviceMake&&(e["nv-device-make"]=t.deviceMake),void 0!==t.deviceModel&&(e["nv-device-model"]=t.deviceModel),void 0!==t.clientType&&(e["nv-client-type"]=t.clientType),void 0!==t.clientAppVersion&&(e["nv-client-version"]=t.clientAppVersion),void 0!==t.clientStreamer&&(e["nv-client-streamer"]=t.clientStreamer),void 0!==t.clientId&&(e["nv-client-id"]=t.clientId),void 0!==t.ecomEnabled&&(e["nv-ecom-enabled"]=t.ecomEnabled),void 0!==t.acceptLanguage&&(e["accept-language"]=t.acceptLanguage),void 0!==t.deviceHashId&&(e["x-device-id"]=t.deviceHashId),void 0!==t.browserType&&(e["nv-browser-type"]=t.browserType),t.clientHeaders)for(const[i,n]of t.clientHeaders)"x-nv-client-identity"!==(t=i).toLowerCase()&&(e[t.toLowerCase()]=n);(e=this.$g$).telemetryEventIds={},e.sessionId="",e.subSessionId="",e.cmsId="",d.d("{6bae601}","{5af3344}")}uninitialize(){this.cancelSessionSetup(),d.removeListener("Log",this.$D$),this.removeAllListeners()}updateTelemetryEventIds(e){this.$g$.updateTelemetryEventIds(e)}getAllActiveSessions(){h(u(),"GetSessionList",(()=>(Ye(this),async function(e){if(d.d("{6bae601}","{1aef200}"),null==e.$h$){let t={sessionList:[],error:{code:3237093383,description:"Gridserver not initialized"}};e.emit("ActiveSessionsResult",t),Xe(t.error)}else await Qe(e,5,e.protocol+e.$h$.serverAddress+"/v2/session","").then((t=>{var i;let n={sessionList:null!==(i=t.sessionList)&&void 0!==i?i:[]};15859712!=t.result?(t={code:t.result,description:Ke(t.result)},n.error=t,d.e("{6bae601}","{9d2bb75}",y(t.code))):d.d("{6bae601}","{081857f}"),e.emit("ActiveSessionsResult",n)})).catch((t=>{d.e("{6bae601}","{63f9b57}",t.message),d.e("{6bae601}","{94d55bb}",t,t.stack),He(e.$g$,t,"getAllActiveSessions"),e.emit("ActiveSessionsResult",{sessionList:[],error:{code:3237093384,description:Ke(3237093384)}})})),d.d("{6bae601}","{a9e5439}")}(this))))}getSessionId(){var e;return null!==(e=this.$B$.get(this.subSessionId))&&void 0!==e?e:""}getSubSessionId(){return this.subSessionId}putOrPostSession(e,t,i){return h(u(),i?"PutSession":"PostSession",(()=>(Ye(this),function(e,t,i){const n=!!i;if(Ze(e,M(),i),null==e.$h$)return et({code:3237093383,description:"Gridserver not initialized"});if(e.$s$)return et({code:3237093382,description:"Previous PutOrPost call is still in progress"});e.$g$.cmsId=t.appId,e.zoneName=void 0,e.zoneAddress=void 0,e.gpuType=void 0;const s=Ve(e.$g$,e.$h$.serverAddress,n,t.networkSessionId,i);let o=(c=t,l=it($=e,l=i),$.clientLocale=null!==(u=c.clientLocale)&&void 0!==u?u:"en_US",l+="?keyboardLayout="+(null!==(h=c.keyboardLayout)&&void 0!==h?h:"en_US"),l+="&languageCode="+$.clientLocale),r=function(e,t,i){var n,s,o,r,a,$,c,l,u,h,p,m,f,g,v,A,b,w;let S;switch(t.appLaunchMode){case 2:d.d("{6bae601}","{6d5cf87}"),S=3;break;case 1:S=2;break;default:S=1}let y=null!==(o=null===(s=null===(n=t.monitorSettings)||void 0===n?void 0:n[0])||void 0===s?void 0:s.sdrHdrMode)&&void 0!==o?o:0;if(n=[],t.monitorSettings)n=t.monitorSettings;else for(k of t.streamParams)n.push({heightInPixels:k.height,framesPerSecond:k.fps,widthInPixels:k.width});if(je.hdr){y=1;for(const e of n)e.sdrHdrMode=1}var k={audioMode:2,remoteControllersBitmap:null!==(r=t.remoteControllersBitmap)&&void 0!==r?r:0,sdrHdrMode:y,networkTestSessionId:null,availableSupportedControllers:[],clientVersion:null!==($=null===(a=e.$h$)||void 0===a?void 0:a.clientVersion)&&void 0!==$?$:"0",deviceHashId:null!==(l=null===(c=e.$h$)||void 0===c?void 0:c.deviceHashId)&&void 0!==l?l:"unknown",internalTitle:null,clientPlatformName:null!==(h=null===(u=e.$h$)||void 0===u?void 0:u.clientPlatformName)&&void 0!==h?h:"unknown",metaData:[{key:"SubSessionId",value:e.getSubSessionId()},{key:"wssignaling",value:je.$webSocketSignaling$?"1":"0"}],surroundAudioInfo:0,clientTimezoneOffset:null!==(p=t.clientTimeZoneOffset)&&void 0!==p?p:-6e4*(new Date).getTimezoneOffset(),clientIdentification:null!==(f=null===(m=e.$h$)||void 0===m?void 0:m.clientIdentification)&&void 0!==f?f:"unknown",parentSessionId:null,appId:t.appId,streamerVersion:1,clientRequestMonitorSettings:n,appLaunchMode:S,sdkVersion:"1.0",enchancedStreamMode:1,useOps:!0,clientDisplayHdrCapabilities:null,accountLinked:null!==(g=t.accountLinked)&&void 0!==g&&g,partnerCustomData:null!==(v=t.partnerCustomData)&&void 0!==v?v:"",enablePersistingInGameSettings:null!==(A=t.enablePersistingInGameSettings)&&void 0!==A&&A,secureRTSPSupported:!1,userAge:null!==(b=t.userAge)&&void 0!==b?b:0};void 0!==t.requestedAudioFormat&&(k.requestedAudioFormat=t.requestedAudioFormat),je.$webRtcStreamer$||"browser"===(null===(w=e.$h$)||void 0===w?void 0:w.clientPlatformName)?k.metaData.push({key:"GSStreamerType",value:"WebRTC"}):k.secureRTSPSupported=!0;for(const e in t.metaData)k.metaData.push({key:e,value:t.metaData[e]});return e={sessionRequestData:k},e=i?JSON.stringify({action:2,data:"RESUME",sessionRequestData:k,metaData:[]}):JSON.stringify(e),d.i("{6bae601}","{c6c3ed4}",i?"PUT":"POST",d.sanitize(e)),e}(e,t,n),a=performance.now();var $,c,l,u,h;return new Promise(((t,$)=>{const c=new AbortController;e.$s$=c,Qe(e,n?1:0,o,r,c,i).then((n=>{var o,r,l,u,h;s.launchDuration=Math.round(performance.now()-a),null!==(o=n.$session$)&&void 0!==o&&o.sessionId&&(s.sessionId=null===(r=n.$session$)||void 0===r?void 0:r.sessionId,i=null===(l=n.$session$)||void 0===l?void 0:l.sessionId),e.zoneName=n.serverId||e.zoneName,n.$session$&&tt(e,n.$session$),s.zoneName=null!==(u=e.zoneName)&&void 0!==u?u:"",c.signal.aborted&&15867905!=n.result&&(n.result=15867905,d.d("{6bae601}","{3ec0e11}")),15859712==n.result?(d.d("{6bae601}","{30536f4}",i),Ze(e,e.getSubSessionId(),i),"ready_for_connection"==(null===(h=n.$session$)||void 0===h?void 0:h.state)?(s.result=y(15859712),Ge(e.$g$,s)):e.$o$.set(s.sessionId,s),t(n.$session$)):(n={code:n.result,sessionId:i,description:Ke(n.result),sessionList:n.sessionList},d.e("{6bae601}","{17f93f3}",y(n.code)),s.result=y(n.code),Ge(e.$g$,s),$(n))})).catch((t=>{let n={code:3237093384,sessionId:i,description:Ke(3237093384)};d.e("{6bae601}","{4318505}",t.message),d.e("{6bae601}","{94d55bb}",t,t.stack),He(e.$g$,t,"putOrPostSession"),s.result=y(n.code),Ge(e.$g$,s),$(n)}))})).finally((()=>{e.$s$=void 0}))}(this,e,i))))}getSession(e,t){return h(u(),"GetSession",(()=>(Ye(this),function(e,t,i){var n;if(null==e.$h$)return et({code:3237093383,description:"Gridserver not initialized"});let s=0,o=e.$o$.get(t);if(i&&!o){if(d.e("{6bae601}","{bb9b2e3}",t),e.$j$.has(t)){var r=e.$j$.get(t);r=null!==(n=null==r?void 0:r.server)&&void 0!==n?n:""}else r=e.$h$.serverAddress;o=Ve(e.$g$,r,!1,e.$o$.size.toString(),t)}const a=new AbortController;e.$v$=a;let $=performance.now();return new Promise(((n,r)=>{const c=t=>{o.result=y(t),o.launchDuration+=Math.round(performance.now()-$),Ge(e.$g$,o)},l=()=>{const e={code:1==s?15867906:15867905};e.description=Ke(e.code),Xe(e),c(e.code),r(e)},u=()=>{let $=it(e,t);Qe(e,3,$,"",a,t).then(($=>{var h,p,m,g,v,A;if(i)if($.$jsonResponse$&&$.$jsonResponse$.session.seatSetupInfo.seatSetupStep&&(s=$.$jsonResponse$.session.seatSetupInfo.seatSetupStep),$.$session$&&tt(e,$.$session$),15859712==$.result)if(o.zoneName=null!==(p=null===(h=$.$session$)||void 0===h?void 0:h.zoneName)&&void 0!==p?p:o.zoneName,"ready_for_connection"==(null===(m=$.$session$)||void 0===m?void 0:m.state)||"streaming"==(null===(g=$.$session$)||void 0===g?void 0:g.state))"streaming"==$.$session$.state&&e.$g$.$emitDebugEvent$("InvalidSessionStateTransition","Streaming"),c(15859712),n($.$session$);else if("initializing"==(null===(v=$.$session$)||void 0===v?void 0:v.state)||"resuming"==(null===(A=$.$session$)||void 0===A?void 0:A.state)){switch(p="Configuring",(h=$.$jsonResponse$.session).seatSetupInfo.seatSetupStep){case 0:p="Connecting";break;case 1:p="InQueue",h.seatSetupInfo.queuePosition<e.queuePosition&&(e.queuePosition=h.seatSetupInfo.queuePosition);break;case 5:p="PreviousSessionCleanup";break;default:e.queuePosition=0}h={sessionId:h.sessionId,subSessionId:e.subSessionId,queuePosition:"InQueue"===p?e.queuePosition:0,eta:h.seatSetupInfo.seatSetupEta,progressState:p},e.emit("ProgressUpdate",{sessionId:h.sessionId,subSessionId:h.subSessionId,queuePosition:h.queuePosition,eta:h.eta,state:h.progressState}),e.emit("SessionUpdate",h),$=$.$jsonResponse$.session,h=e.$m$.$minInterval$,1==$.seatSetupInfo.seatSetupStep&&0!=e.$m$.$queueSizePerStep$&&(h+=Math.floor($.seatSetupInfo.queuePosition/e.$m$.$queueSizePerStep$)*e.$m$.step),new f(Math.min(h,e.$m$.$maxInterval$),null==a?void 0:a.signal).promise.then(u).catch(l)}else d.e("{6bae601}","{ce47cd1}",d.sanitize(JSON.stringify($.$jsonResponse$))),c(($={code:3237093378,description:"unexpected session state"}).code),r($);else 15867905==$.result?l():($={code:$.result,sessionId:t,description:Ke($.result)},c($.code),r($));else 15859712==$.result?n($.$session$):r({code:$.result,description:Ke($.result)})})).catch((t=>{const n={code:3237093384,description:Ke(3237093384)};d.e("{6bae601}","{90d85cb}",t.message),d.e("{6bae601}","{94d55bb}",t,t.stack),He(e.$g$,t,"performGetSessionRequest"),i&&c(n.code),r(n)}))};u()})).finally((()=>{e.$v$=void 0,i&&(d.d("{6bae601}","{4ac0ec5}",t),e.$o$.delete(t),e.queuePosition=Number.MAX_VALUE)}))}(this,e,t))))}sendDeleteRequest(e){return h(u(),"DeleteSession",(()=>(Ye(this),function(e,t){if(null==e.$h$)return et({code:3237093383,description:"Gridserver not initialized"});let i=it(e,t);return new Promise(((n,s)=>{d.d("{6bae601}","{bbad3ce}",t),Qe(e,2,i,"",void 0,t).then((e=>{if(15859712==e.result)d.d("{6bae601}","{6206c13}",t),n();else{let i={code:e.result,description:Ke(e.result),sessionId:t};d.e("{6bae601}","{4de47e3}",t,y(e.result)),s(i)}})).catch((t=>{const i={code:3237093384,description:Ke(3237093384)};d.e("{6bae601}","{c4f620c}",t.message),d.e("{6bae601}","{94d55bb}",t,t.stack),He(e.$g$,t,"sendDeleteRequestImpl"),s(i)}))}))}(this,e))))}setAuthInfo(e){this.$C$=e}cancelSessionSetup(){var e,t;d.i("{6bae601}","{c73e640}"),null===(e=this.$s$)||void 0===e||e.abort(),null===(t=this.$v$)||void 0===t||t.abort(),this.$v$=this.$s$=void 0}getZoneName(){var e;return null!==(e=this.zoneName)&&void 0!==e?e:""}getZoneAddress(){var e;return null!==(e=this.zoneAddress)&&void 0!==e?e:""}getGpuType(){var e;return null!==(e=this.gpuType)&&void 0!==e?e:""}setNetworkType(e){this.$g$.setNetworkType(e)}},st=class extends nt{constructor(){super()}getAllActiveSessions(){window.setTimeout((()=>{d.d("{6bae601}","{b575263}"),this.emit("ActiveSessionsResult",{sessionList:[]})}),1)}putOrPostSession(e){var t;return d.d("{6bae601}","{71c010f}"),Ze(this,M(),null!==(t=e.sessionId)&&void 0!==t?t:"PassThruSessionId"),new Promise((t=>{window.setTimeout((()=>{let i={sessionId:this.getSessionId(),subSessionId:this.getSubSessionId(),accessToken:e.accessToken||"",appId:parseInt(e.appId),state:"ready_for_connection",signalConnectionInfo:{ip:"",port:49100,protocol:"http"},mediaConnectionInfo:[],streamInfo:[],appLaunchMode:e.appLaunchMode?e.appLaunchMode:0,zoneName:this.getZoneName(),zoneAddress:this.getZoneAddress(),gpuType:this.getGpuType(),clientLocale:""};if(this.$h$){if(i.signalConnectionInfo.ip=this.$h$.serverAddress,e.connectionInfo){i.mediaConnectionInfo=e.connectionInfo;for(const e of i.mediaConnectionInfo)14===e.usage&&(i.signalConnectionInfo.ip=e.ip,i.signalConnectionInfo.port=e.port,i.signalConnectionInfo.protocol=5===e.appLevelProtocol?"https":"http",d.d("{6bae601}","{c6b8e0f}",e.ip,e.port))}}else d.e("{6bae601}","{a43f57e}");if(e.monitorSettings)for(const t of e.monitorSettings)i.streamInfo.push({width:t.widthInPixels,height:t.heightInPixels,fps:t.framesPerSecond,sdrHdrMode:t.sdrHdrMode});else for(const t of e.streamParams)i.streamInfo.push({width:t.width,height:t.height,fps:t.fps});d.d("{6bae601}","{07dc276}",i.sessionId),t(i)}),1)}))}getSession(){return new Promise(((e,t)=>{t({code:-1,description:"PassthruPollingNotSupported"})}))}sendDeleteRequest(){return new Promise((e=>{e()}))}};window.GridServer=window.GridServer||{};var ot={allowUnconfined:!1,preventNavigation:!1};function rt(e){if(!((15868672^e)>>8))return 256;let t=32769;switch(e){case 15859712:case 15867908:case 15868418:t=0;break;case 3237093894:case 3237093899:t=32776;break;case 3237093898:t=32772;break;case 3237093900:t=32773;break;case 3237093901:t=32770;break;case 15867910:t=1;break;default:d.d("{c00be32}","{233ad08}",y(e))}return t}function at(e){let t=15868672;switch(e){case 256:t=15868704;break;case 257:t=15868705;break;case 258:t=15868706;break;case 259:t=15868707;break;case 260:t=15868708;break;case 261:t=15868709;break;case 262:t=15868710;break;case 263:t=15868711;break;case 264:t=15868712;break;case 265:t=15868713;break;case 266:t=15868714;break;case 267:t=15868715;break;case 268:t=15868716;break;case 512:t=15868736;break;case 513:t=15868737;break;case 514:t=15868738;break;case 515:t=15868739;break;case 516:t=15868740;break;case 517:t=15868741;break;case 518:t=15868742;break;case 519:t=15868743;break;case 520:t=15868744;break;case 521:t=15868745;break;case 33025:t=3237094145;break;case 33026:t=3237094146;break;case 33027:t=3237094147;break;case 33028:t=3237094148;break;case 33029:t=3237094149;break;case 33030:t=3237094150;break;case 33031:t=3237094151;break;case 33032:t=3237094152;break;case 33034:t=3237094153;break;case 33035:t=3237094154;break;case 33040:t=3237094155;break;case 33041:t=3237094156;break;case 33042:t=3237094157;break;case 37634:t=15868718;break;case 32768:t=3237094158;break;case 768:t=15868717;break;default:d.d("{c00be32}","{1be40ed}",y(e))}return t}function $t(){return dt||(dt=new lt),dt}function ct(e){"white"===e.$h$?e.$g$&&(e.$g$.clearColor(1,0,0,1),e.$g$.clear(e.$g$.COLOR_BUFFER_BIT),e.$h$="red"):e.$g$&&(e.$g$.clearColor(1,1,1,1),e.$g$.clear(e.$g$.COLOR_BUFFER_BIT),e.$h$="white")}var dt,lt=class{constructor(){this.$g$=null,this.$h$=""}initialize(e,t){if(this.$platformDetails$=t,t="ragnarok-latency-indicator",(i=document.getElementById(t))&&i instanceof HTMLCanvasElement&&i.parentElement===e.parentElement)e=i;else{if(i)do{t="ragnarok-latency-indicator"+Math.round(1e4*Math.random()),i=document.getElementById(t)}while(i);var i=document.createElement("canvas");i.id=t,i.style.position="fixed",w(this.$platformDetails$)?(i.style.bottom="env(safe-area-inset-bottom, 0)",i.style.right="max(24px, env(safe-area-inset-right, 0))"):(i.style.bottom="0",i.style.right="0"),i.style.width="40px",i.style.height="40px",i.style.zIndex="300",i.style.pointerEvents="none",e.insertAdjacentElement("afterend",i),e=i}this.$j$=e,this.$j$.style.display="block",this.$g$=this.$j$.getContext("webgl"),ct(this)}},ut={$ragnarokConfig$:{},clientConfigOverride:"",$remoteOverrideInfo$:{type:"UNKNOWN",version:""},$leanMode$:!1,$loggingEnabled$:!0,$consoleLoggingEnabled$:!1,$gamepadEnabled$:!0,$webrtcStatsEnabled$:!0,$statsUploadEnabled$:!0,maxBitrate:0,$resWidth$:0,$resHeight$:0,$gamepadRaf$:!1,$advancedGestures$:!0,$forceTouchCapable$:!1,$touchWarp$:!0,$storeTouch$:!1,$storeTouchGesture$:!1,$latencyTest$:!1,$gamepadTesterEnabled$:!1,$rsdmm$:!0,$rsdmmThumbstickToggle$:!1,$allowSourceReset$:!0,$allowAudioReset$:!0,$allowAutoplayChange$:!0,$allowEnableMic$:!0,$allowMutingVideo$:!0,$allowSendingTelemetry$:!0,fps:0};function ht(e,t){var i,n,s,o;e.$o$.$g$(void 0,null!==(i=null==t?void 0:t.message)&&void 0!==i?i:"",null!==(n=null==t?void 0:t.filename)&&void 0!==n?n:"",null!==(s=null==t?void 0:t.lineno)&&void 0!==s?s:0,null!==(o=null==t?void 0:t.colno)&&void 0!==o?o:0,!0,"WorkerError")}function pt(e){e.perf.RAFTS=0,e.perf.DCSend=0,e.perf.GetStats=0,e.perf.FrameInfo=0}function mt(){var e=vt;e.$h$=!1,e.$g$&&(d.d("{1f5ec29}","{76b05dd}"),e.$g$.postMessage({stopStats:!0}))}function ft(e){return performance.now()-e.$j$}function gt(e,t){var i,n=vt;n.$h$&&(t={webrtcStats:{type:t,stats:e},ackid:null===(i=n.$s$)||void 0===i?void 0:i.$g$++},n.$g$&&n.$g$.postMessage(t,e))}var vt=new class{constructor(){this.$h$=!1,this.$g$=null,this.$j$=0,this.$wsHandler$=null,this.$m$=[],this.$l$=[],this.perf={RAFTS:0,DCSend:0,GetStats:0,FrameInfo:0},d.i("{1f5ec29}","{139da36}");try{const e=URL.createObjectURL(new Blob(['\nvar $module$exports$output$stats$webrtcbinarystats$statsConfig$depr$$ = {size:70, version:1, name:"DEPR"}, $module$exports$output$stats$webrtcbinarystats$statsConfig$rtpv$$ = {size:80, version:3, name:"RTPV"}, $module$exports$output$stats$webrtcbinarystats$statsConfig$rtpa$$ = {size:48, version:1, name:"RTPA"}, $module$exports$output$stats$webrtcbinarystats$statsConfig$traa$$ = {size:88, version:1, name:"TRAA"}, $module$exports$output$stats$webrtcbinarystats$statsConfig$trav$$ = {size:44, version:1, \nname:"TRAV"}, $module$exports$output$stats$webrtcbinarystats$statsConfig$vfmd$$ = {size:12, version:1, name:"VFMD"}, $module$exports$output$stats$webrtcbinarystats$statsConfig$pfda$$ = {size:20, version:1, name:"PFDA"}, $module$exports$output$stats$webrtcbinarystats$statsConfig$none$$ = {size:0, version:1, name:""};\nfunction $JSCompiler_StaticMethods_createWebSocket$$($JSCompiler_StaticMethods_createWebSocket$self$$, $reconnect$jscomp$1$$ = !1) {\n  try {\n    let $header$jscomp$2$$;\n    $JSCompiler_StaticMethods_createWebSocket$self$$.url.includes("wss") && ($header$jscomp$2$$ = "x-nv-sessionid." + $JSCompiler_StaticMethods_createWebSocket$self$$.sessionId, $JSCompiler_StaticMethods_createWebSocket$self$$.accessToken && ($header$jscomp$2$$ += "-Authorization.Bearer-" + $JSCompiler_StaticMethods_createWebSocket$self$$.accessToken));\n    let $websocketUrl$$ = $JSCompiler_StaticMethods_createWebSocket$self$$.url;\n    $reconnect$jscomp$1$$ && ($websocketUrl$$ += "&reconnect=1");\n    let $localWs$$ = new WebSocket($websocketUrl$$, $header$jscomp$2$$);\n    $localWs$$.onopen = () => {\n      $JSCompiler_StaticMethods_createWebSocket$self$$.$h$("{aaf44dc}");\n      $JSCompiler_StaticMethods_createWebSocket$self$$.$l$.$openHandler$();\n      if ($localWs$$ === $JSCompiler_StaticMethods_createWebSocket$self$$.$g$) {\n        for (const $pendingMessage$$ of $JSCompiler_StaticMethods_createWebSocket$self$$.$j$) {\n          $pendingMessage$$.stats ? $localWs$$.send($pendingMessage$$.stats) : $localWs$$.send(JSON.stringify($pendingMessage$$));\n        }\n        for (const $pendingMessage$jscomp$1$$ of $JSCompiler_StaticMethods_createWebSocket$self$$.$o$) {\n          $JSCompiler_StaticMethods_sendOnWsReliablyIfNeeded$$($JSCompiler_StaticMethods_createWebSocket$self$$, $pendingMessage$jscomp$1$$);\n        }\n        $JSCompiler_StaticMethods_createWebSocket$self$$.$o$ = [];\n      }\n    };\n    $localWs$$.onclose = $event$jscomp$8$$ => {\n      $JSCompiler_StaticMethods_createWebSocket$self$$.$h$("{7a09ad8}");\n      $JSCompiler_StaticMethods_createWebSocket$self$$.$l$.$closeHandler$({error:$JSCompiler_StaticMethods_createWebSocket$self$$.$s$, code:$event$jscomp$8$$.code, reason:$event$jscomp$8$$.reason, wasClean:$event$jscomp$8$$.wasClean});\n      $localWs$$ === $JSCompiler_StaticMethods_createWebSocket$self$$.$g$ && ($JSCompiler_StaticMethods_createWebSocket$self$$.$g$ = void 0);\n      $JSCompiler_StaticMethods_createWebSocket$self$$.$s$ = !1;\n    };\n    $localWs$$.onerror = () => {\n      $JSCompiler_StaticMethods_createWebSocket$self$$.$h$("{418a180}");\n      $JSCompiler_StaticMethods_createWebSocket$self$$.$s$ = !0;\n    };\n    $localWs$$.onmessage = $ack$jscomp$inline_12_event$jscomp$10_wsMsg$$ => {\n      $ack$jscomp$inline_12_event$jscomp$10_wsMsg$$ = JSON.parse($ack$jscomp$inline_12_event$jscomp$10_wsMsg$$.data);\n      $JSCompiler_StaticMethods_createWebSocket$self$$.serverSupportsAck && $JSCompiler_StaticMethods_setHeartBeatTimeout$$($JSCompiler_StaticMethods_createWebSocket$self$$);\n      void 0 === $ack$jscomp$inline_12_event$jscomp$10_wsMsg$$.ackid || $JSCompiler_StaticMethods_createWebSocket$self$$.serverSupportsAck || ($JSCompiler_StaticMethods_createWebSocket$self$$.serverSupportsAck = !0, $JSCompiler_StaticMethods_createWebSocket$self$$.$h$("{523f5b9}"), $JSCompiler_StaticMethods_setHeartBeatTimeout$$($JSCompiler_StaticMethods_createWebSocket$self$$));\n      if (!$ack$jscomp$inline_12_event$jscomp$10_wsMsg$$.hb) {\n        if ($JSCompiler_StaticMethods_createWebSocket$self$$.serverSupportsAck) {\n          if (void 0 !== $ack$jscomp$inline_12_event$jscomp$10_wsMsg$$.ack) {\n            var $ack$jscomp$inline_8$$ = $ack$jscomp$inline_12_event$jscomp$10_wsMsg$$.ack;\n            for (let $i$jscomp$inline_9$$ = $JSCompiler_StaticMethods_createWebSocket$self$$.$j$.length - 1; 0 <= $i$jscomp$inline_9$$; $i$jscomp$inline_9$$--) {\n              $JSCompiler_StaticMethods_createWebSocket$self$$.$j$[$i$jscomp$inline_9$$].ackid <= $ack$jscomp$inline_8$$ && $JSCompiler_StaticMethods_createWebSocket$self$$.$j$.splice($i$jscomp$inline_9$$, 1);\n            }\n          }\n          void 0 !== $ack$jscomp$inline_12_event$jscomp$10_wsMsg$$.ackid ? ($JSCompiler_StaticMethods_createWebSocket$self$$.maxReceivedAckId < $ack$jscomp$inline_12_event$jscomp$10_wsMsg$$.ackid && ($JSCompiler_StaticMethods_createWebSocket$self$$.$l$.$messageHandler$($ack$jscomp$inline_12_event$jscomp$10_wsMsg$$), $JSCompiler_StaticMethods_createWebSocket$self$$.maxReceivedAckId = $ack$jscomp$inline_12_event$jscomp$10_wsMsg$$.ackid), $JSCompiler_StaticMethods_createWebSocket$self$$.$g$ && ($ack$jscomp$inline_12_event$jscomp$10_wsMsg$$ = \n          JSON.stringify({ack:$JSCompiler_StaticMethods_createWebSocket$self$$.maxReceivedAckId}), $JSCompiler_StaticMethods_createWebSocket$self$$.$h$("{903be10}" + $ack$jscomp$inline_12_event$jscomp$10_wsMsg$$), $JSCompiler_StaticMethods_createWebSocket$self$$.$g$.send($ack$jscomp$inline_12_event$jscomp$10_wsMsg$$))) : void 0 === $ack$jscomp$inline_12_event$jscomp$10_wsMsg$$.ack && $JSCompiler_StaticMethods_createWebSocket$self$$.$l$.$messageHandler$($ack$jscomp$inline_12_event$jscomp$10_wsMsg$$);\n        } else {\n          $JSCompiler_StaticMethods_createWebSocket$self$$.$l$.$messageHandler$($ack$jscomp$inline_12_event$jscomp$10_wsMsg$$);\n        }\n      }\n    };\n    $JSCompiler_StaticMethods_createWebSocket$self$$.$g$ = $localWs$$;\n  } catch ($exp$$) {\n    $JSCompiler_StaticMethods_createWebSocket$self$$.$g$ = void 0, $JSCompiler_StaticMethods_createWebSocket$self$$.$u$("WebSocket creation exception: " + $exp$$);\n  }\n}\nfunction $JSCompiler_StaticMethods_clearHeartBeatTimeout$$($JSCompiler_StaticMethods_clearHeartBeatTimeout$self$$) {\n  0 !== $JSCompiler_StaticMethods_clearHeartBeatTimeout$self$$.$m$ && (self.clearTimeout($JSCompiler_StaticMethods_clearHeartBeatTimeout$self$$.$m$), $JSCompiler_StaticMethods_clearHeartBeatTimeout$self$$.$m$ = 0);\n}\nfunction $JSCompiler_StaticMethods_setHeartBeatTimeout$$($JSCompiler_StaticMethods_setHeartBeatTimeout$self$$) {\n  $JSCompiler_StaticMethods_clearHeartBeatTimeout$$($JSCompiler_StaticMethods_setHeartBeatTimeout$self$$);\n  $JSCompiler_StaticMethods_setHeartBeatTimeout$self$$.$m$ = self.setTimeout(() => {\n    var $_a$jscomp$inline_15$$;\n    $JSCompiler_StaticMethods_setHeartBeatTimeout$self$$.$h$("{6c3505a}" + (null === ($_a$jscomp$inline_15$$ = $JSCompiler_StaticMethods_setHeartBeatTimeout$self$$.$g$) || void 0 === $_a$jscomp$inline_15$$ ? void 0 : $_a$jscomp$inline_15$$.readyState));\n    $JSCompiler_StaticMethods_setHeartBeatTimeout$self$$.$g$ || $JSCompiler_StaticMethods_createWebSocket$$($JSCompiler_StaticMethods_setHeartBeatTimeout$self$$, !0);\n    $JSCompiler_StaticMethods_setHeartBeatTimeout$$($JSCompiler_StaticMethods_setHeartBeatTimeout$self$$);\n  }, 3000);\n}\nfunction $JSCompiler_StaticMethods_sendOnWsReliablyIfNeeded$$($JSCompiler_StaticMethods_sendOnWsReliablyIfNeeded$self$$, $data$jscomp$81$$) {\n  void 0 !== $data$jscomp$81$$.ackid && $JSCompiler_StaticMethods_sendOnWsReliablyIfNeeded$self$$.serverSupportsAck && void 0 !== $data$jscomp$81$$.ackid && $JSCompiler_StaticMethods_sendOnWsReliablyIfNeeded$self$$.$j$.push($data$jscomp$81$$);\n  $JSCompiler_StaticMethods_sendOnWsReliablyIfNeeded$self$$.$g$ && ($data$jscomp$81$$.stats ? $JSCompiler_StaticMethods_sendOnWsReliablyIfNeeded$self$$.$g$.send($data$jscomp$81$$.stats) : $JSCompiler_StaticMethods_sendOnWsReliablyIfNeeded$self$$.$g$.send(JSON.stringify($data$jscomp$81$$)));\n}\nvar $module$exports$output$websocketimpl$WebSocketImpl$$ = class {\n  constructor() {\n    var $JSCompiler_object_inline_wsHandler_68$$ = {$messageHandler$:$module$contents$output$ragnarokworker_wsMessageHandler$$, $openHandler$:$module$contents$output$ragnarokworker_wsOpenHandler$$, $closeHandler$:$module$contents$output$ragnarokworker_wsCloseHandler$$, $openingHandler$:$module$contents$output$ragnarokworker_wsOpeningHandler$$}, $JSCompiler_object_inline_info_70$$ = $module$contents$output$ragnarokworker_workerLogger$$, $JSCompiler_object_inline_exception_71$$ = $module$contents$output$ragnarokworker_workerException$$;\n    this.sessionId = $module$contents$output$ragnarokworker_sessionId$$;\n    this.accessToken = "";\n    this.serverSupportsAck = this.$s$ = !1;\n    this.$j$ = [];\n    this.$o$ = [];\n    this.maxReceivedAckId = this.$m$ = 0;\n    this.url = "";\n    this.$h$ = $JSCompiler_object_inline_info_70$$;\n    this.$u$ = $JSCompiler_object_inline_exception_71$$;\n    this.$l$ = $JSCompiler_object_inline_wsHandler_68$$;\n  }\n  initialize($url$jscomp$22$$, $maxReceivedAckId$$, $serverSupportsAck$$, $reconnect$$ = !1) {\n    this.url = $url$jscomp$22$$;\n    this.maxReceivedAckId = $maxReceivedAckId$$;\n    this.serverSupportsAck = $serverSupportsAck$$;\n    $JSCompiler_StaticMethods_createWebSocket$$(this, $reconnect$$);\n    this.$h$("{f4b05a4}");\n  }\n  uninitialize($closeCode$$) {\n    var $_a$$;\n    this.maxReceivedAckId = 0;\n    this.serverSupportsAck = !1;\n    this.$j$ = [];\n    this.$o$ = [];\n    $JSCompiler_StaticMethods_clearHeartBeatTimeout$$(this);\n    null === ($_a$$ = this.$g$) || void 0 === $_a$$ ? void 0 : $_a$$.close($closeCode$$);\n    this.$h$("{986b258}" + $closeCode$$);\n  }\n  reconnect() {\n    $JSCompiler_StaticMethods_createWebSocket$$(this, !0);\n  }\n  send($data$jscomp$82$$) {\n    this.serverSupportsAck || this.$g$ || $JSCompiler_StaticMethods_createWebSocket$$(this, !0);\n    this.$g$ && this.$g$.readyState === WebSocket.OPEN ? $JSCompiler_StaticMethods_sendOnWsReliablyIfNeeded$$(this, $data$jscomp$82$$) : this.$o$.push($data$jscomp$82$$);\n  }\n};\nconst $module$contents$output$ragnarokworker_ctx$$ = self;\nlet $module$contents$output$ragnarokworker_perfs$$ = [], $module$contents$output$ragnarokworker_clientEvents$$ = [];\nfunction $JSCompiler_StaticMethods_addReport$$($report$$) {\n  var $JSCompiler_StaticMethods_addReport$self$$ = $module$contents$output$ragnarokworker_webrtcBinaryStats$$;\n  let $buffer$jscomp$16$$ = $JSCompiler_StaticMethods_addReport$self$$.$g$.get($report$$.type);\n  $buffer$jscomp$16$$ || ($buffer$jscomp$16$$ = [], $JSCompiler_StaticMethods_addReport$self$$.$g$.set($report$$.type, $buffer$jscomp$16$$));\n  for (const $element$jscomp$8$$ of $report$$.stats) {\n    $buffer$jscomp$16$$.push($element$jscomp$8$$);\n  }\n}\nfunction $JSCompiler_StaticMethods_getStatsConfig$$($type$jscomp$158$$) {\n  switch($type$jscomp$158$$) {\n    case 0:\n      return $module$exports$output$stats$webrtcbinarystats$statsConfig$depr$$;\n    case 1:\n      return $module$exports$output$stats$webrtcbinarystats$statsConfig$rtpv$$;\n    case 2:\n      return $module$exports$output$stats$webrtcbinarystats$statsConfig$rtpa$$;\n    case 3:\n      return $module$exports$output$stats$webrtcbinarystats$statsConfig$trav$$;\n    case 4:\n      return $module$exports$output$stats$webrtcbinarystats$statsConfig$traa$$;\n    case 5:\n      return $module$exports$output$stats$webrtcbinarystats$statsConfig$vfmd$$;\n    case 6:\n      return $module$exports$output$stats$webrtcbinarystats$statsConfig$pfda$$;\n    default:\n      return $module$exports$output$stats$webrtcbinarystats$statsConfig$none$$;\n  }\n}\nlet $module$contents$output$ragnarokworker_webrtcBinaryStats$$ = new class {\n  constructor() {\n    this.$g$ = new Map();\n    this.$g$.clear();\n  }\n  size() {\n    let $totalSize$$ = 0;\n    for (let [, $array__tsickle_destructured_2$$] of this.$g$) {\n      let $array$jscomp$6$$ = $array__tsickle_destructured_2$$;\n      for (let $value$jscomp$91$$ of $array$jscomp$6$$) {\n        $totalSize$$ += $value$jscomp$91$$.byteLength;\n      }\n    }\n    return $totalSize$$ += 9 * this.$g$.size;\n  }\n  write($dest$jscomp$1$$, $arr$jscomp$inline_38_arrayBuffer_source$jscomp$inline_34_startOffset$$) {\n    var $elementCount$jscomp$inline_26_offset$jscomp$26_offset$jscomp$inline_35$$ = $arr$jscomp$inline_38_arrayBuffer_source$jscomp$inline_34_startOffset$$;\n    for (let [$key__tsickle_destructured_3$$, $arrayBuffer__tsickle_destructured_4$$] of this.$g$) {\n      $arr$jscomp$inline_38_arrayBuffer_source$jscomp$inline_34_startOffset$$ = $arrayBuffer__tsickle_destructured_4$$;\n      var $JSCompiler_temp_const$jscomp$3_JSCompiler_temp_const$jscomp$5$$ = $elementCount$jscomp$inline_26_offset$jscomp$26_offset$jscomp$inline_35$$, $dest$jscomp$inline_33_offset$jscomp$inline_24$$ = $elementCount$jscomp$inline_26_offset$jscomp$26_offset$jscomp$inline_35$$;\n      $elementCount$jscomp$inline_26_offset$jscomp$26_offset$jscomp$inline_35$$ = $arr$jscomp$inline_38_arrayBuffer_source$jscomp$inline_34_startOffset$$.length;\n      var $byteCount$jscomp$inline_36_config$jscomp$inline_27$$ = $JSCompiler_StaticMethods_getStatsConfig$$($key__tsickle_destructured_3$$);\n      let $chunkType$jscomp$inline_28$$ = $byteCount$jscomp$inline_36_config$jscomp$inline_27$$.name, $dataBufferView$jscomp$inline_29$$ = new DataView($dest$jscomp$1$$.buffer);\n      for (let $i$jscomp$inline_30$$ = 0; 4 > $i$jscomp$inline_30$$; $i$jscomp$inline_30$$++) {\n        $dataBufferView$jscomp$inline_29$$.setUint8($dest$jscomp$inline_33_offset$jscomp$inline_24$$ + $i$jscomp$inline_30$$, $chunkType$jscomp$inline_28$$.charCodeAt($i$jscomp$inline_30$$));\n      }\n      $dataBufferView$jscomp$inline_29$$.setUint8($dest$jscomp$inline_33_offset$jscomp$inline_24$$ + 4, $byteCount$jscomp$inline_36_config$jscomp$inline_27$$.version);\n      $dataBufferView$jscomp$inline_29$$.setUint16($dest$jscomp$inline_33_offset$jscomp$inline_24$$ + 5, $elementCount$jscomp$inline_26_offset$jscomp$26_offset$jscomp$inline_35$$, !0);\n      $dataBufferView$jscomp$inline_29$$.setUint16($dest$jscomp$inline_33_offset$jscomp$inline_24$$ + 7, $byteCount$jscomp$inline_36_config$jscomp$inline_27$$.size, !0);\n      $JSCompiler_temp_const$jscomp$3_JSCompiler_temp_const$jscomp$5$$ = $elementCount$jscomp$inline_26_offset$jscomp$26_offset$jscomp$inline_35$$ = $JSCompiler_temp_const$jscomp$3_JSCompiler_temp_const$jscomp$5$$ + 9;\n      $dest$jscomp$inline_33_offset$jscomp$inline_24$$ = $dest$jscomp$1$$;\n      $byteCount$jscomp$inline_36_config$jscomp$inline_27$$ = 0;\n      for (let $value$jscomp$inline_37$$ of $arr$jscomp$inline_38_arrayBuffer_source$jscomp$inline_34_startOffset$$) {\n        $arr$jscomp$inline_38_arrayBuffer_source$jscomp$inline_34_startOffset$$ = new Uint8Array($value$jscomp$inline_37$$), $dest$jscomp$inline_33_offset$jscomp$inline_24$$.set($arr$jscomp$inline_38_arrayBuffer_source$jscomp$inline_34_startOffset$$, $elementCount$jscomp$inline_26_offset$jscomp$26_offset$jscomp$inline_35$$ + $byteCount$jscomp$inline_36_config$jscomp$inline_27$$), $byteCount$jscomp$inline_36_config$jscomp$inline_27$$ += $value$jscomp$inline_37$$.byteLength;\n      }\n      $elementCount$jscomp$inline_26_offset$jscomp$26_offset$jscomp$inline_35$$ = $JSCompiler_temp_const$jscomp$3_JSCompiler_temp_const$jscomp$5$$ + $byteCount$jscomp$inline_36_config$jscomp$inline_27$$;\n    }\n    return $elementCount$jscomp$inline_26_offset$jscomp$26_offset$jscomp$inline_35$$;\n  }\n}(), $module$contents$output$ragnarokworker_sessionId$$ = "", $module$contents$output$ragnarokworker_url$$ = "", $module$contents$output$ragnarokworker_statsHeaderObj$$ = null, $module$contents$output$ragnarokworker_webSocket$$ = void 0, $module$contents$output$ragnarokworker_uploadIntervalId$$ = 0, $module$contents$output$ragnarokworker_streamingQuality$$ = [], $module$contents$output$ragnarokworker_mtbDurations$$ = [], $module$contents$output$ragnarokworker_inputChannelStats$$ = [], $module$contents$output$ragnarokworker_garbageCollectionStats$$ = \n[], $module$contents$output$ragnarokworker_serverSupportsAck$$ = !1, $module$contents$output$ragnarokworker_nextAckIdToSendForStats$$ = 0;\nfunction $module$contents$output$ragnarokworker_workerLogger$$($logmsg$$) {\n  $module$contents$output$ragnarokworker_ctx$$.postMessage({log:$logmsg$$});\n}\nfunction $module$contents$output$ragnarokworker_workerException$$($expmsg$$) {\n  $module$contents$output$ragnarokworker_ctx$$.postMessage({exception:$expmsg$$});\n}\nfunction $module$contents$output$ragnarokworker_clearCachedData$$() {\n  $module$contents$output$ragnarokworker_perfs$$ = [];\n  $module$contents$output$ragnarokworker_clientEvents$$ = [];\n  $module$contents$output$ragnarokworker_webrtcBinaryStats$$.$g$.clear();\n  $module$contents$output$ragnarokworker_streamingQuality$$ = [];\n  $module$contents$output$ragnarokworker_mtbDurations$$ = [];\n  $module$contents$output$ragnarokworker_inputChannelStats$$ = [];\n  $module$contents$output$ragnarokworker_garbageCollectionStats$$ = [];\n}\nfunction $module$contents$output$ragnarokworker_writeChunkHeader$$($dataBufferView$jscomp$1$$, $offset$jscomp$29$$, $chunkType$jscomp$1$$, $version$jscomp$4$$, $elementCount$jscomp$1$$, $sizeOfElement$$) {\n  for (let $i$jscomp$5$$ = 0; 4 > $i$jscomp$5$$; $i$jscomp$5$$++) {\n    $dataBufferView$jscomp$1$$.setUint8($offset$jscomp$29$$ + $i$jscomp$5$$, $chunkType$jscomp$1$$.charCodeAt($i$jscomp$5$$));\n  }\n  $dataBufferView$jscomp$1$$.setUint8($offset$jscomp$29$$ + 4, $version$jscomp$4$$);\n  $dataBufferView$jscomp$1$$.setUint16($offset$jscomp$29$$ + 5, $elementCount$jscomp$1$$, !0);\n  $dataBufferView$jscomp$1$$.setUint16($offset$jscomp$29$$ + 7, $sizeOfElement$$, !0);\n}\nfunction $module$contents$output$ragnarokworker_asInt32$$($num$jscomp$6$$) {\n  return 0 > $num$jscomp$6$$ ? Math.max($num$jscomp$6$$, -2147483648) : Math.min($num$jscomp$6$$, 4294967295);\n}\nfunction $module$contents$output$ragnarokworker_uploadData$$() {\n  if (($module$contents$output$ragnarokworker_perfs$$.length || $module$contents$output$ragnarokworker_clientEvents$$.length) && $module$contents$output$ragnarokworker_statsHeaderObj$$) {\n    try {\n      $module$contents$output$ragnarokworker_statsHeaderObj$$.ackid = $module$contents$output$ragnarokworker_serverSupportsAck$$ ? $module$contents$output$ragnarokworker_nextAckIdToSendForStats$$ : void 0;\n      var $header$jscomp$3_offset$jscomp$36$$ = JSON.stringify($module$contents$output$ragnarokworker_statsHeaderObj$$);\n      $i$jscomp$12_len$$ = $header$jscomp$3_offset$jscomp$36$$.length;\n      $i$jscomp$inline_48_offset$jscomp$inline_43_totalLen$$ = $i$jscomp$12_len$$ + 2;\n      var $headerBytesBuffer_i$jscomp$inline_44_j$jscomp$inline_50$$ = new ArrayBuffer($i$jscomp$inline_48_offset$jscomp$inline_43_totalLen$$);\n      const $headerView$$ = new DataView($headerBytesBuffer_i$jscomp$inline_44_j$jscomp$inline_50$$);\n      $headerView$$.setUint16(0, $i$jscomp$12_len$$);\n      for (var $i$jscomp$12_len$$ = 2; $i$jscomp$12_len$$ < $i$jscomp$inline_48_offset$jscomp$inline_43_totalLen$$; ++$i$jscomp$12_len$$) {\n        $headerView$$.setUint8($i$jscomp$12_len$$, $header$jscomp$3_offset$jscomp$36$$.charCodeAt($i$jscomp$12_len$$ - 2));\n      }\n      $dataBufferView$jscomp$inline_42_headerBufferBytes_offset$jscomp$inline_47$$ = new Uint8Array($headerBytesBuffer_i$jscomp$inline_44_j$jscomp$inline_50$$);\n      $dataBufferView$jscomp$inline_46_i$jscomp$inline_54_perfDataSize$$ = 13 * $module$contents$output$ragnarokworker_perfs$$.length;\n      $dataBufferView$jscomp$inline_52_eventsDataSize_i$jscomp$inline_62_offset$jscomp$inline_57$$ = 72 * $module$contents$output$ragnarokworker_clientEvents$$.length;\n      $dataBufferView$jscomp$inline_56_offset$jscomp$inline_61_sqEventsDataSize$$ = 12 * $module$contents$output$ragnarokworker_streamingQuality$$.length;\n      $dataBufferView$jscomp$inline_60_durationDataSize_i$jscomp$inline_66$$ = 10 * $module$contents$output$ragnarokworker_mtbDurations$$.length;\n      $dataBufferView$jscomp$inline_64_inputChannelDataSize$$ = 12 * $module$contents$output$ragnarokworker_inputChannelStats$$.length;\n      const $garbageCollectionDataSize$$ = 16 * $module$contents$output$ragnarokworker_garbageCollectionStats$$.length;\n      let $totalSize$jscomp$1$$ = 9 + $dataBufferView$jscomp$inline_42_headerBufferBytes_offset$jscomp$inline_47$$.length;\n      $dataBufferView$jscomp$inline_46_i$jscomp$inline_54_perfDataSize$$ && ($totalSize$jscomp$1$$ += 9 + $dataBufferView$jscomp$inline_46_i$jscomp$inline_54_perfDataSize$$);\n      $dataBufferView$jscomp$inline_52_eventsDataSize_i$jscomp$inline_62_offset$jscomp$inline_57$$ && ($totalSize$jscomp$1$$ += 9 + $dataBufferView$jscomp$inline_52_eventsDataSize_i$jscomp$inline_62_offset$jscomp$inline_57$$);\n      $dataBufferView$jscomp$inline_56_offset$jscomp$inline_61_sqEventsDataSize$$ && ($totalSize$jscomp$1$$ += 9 + $dataBufferView$jscomp$inline_56_offset$jscomp$inline_61_sqEventsDataSize$$);\n      $dataBufferView$jscomp$inline_60_durationDataSize_i$jscomp$inline_66$$ && ($totalSize$jscomp$1$$ += 9 + $dataBufferView$jscomp$inline_60_durationDataSize_i$jscomp$inline_66$$);\n      $dataBufferView$jscomp$inline_64_inputChannelDataSize$$ && ($totalSize$jscomp$1$$ += 9 + $dataBufferView$jscomp$inline_64_inputChannelDataSize$$);\n      $garbageCollectionDataSize$$ && ($totalSize$jscomp$1$$ += 9 + $garbageCollectionDataSize$$);\n      $totalSize$jscomp$1$$ += $module$contents$output$ragnarokworker_webrtcBinaryStats$$.size();\n      const $dataBuffer$$ = new ArrayBuffer($totalSize$jscomp$1$$);\n      $dataBufferView$jscomp$8_offset$jscomp$inline_65$$ = new DataView($dataBuffer$$);\n      $header$jscomp$3_offset$jscomp$36$$ = 0;\n      (new Uint8Array($dataBuffer$$)).set($dataBufferView$jscomp$inline_42_headerBufferBytes_offset$jscomp$inline_47$$);\n      $header$jscomp$3_offset$jscomp$36$$ += $dataBufferView$jscomp$inline_42_headerBufferBytes_offset$jscomp$inline_47$$.length;\n      $module$contents$output$ragnarokworker_writeChunkHeader$$($dataBufferView$jscomp$8_offset$jscomp$inline_65$$, $header$jscomp$3_offset$jscomp$36$$, "BPRF", 1, 0, 0);\n      $header$jscomp$3_offset$jscomp$36$$ += 9;\n      if ($dataBufferView$jscomp$inline_46_i$jscomp$inline_54_perfDataSize$$) {\n        $module$contents$output$ragnarokworker_writeChunkHeader$$($dataBufferView$jscomp$8_offset$jscomp$inline_65$$, $header$jscomp$3_offset$jscomp$36$$, "PERF", 2, $module$contents$output$ragnarokworker_perfs$$.length, 13);\n        $header$jscomp$3_offset$jscomp$36$$ += 9;\n        var $dataBufferView$jscomp$inline_42_headerBufferBytes_offset$jscomp$inline_47$$ = $dataBufferView$jscomp$8_offset$jscomp$inline_65$$, $i$jscomp$inline_48_offset$jscomp$inline_43_totalLen$$ = $header$jscomp$3_offset$jscomp$36$$;\n        for ($headerBytesBuffer_i$jscomp$inline_44_j$jscomp$inline_50$$ = 0; $headerBytesBuffer_i$jscomp$inline_44_j$jscomp$inline_50$$ < $module$contents$output$ragnarokworker_perfs$$.length; $headerBytesBuffer_i$jscomp$inline_44_j$jscomp$inline_50$$++) {\n          $dataBufferView$jscomp$inline_42_headerBufferBytes_offset$jscomp$inline_47$$.setFloat64($i$jscomp$inline_48_offset$jscomp$inline_43_totalLen$$, $module$contents$output$ragnarokworker_perfs$$[$headerBytesBuffer_i$jscomp$inline_44_j$jscomp$inline_50$$].RAFTS, !0), $dataBufferView$jscomp$inline_42_headerBufferBytes_offset$jscomp$inline_47$$.setUint16($i$jscomp$inline_48_offset$jscomp$inline_43_totalLen$$ + 8, Math.min(1000 * $module$contents$output$ragnarokworker_perfs$$[$headerBytesBuffer_i$jscomp$inline_44_j$jscomp$inline_50$$].DCSend, \n          65535), !0), $dataBufferView$jscomp$inline_42_headerBufferBytes_offset$jscomp$inline_47$$.setUint16($i$jscomp$inline_48_offset$jscomp$inline_43_totalLen$$ + 10, Math.min(1000 * $module$contents$output$ragnarokworker_perfs$$[$headerBytesBuffer_i$jscomp$inline_44_j$jscomp$inline_50$$].GetStats, 65535), !0), $dataBufferView$jscomp$inline_42_headerBufferBytes_offset$jscomp$inline_47$$.setUint8($i$jscomp$inline_48_offset$jscomp$inline_43_totalLen$$ + 12, $module$contents$output$ragnarokworker_perfs$$[$headerBytesBuffer_i$jscomp$inline_44_j$jscomp$inline_50$$].FrameInfo), \n          $i$jscomp$inline_48_offset$jscomp$inline_43_totalLen$$ += 13;\n        }\n        $header$jscomp$3_offset$jscomp$36$$ += $dataBufferView$jscomp$inline_46_i$jscomp$inline_54_perfDataSize$$;\n      }\n      if ($dataBufferView$jscomp$inline_52_eventsDataSize_i$jscomp$inline_62_offset$jscomp$inline_57$$) {\n        $module$contents$output$ragnarokworker_writeChunkHeader$$($dataBufferView$jscomp$8_offset$jscomp$inline_65$$, $header$jscomp$3_offset$jscomp$36$$, "EVNT", 1, $module$contents$output$ragnarokworker_clientEvents$$.length, 72);\n        $header$jscomp$3_offset$jscomp$36$$ += 9;\n        var $dataBufferView$jscomp$inline_46_i$jscomp$inline_54_perfDataSize$$ = $dataBufferView$jscomp$8_offset$jscomp$inline_65$$;\n        $dataBufferView$jscomp$inline_42_headerBufferBytes_offset$jscomp$inline_47$$ = $header$jscomp$3_offset$jscomp$36$$;\n        for ($i$jscomp$inline_48_offset$jscomp$inline_43_totalLen$$ = 0; $i$jscomp$inline_48_offset$jscomp$inline_43_totalLen$$ < $module$contents$output$ragnarokworker_clientEvents$$.length; $i$jscomp$inline_48_offset$jscomp$inline_43_totalLen$$++) {\n          $dataBufferView$jscomp$inline_46_i$jscomp$inline_54_perfDataSize$$.setFloat64($dataBufferView$jscomp$inline_42_headerBufferBytes_offset$jscomp$inline_47$$, $module$contents$output$ragnarokworker_clientEvents$$[$i$jscomp$inline_48_offset$jscomp$inline_43_totalLen$$].TS, !0);\n          $dataBufferView$jscomp$inline_42_headerBufferBytes_offset$jscomp$inline_47$$ += 8;\n          $eventstr$jscomp$inline_49_i$jscomp$inline_58_offset$jscomp$inline_53$$ = $module$contents$output$ragnarokworker_clientEvents$$[$i$jscomp$inline_48_offset$jscomp$inline_43_totalLen$$].eventtype;\n          for ($headerBytesBuffer_i$jscomp$inline_44_j$jscomp$inline_50$$ = 0; $headerBytesBuffer_i$jscomp$inline_44_j$jscomp$inline_50$$ < $eventstr$jscomp$inline_49_i$jscomp$inline_58_offset$jscomp$inline_53$$.length && 63 > $headerBytesBuffer_i$jscomp$inline_44_j$jscomp$inline_50$$; $headerBytesBuffer_i$jscomp$inline_44_j$jscomp$inline_50$$++) {\n            $dataBufferView$jscomp$inline_46_i$jscomp$inline_54_perfDataSize$$.setUint8($dataBufferView$jscomp$inline_42_headerBufferBytes_offset$jscomp$inline_47$$ + $headerBytesBuffer_i$jscomp$inline_44_j$jscomp$inline_50$$, $eventstr$jscomp$inline_49_i$jscomp$inline_58_offset$jscomp$inline_53$$.charCodeAt($headerBytesBuffer_i$jscomp$inline_44_j$jscomp$inline_50$$));\n          }\n          $dataBufferView$jscomp$inline_46_i$jscomp$inline_54_perfDataSize$$.setUint8($dataBufferView$jscomp$inline_42_headerBufferBytes_offset$jscomp$inline_47$$ + $headerBytesBuffer_i$jscomp$inline_44_j$jscomp$inline_50$$, 0);\n          $dataBufferView$jscomp$inline_42_headerBufferBytes_offset$jscomp$inline_47$$ += 64;\n        }\n        $header$jscomp$3_offset$jscomp$36$$ += $dataBufferView$jscomp$inline_52_eventsDataSize_i$jscomp$inline_62_offset$jscomp$inline_57$$;\n      }\n      if ($dataBufferView$jscomp$inline_56_offset$jscomp$inline_61_sqEventsDataSize$$) {\n        $module$contents$output$ragnarokworker_writeChunkHeader$$($dataBufferView$jscomp$8_offset$jscomp$inline_65$$, $header$jscomp$3_offset$jscomp$36$$, "SQEV", 1, $module$contents$output$ragnarokworker_streamingQuality$$.length, 12);\n        $header$jscomp$3_offset$jscomp$36$$ += 9;\n        var $dataBufferView$jscomp$inline_52_eventsDataSize_i$jscomp$inline_62_offset$jscomp$inline_57$$ = $dataBufferView$jscomp$8_offset$jscomp$inline_65$$, $eventstr$jscomp$inline_49_i$jscomp$inline_58_offset$jscomp$inline_53$$ = $header$jscomp$3_offset$jscomp$36$$;\n        for ($dataBufferView$jscomp$inline_46_i$jscomp$inline_54_perfDataSize$$ = 0; $dataBufferView$jscomp$inline_46_i$jscomp$inline_54_perfDataSize$$ < $module$contents$output$ragnarokworker_streamingQuality$$.length; $dataBufferView$jscomp$inline_46_i$jscomp$inline_54_perfDataSize$$++) {\n          $dataBufferView$jscomp$inline_52_eventsDataSize_i$jscomp$inline_62_offset$jscomp$inline_57$$.setUint8($eventstr$jscomp$inline_49_i$jscomp$inline_58_offset$jscomp$inline_53$$, $module$contents$output$ragnarokworker_streamingQuality$$[$dataBufferView$jscomp$inline_46_i$jscomp$inline_54_perfDataSize$$].qualityScore), $dataBufferView$jscomp$inline_52_eventsDataSize_i$jscomp$inline_62_offset$jscomp$inline_57$$.setUint8($eventstr$jscomp$inline_49_i$jscomp$inline_58_offset$jscomp$inline_53$$ + \n          1, $module$contents$output$ragnarokworker_streamingQuality$$[$dataBufferView$jscomp$inline_46_i$jscomp$inline_54_perfDataSize$$].bandwidthScore), $dataBufferView$jscomp$inline_52_eventsDataSize_i$jscomp$inline_62_offset$jscomp$inline_57$$.setUint8($eventstr$jscomp$inline_49_i$jscomp$inline_58_offset$jscomp$inline_53$$ + 2, $module$contents$output$ragnarokworker_streamingQuality$$[$dataBufferView$jscomp$inline_46_i$jscomp$inline_54_perfDataSize$$].latencyScore), $dataBufferView$jscomp$inline_52_eventsDataSize_i$jscomp$inline_62_offset$jscomp$inline_57$$.setUint8($eventstr$jscomp$inline_49_i$jscomp$inline_58_offset$jscomp$inline_53$$ + \n          3, $module$contents$output$ragnarokworker_streamingQuality$$[$dataBufferView$jscomp$inline_46_i$jscomp$inline_54_perfDataSize$$].networkLossScore), $dataBufferView$jscomp$inline_52_eventsDataSize_i$jscomp$inline_62_offset$jscomp$inline_57$$.setFloat64($eventstr$jscomp$inline_49_i$jscomp$inline_58_offset$jscomp$inline_53$$ + 4, $module$contents$output$ragnarokworker_streamingQuality$$[$dataBufferView$jscomp$inline_46_i$jscomp$inline_54_perfDataSize$$].timestamp, !0), $eventstr$jscomp$inline_49_i$jscomp$inline_58_offset$jscomp$inline_53$$ += \n          12;\n        }\n        $header$jscomp$3_offset$jscomp$36$$ += $dataBufferView$jscomp$inline_56_offset$jscomp$inline_61_sqEventsDataSize$$;\n      }\n      if ($dataBufferView$jscomp$inline_60_durationDataSize_i$jscomp$inline_66$$) {\n        $module$contents$output$ragnarokworker_writeChunkHeader$$($dataBufferView$jscomp$8_offset$jscomp$inline_65$$, $header$jscomp$3_offset$jscomp$36$$, "MTBD", 1, $module$contents$output$ragnarokworker_mtbDurations$$.length, 10);\n        $header$jscomp$3_offset$jscomp$36$$ += 9;\n        var $dataBufferView$jscomp$inline_56_offset$jscomp$inline_61_sqEventsDataSize$$ = $dataBufferView$jscomp$8_offset$jscomp$inline_65$$;\n        $dataBufferView$jscomp$inline_52_eventsDataSize_i$jscomp$inline_62_offset$jscomp$inline_57$$ = $header$jscomp$3_offset$jscomp$36$$;\n        for ($eventstr$jscomp$inline_49_i$jscomp$inline_58_offset$jscomp$inline_53$$ = 0; $eventstr$jscomp$inline_49_i$jscomp$inline_58_offset$jscomp$inline_53$$ < $module$contents$output$ragnarokworker_mtbDurations$$.length; $eventstr$jscomp$inline_49_i$jscomp$inline_58_offset$jscomp$inline_53$$++) {\n          $dataBufferView$jscomp$inline_56_offset$jscomp$inline_61_sqEventsDataSize$$.setFloat64($dataBufferView$jscomp$inline_52_eventsDataSize_i$jscomp$inline_62_offset$jscomp$inline_57$$, $module$contents$output$ragnarokworker_mtbDurations$$[$eventstr$jscomp$inline_49_i$jscomp$inline_58_offset$jscomp$inline_53$$].timestamp, !0), $dataBufferView$jscomp$inline_56_offset$jscomp$inline_61_sqEventsDataSize$$.setUint16($dataBufferView$jscomp$inline_52_eventsDataSize_i$jscomp$inline_62_offset$jscomp$inline_57$$ + \n          8, Math.min($module$contents$output$ragnarokworker_mtbDurations$$[$eventstr$jscomp$inline_49_i$jscomp$inline_58_offset$jscomp$inline_53$$].duration, 65535), !0), $dataBufferView$jscomp$inline_52_eventsDataSize_i$jscomp$inline_62_offset$jscomp$inline_57$$ += 10;\n        }\n        $header$jscomp$3_offset$jscomp$36$$ += $dataBufferView$jscomp$inline_60_durationDataSize_i$jscomp$inline_66$$;\n      }\n      if ($dataBufferView$jscomp$inline_64_inputChannelDataSize$$) {\n        $module$contents$output$ragnarokworker_writeChunkHeader$$($dataBufferView$jscomp$8_offset$jscomp$inline_65$$, $header$jscomp$3_offset$jscomp$36$$, "INPT", 1, $module$contents$output$ragnarokworker_inputChannelStats$$.length, 12);\n        $header$jscomp$3_offset$jscomp$36$$ += 9;\n        var $dataBufferView$jscomp$inline_60_durationDataSize_i$jscomp$inline_66$$ = $dataBufferView$jscomp$8_offset$jscomp$inline_65$$;\n        $dataBufferView$jscomp$inline_56_offset$jscomp$inline_61_sqEventsDataSize$$ = $header$jscomp$3_offset$jscomp$36$$;\n        for ($dataBufferView$jscomp$inline_52_eventsDataSize_i$jscomp$inline_62_offset$jscomp$inline_57$$ = 0; $dataBufferView$jscomp$inline_52_eventsDataSize_i$jscomp$inline_62_offset$jscomp$inline_57$$ < $module$contents$output$ragnarokworker_inputChannelStats$$.length; $dataBufferView$jscomp$inline_52_eventsDataSize_i$jscomp$inline_62_offset$jscomp$inline_57$$++) {\n          $dataBufferView$jscomp$inline_60_durationDataSize_i$jscomp$inline_66$$.setFloat64($dataBufferView$jscomp$inline_56_offset$jscomp$inline_61_sqEventsDataSize$$, $module$contents$output$ragnarokworker_inputChannelStats$$[$dataBufferView$jscomp$inline_52_eventsDataSize_i$jscomp$inline_62_offset$jscomp$inline_57$$].timestamp, !0), $dataBufferView$jscomp$inline_60_durationDataSize_i$jscomp$inline_66$$.setUint16($dataBufferView$jscomp$inline_56_offset$jscomp$inline_61_sqEventsDataSize$$ + 8, Math.min($module$contents$output$ragnarokworker_inputChannelStats$$[$dataBufferView$jscomp$inline_52_eventsDataSize_i$jscomp$inline_62_offset$jscomp$inline_57$$].bufferedAmount, \n          65535), !0), $dataBufferView$jscomp$inline_60_durationDataSize_i$jscomp$inline_66$$.setUint16($dataBufferView$jscomp$inline_56_offset$jscomp$inline_61_sqEventsDataSize$$ + 10, Math.min($module$contents$output$ragnarokworker_inputChannelStats$$[$dataBufferView$jscomp$inline_52_eventsDataSize_i$jscomp$inline_62_offset$jscomp$inline_57$$].maxSchedulingDelay, 65535), !0), $dataBufferView$jscomp$inline_56_offset$jscomp$inline_61_sqEventsDataSize$$ += 12;\n        }\n        $header$jscomp$3_offset$jscomp$36$$ += $dataBufferView$jscomp$inline_64_inputChannelDataSize$$;\n      }\n      if ($garbageCollectionDataSize$$) {\n        $module$contents$output$ragnarokworker_writeChunkHeader$$($dataBufferView$jscomp$8_offset$jscomp$inline_65$$, $header$jscomp$3_offset$jscomp$36$$, "GRBG", 1, $module$contents$output$ragnarokworker_garbageCollectionStats$$.length, 16);\n        $header$jscomp$3_offset$jscomp$36$$ += 9;\n        var $dataBufferView$jscomp$inline_64_inputChannelDataSize$$ = $dataBufferView$jscomp$8_offset$jscomp$inline_65$$, $dataBufferView$jscomp$8_offset$jscomp$inline_65$$ = $header$jscomp$3_offset$jscomp$36$$;\n        for ($dataBufferView$jscomp$inline_60_durationDataSize_i$jscomp$inline_66$$ = 0; $dataBufferView$jscomp$inline_60_durationDataSize_i$jscomp$inline_66$$ < $module$contents$output$ragnarokworker_garbageCollectionStats$$.length; $dataBufferView$jscomp$inline_60_durationDataSize_i$jscomp$inline_66$$++) {\n          $dataBufferView$jscomp$inline_64_inputChannelDataSize$$.setFloat64($dataBufferView$jscomp$8_offset$jscomp$inline_65$$, $module$contents$output$ragnarokworker_garbageCollectionStats$$[$dataBufferView$jscomp$inline_60_durationDataSize_i$jscomp$inline_66$$].timestamp, !0), $dataBufferView$jscomp$inline_64_inputChannelDataSize$$.setInt32($dataBufferView$jscomp$8_offset$jscomp$inline_65$$ + 8, $module$contents$output$ragnarokworker_asInt32$$($module$contents$output$ragnarokworker_garbageCollectionStats$$[$dataBufferView$jscomp$inline_60_durationDataSize_i$jscomp$inline_66$$].deltaUsedHeapSize), \n          !0), $dataBufferView$jscomp$inline_64_inputChannelDataSize$$.setInt32($dataBufferView$jscomp$8_offset$jscomp$inline_65$$ + 12, $module$contents$output$ragnarokworker_asInt32$$($module$contents$output$ragnarokworker_garbageCollectionStats$$[$dataBufferView$jscomp$inline_60_durationDataSize_i$jscomp$inline_66$$].deltaTotalHeapSize), !0), $dataBufferView$jscomp$8_offset$jscomp$inline_65$$ += 16;\n        }\n        $header$jscomp$3_offset$jscomp$36$$ += $garbageCollectionDataSize$$;\n      }\n      let $buffer$jscomp$17$$ = new Uint8Array($dataBuffer$$);\n      $module$contents$output$ragnarokworker_webrtcBinaryStats$$.write($buffer$jscomp$17$$, $header$jscomp$3_offset$jscomp$36$$);\n      null === $module$contents$output$ragnarokworker_webSocket$$ || void 0 === $module$contents$output$ragnarokworker_webSocket$$ ? void 0 : $module$contents$output$ragnarokworker_webSocket$$.send({stats:$dataBuffer$$, ackid:$module$contents$output$ragnarokworker_serverSupportsAck$$ ? $module$contents$output$ragnarokworker_nextAckIdToSendForStats$$ : void 0});\n    } catch ($err$jscomp$3$$) {\n      $module$contents$output$ragnarokworker_workerException$$("Exception in perf/stats upload. Error : " + $err$jscomp$3$$.message + " stack: " + $err$jscomp$3$$.stack);\n    }\n  }\n  $module$contents$output$ragnarokworker_clearCachedData$$();\n}\nfunction $module$contents$output$ragnarokworker_wsMessageHandler$$($data$jscomp$83$$) {\n  $module$contents$output$ragnarokworker_serverSupportsAck$$ || void 0 === $data$jscomp$83$$.ackid || ($module$contents$output$ragnarokworker_serverSupportsAck$$ = !0);\n  $module$contents$output$ragnarokworker_ctx$$.postMessage({wsMessage:$data$jscomp$83$$});\n}\nfunction $module$contents$output$ragnarokworker_wsCloseHandler$$($data$jscomp$84$$) {\n  $module$contents$output$ragnarokworker_ctx$$.postMessage({wsClose:$data$jscomp$84$$});\n}\nfunction $module$contents$output$ragnarokworker_wsOpenHandler$$() {\n  $module$contents$output$ragnarokworker_ctx$$.postMessage({wsOpen:!0});\n}\nfunction $module$contents$output$ragnarokworker_wsOpeningHandler$$() {\n  $module$contents$output$ragnarokworker_ctx$$.postMessage({wsOpening:!0});\n}\nfunction $module$contents$output$ragnarokworker_createWebSocket$$($maxReceivedAckId$jscomp$1$$, $reconnect$jscomp$2$$) {\n  $module$contents$output$ragnarokworker_webSocket$$ = new $module$exports$output$websocketimpl$WebSocketImpl$$();\n  $module$contents$output$ragnarokworker_webSocket$$.initialize($module$contents$output$ragnarokworker_url$$, $maxReceivedAckId$jscomp$1$$, $module$contents$output$ragnarokworker_serverSupportsAck$$, $reconnect$jscomp$2$$);\n  $module$contents$output$ragnarokworker_wsOpeningHandler$$();\n}\n$module$contents$output$ragnarokworker_ctx$$.onmessage = function($message$jscomp$34$$) {\n  try {\n    const $data$jscomp$85$$ = $message$jscomp$34$$.data;\n    $data$jscomp$85$$.initMessage ? ($module$contents$output$ragnarokworker_sessionId$$ = $data$jscomp$85$$.initMessage.sessionId, $module$contents$output$ragnarokworker_workerLogger$$("{6ccab8d}")) : $data$jscomp$85$$.perf ? $module$contents$output$ragnarokworker_perfs$$.push($data$jscomp$85$$.perf) : $data$jscomp$85$$.clientEvent ? $module$contents$output$ragnarokworker_clientEvents$$.push($data$jscomp$85$$.clientEvent) : $data$jscomp$85$$.startStats ? ($module$contents$output$ragnarokworker_statsHeaderObj$$ = \n    $data$jscomp$85$$.startStats.statsHeader, $module$contents$output$ragnarokworker_uploadIntervalId$$ = self.setInterval(() => $module$contents$output$ragnarokworker_uploadData$$(), 5000), $module$contents$output$ragnarokworker_ctx$$.postMessage({statsStarted:!0}), $module$contents$output$ragnarokworker_workerLogger$$("{5209d98}")) : $data$jscomp$85$$.stopStats ? (self.clearInterval($module$contents$output$ragnarokworker_uploadIntervalId$$), $module$contents$output$ragnarokworker_uploadData$$(), \n    $module$contents$output$ragnarokworker_clearCachedData$$(), $module$contents$output$ragnarokworker_workerLogger$$("{b58b6ad}")) : $data$jscomp$85$$.webrtcStats ? ($data$jscomp$85$$.ackid && ($module$contents$output$ragnarokworker_nextAckIdToSendForStats$$ = $data$jscomp$85$$.ackid), $data$jscomp$85$$.webrtcStats.stats && $JSCompiler_StaticMethods_addReport$$($data$jscomp$85$$.webrtcStats)) : $data$jscomp$85$$.sq ? $module$contents$output$ragnarokworker_streamingQuality$$.push($data$jscomp$85$$.sq) : \n    $data$jscomp$85$$.startWebSocket ? ($module$contents$output$ragnarokworker_url$$ = $data$jscomp$85$$.startWebSocket.signInURL, $module$contents$output$ragnarokworker_serverSupportsAck$$ = $data$jscomp$85$$.startWebSocket.serverSupportsAck, $module$contents$output$ragnarokworker_createWebSocket$$($data$jscomp$85$$.startWebSocket.maxReceivedAckId, $data$jscomp$85$$.startWebSocket.reconnect)) : $data$jscomp$85$$.stopWebSocket ? (null === $module$contents$output$ragnarokworker_webSocket$$ || void 0 === \n    $module$contents$output$ragnarokworker_webSocket$$ ? void 0 : $module$contents$output$ragnarokworker_webSocket$$.uninitialize(), $module$contents$output$ragnarokworker_serverSupportsAck$$ = !1) : $data$jscomp$85$$.send ? null === $module$contents$output$ragnarokworker_webSocket$$ || void 0 === $module$contents$output$ragnarokworker_webSocket$$ ? void 0 : $module$contents$output$ragnarokworker_webSocket$$.send($data$jscomp$85$$.send) : $data$jscomp$85$$.duration ? $module$contents$output$ragnarokworker_mtbDurations$$.push($data$jscomp$85$$.duration) : \n    $data$jscomp$85$$.inputChannelStats ? $module$contents$output$ragnarokworker_inputChannelStats$$.push($data$jscomp$85$$.inputChannelStats) : $data$jscomp$85$$.garbageCollectionStats && $module$contents$output$ragnarokworker_garbageCollectionStats$$.push($data$jscomp$85$$.garbageCollectionStats);\n  } catch ($exp$jscomp$1$$) {\n    $module$contents$output$ragnarokworker_workerException$$("Worker onmessage exception: " + $exp$jscomp$1$$);\n  }\n};\n\n\n\n'],{type:"text/javascript"}));this.$g$=new Worker(e),URL.revokeObjectURL(e),this.$g$.onmessage=this.$v$.bind(this),this.$g$.onerror=this.$u$.bind(this),d.i("{1f5ec29}","{62dee75}")}catch(e){d.e("{1f5ec29}","{50fa2e5}",e.message),this.$l$.push({name:"RagnarokWorkerProblem",error:JSON.stringify(e)})}}startWebSocket(e,t,i,n,s){this.$wsHandler$=n,e={startWebSocket:{signInURL:e,maxReceivedAckId:t,serverSupportsAck:i,reconnect:s}},this.$g$&&(this.$g$.postMessage(e),d.d("{1f5ec29}","{b3f6faa}"))}stopWebSocket(){this.$g$&&(d.d("{1f5ec29}","{7ac815d}"),this.$g$.postMessage({stopWebSocket:!0})),this.$wsHandler$=null}initialize(e,t,i){if(this.$o$=t,this.$s$=i,0<this.$l$.length){for(const e of this.$l$)t.$emitDebugEvent$(e.name,e.error);this.$l$=[]}if(0<this.$m$.length){for(const e of this.$m$)ht(this,e);this.$m$=[]}this.$h$=!1,pt(this),0===this.$j$&&(this.$j$=performance.now()),this.$g$?(this.$g$.postMessage({initMessage:{sessionId:e}}),d.d("{1f5ec29}","{404f264}")):d.e("{1f5ec29}","{c62bf29}")}$v$(e){(e=e.data).statsStarted?(this.$h$=!0,d.d("{1f5ec29}","{0f8a41a}")):e.log?d.i("{cbf9f59}","{0b0c6f9}",e.log):e.exception?d.i("{cbf9f59}","{0b0c6f9}",e.exception):e.wsClose?this.$wsHandler$?fs(this.$wsHandler$,e.wsClose):d.e("{1f5ec29}","{900a6f2}"):e.wsMessage?this.$wsHandler$?gs(this.$wsHandler$,e.wsMessage):d.e("{1f5ec29}","{900a6f2}"):e.wsOpening?this.$wsHandler$?d.i("{93c7910}","{6423101}"):d.e("{1f5ec29}","{900a6f2}"):e.wsOpen&&(this.$wsHandler$?vs(this.$wsHandler$):d.e("{1f5ec29}","{900a6f2}"))}$u$(e){this.$o$?ht(this,e):this.$m$.push(e)}};function At(e,t,i){var n,s,o,r;const a=4953600<=e*t;var $=30===i?1.25*i:Math.min(i,60);let c=e*t*$;return Tt(e,t)||a?(e=null!==(s=null!==(n=ut.bitsPerPixel1440p)&&void 0!==n?n:ut.$ragnarokConfig$.bitsPerPixel1440p)&&void 0!==s?s:.325,$=(n=2073600*$)+(3686400*$-n)/3,c=a?$+(c-$)/12:n+(c-n)/3):e=null!==(r=null!==(o=ut.bitsPerPixel)&&void 0!==o?o:ut.$ragnarokConfig$.bitsPerPixel)&&void 0!==r?r:.3,c=c*e/1200,120<=i&&!a&&(c=Math.min(5e4,Math.round(1.15*c))),Math.round(c)}function bt(e){return e[0]<e[1]?[e[1],e[0]]:e}function wt(e,t,i){var n=screen.width,s=screen.height,o=!!(1&i);const r=!!(2&i);var a=!!(4&i);if((a||8&i)&&(n=3840,s=2160),t&&0<t.length){[n,s]=bt([n,s]),r&&1366<=n&&0===e&&(n=1600,s=1200);const i=n/s,o=n*s;return(n=t.filter((e=>120>e.frameRate))).length&&(t=n),t.sort(((t,n)=>{var s=t.resolution,r=n.resolution,a=Math.abs(s.width/s.height-i)-Math.abs(r.width/r.height-i);if(.05<Math.abs(a))return a;a=0===e?-1:1;const $=(1===e?1:-1)*(t.frameRate-n.frameRate),c=(s=s.width*s.height)-(r=r.width*r.height);return s<=o?r<=o?t.frameRate!==n.frameRate?$:a*c:-1:r<=o?1:c||$})),t[0]}if(t={resolution:{width:1280,height:720},frameRate:60},o){let[e,i]=bt([n,s]);2<e/i&&(t.resolution={width:1376,height:640})}else r?0!=e?t.resolution={width:1024,height:768}:([n]=bt([n,s]),t.resolution=1024>=n?{width:1024,height:768}:1366>n?{width:1112,height:834}:{width:1600,height:1200}):(o=[[1920,1200],[1920,1080],[1280,1024],[1600,1200]],a&&o.unshift([3840,2160]),a=[[1280,800],[1280,720],[1280,1024],[1024,768]],n=function(e,t){if(0==t.length)return e;class i{constructor(e,t){this.w=e,this.$g$=t,this.a=e/t}$j$(e){return.05>Math.abs(e.a-this.a)?e:e.a>this.a?new i(Math.floor(this.a/e.a*e.w),e.$g$):new i(e.w,Math.floor(e.a/this.a*e.$g$))}$h$(){return[this.w,this.$g$]}}t=t.map((e=>new i(e[0],e[1])));const n=new i(e[0],e[1]);e=t[0];for(let i=1;i<t.length;i++){let s=t[i];Math.abs(n.a-s.a)<Math.abs(n.a-e.a)&&(e=s)}return(t=e.$j$(n)).w>e.w?e.$h$():t.$h$()}(n=[n,s],0==e?o:a),t.resolution={width:n[0],height:n[1]});return t}function St(e){var t;let i=0;return k(e)&&(i|=1),(e?"iPadOS"===e.os:/^(?!.*chrome).*safari/i.test(navigator.userAgent)&&!k()&&R())&&(i|=2),null!==(t=window.webapis)&&void 0!==t&&t.productinfo&&window.webapis.productinfo.isUdPanelSupported()&&(i|=4),window.lge_webrtc_hevc_support&&(i|=8),i}function yt(){return getComputedStyle(document.documentElement)?(getComputedStyle(document.documentElement).getPropertyValue("--sat")||(document.documentElement.style.setProperty("--sat","env(safe-area-inset-top)"),document.documentElement.style.setProperty("--sar","env(safe-area-inset-right)"),document.documentElement.style.setProperty("--sab","env(safe-area-inset-bottom)"),document.documentElement.style.setProperty("--sal","env(safe-area-inset-left)")),{top:parseInt(getComputedStyle(document.documentElement).getPropertyValue("--sat")),left:parseInt(getComputedStyle(document.documentElement).getPropertyValue("--sal")),bottom:parseInt(getComputedStyle(document.documentElement).getPropertyValue("--sab")),right:parseInt(getComputedStyle(document.documentElement).getPropertyValue("--sar"))}):{top:0,left:0,bottom:0,right:0}}function kt(e,t){return 0>e?0:e>t?t:e}function Ct(e){var t=yt();t.top=Math.max(t.top,21),t.bottom=kt(t.bottom,10);let i={x:e.clientX,y:e.clientY},n=.5;return 0<t.top&&e.clientY-e.radiusY<t.top?n-=.5*(t=kt(t=(t.top-(e.clientY-Math.min(e.radiusY,21)))/e.radiusY,1))*t:0<t.bottom&&e.clientY+e.radiusY>window.innerHeight-t.bottom&&(n+=.5*(t=kt(t=(e.clientY+Math.min(e.radiusY,10)-(window.innerHeight-t.bottom))/e.radiusY,1))*t),i.y=kt(i.y-e.radiusY+2*n*e.radiusY,window.innerHeight),i}function _t(e,t){let i=e;if(ut.$ragnarokConfig$.sleepErrorsStreaming&&ut.$ragnarokConfig$.sleepErrorsStreaming.includes(y(e)))i=15867908;else if(ut.$ragnarokConfig$.sleepErrorsSessionSetup&&ut.$ragnarokConfig$.sleepErrorsSessionSetup.includes(y(e)))i=15867909;else switch(e){case 3237093906:w(t)&&(i=15867908);break;case 3237094159:i=15867908;break;case 3237093654:i=15867909}return i!==e&&d.i("{d988e7f}","{49e2182}",y(e),y(i)),i}function Et(e,t,i,n,s=1){const o=4294967295&Math.floor(e*s);e=Math.floor(e/4294967296*s),n?(t.setUint32(i,o,!0),t.setUint32(i+4,e,!0)):(t.setUint32(i,e,!1),t.setUint32(i+4,o,!1))}function Tt(e,t){return 2764800<=(e*=t)&&4953600>e}function It(e){let t="UNKNOWN";return e&&((e=e.toUpperCase()).includes("H264")?t="H264":e.includes("H265")&&(t="HEVC")),t}function Pt(e){var t;return e=_(e)||E(e)||T(e)||"Linux"===e.os||w(e),null!==(t=ut.$ragnarokConfig$.enableCpm)&&void 0!==t?t:e}function jt(e){return void 0!==e?e?"TRUE":"FALSE":"UNDEFINED"}let Rt=[];function Dt(e){return`${e.width.toFixed()}x${e.height.toFixed()}`}function xt(e,t,i){try{const n=document.createElement("a");n.style.display="none";const s=URL.createObjectURL(new Blob(e,{type:i}));return n.href=s,n.download=t,document.body.appendChild(n),n.click(),URL.revokeObjectURL(s),document.body.removeChild(n),!0}catch(e){return d.e("{d988e7f}","{8d57ba9}",e),!1}}function Mt(e){const t=window.AudioContext||window.webkitAudioContext||void 0;if(t)return e?new t({$sampeleRate$:e}):new t;d.w("{d988e7f}","{b74c037}")}async function Lt(e,t,i){var n;const s=new RTCPeerConnection;try{await s.setRemoteDescription({type:"offer",sdp:t}).catch((e=>{throw Error("Audio munging setRemoteDescription failed. "+e)}));const o=await s.createAnswer();await s.setLocalDescription({type:"answer",sdp:null===(n=o.sdp)||void 0===n?void 0:n.replace("opus/48000/2","multiopus/48000/"+e).replace("useinbandfec=1",i)}).catch((e=>{throw Error("Audio munging setLocalDescription failed. "+e)}));const r=s.getReceivers()[0];if(!r.getParameters)return d.w("{d988e7f}","{4be0bf6}"),2;const{codecs:a}=r.getParameters();if(1!==a.length||"audio/multiopus"!==a[0].mimeType||a[0].channels!==e)throw Error("Audio munging failed "+a[0]);return d.i("{d988e7f}","{8919816}",e,a[0]),e}catch(t){return d.e("{d988e7f}","{4984c00}",e,t),2}finally{s.close()}}async function Ot(){let e=2;var t="minptime=10;useinbandfec=1;channel_mapping=0,4,1,2,3,5;num_streams=4;coupled_streams=2";const i=Lt(6,"v=0\no=- 0 3 IN IP4 127.0.0.1\ns=-\nt=0 0\na=fingerprint:sha-256 A7:24:72:CA:6E:02:55:39:BA:66:DF:6E:CC:4C:D8:B0:1A:BF:1A:56:65:7D:F4:03:AD:7E:77:43:2A:29:EC:93\nm=audio 9 UDP/TLS/RTP/SAVPF 100 101\nc=IN IP4 0.0.0.0\na=rtcp-mux\na=sendonly\na=mid:audio\na=setup:actpass\na=ice-ufrag:ETEn\na=ice-pwd:OtSK0WpNtpUjkY4+86js7Z/l\r\na=rtpmap:100 multiopus/48000/6\r\na=fmtp:100 "+t+"\r\na=rtpmap:101 opus/48000/2\na=fmtp:101 minptime=10;useinbandfec=1\n",t);return t=Lt(8,"v=0\no=- 0 3 IN IP4 127.0.0.1\ns=-\nt=0 0\na=fingerprint:sha-256 A7:24:72:CA:6E:02:55:39:BA:66:DF:6E:CC:4C:D8:B0:1A:BF:1A:56:65:7D:F4:03:AD:7E:77:43:2A:29:EC:93\nm=audio 9 UDP/TLS/RTP/SAVPF 100 101\nc=IN IP4 0.0.0.0\na=rtcp-mux\na=sendonly\na=mid:audio\na=setup:actpass\na=ice-ufrag:ETEn\na=ice-pwd:OtSK0WpNtpUjkY4+86js7Z/l\r\na=rtpmap:100 multiopus/48000/8\r\na=fmtp:100 "+(t="minptime=10;useinbandfec=1;channel_mapping=0,6,1,2,3,4,5,7;num_streams=5;coupled_streams=3")+"\r\na=rtpmap:101 opus/48000/2\na=fmtp:101 minptime=10;useinbandfec=1\n",t),await Promise.all([i,t]).then((t=>{e=Math.max(Number(t[0]),Number(t[1]))})),d.i("{d988e7f}","{dc7ee29}",e),e}function Bt(e){var t;return(null!==(t=ut.$ragnarokConfig$.usePerfNowCaptureTimestamp)&&void 0!==t?t:!window.chrome)?ft(vt):e-vt.$j$}function Nt(e,t=!1){return t=t?Ct(e):{x:e.clientX,y:e.clientY},{identifier:e.identifier,clientX:t.x,clientY:t.y,deltaX:0,deltaY:0}}function Ft(e,t,i){let n=!1;const s=t.changedTouches,o=Bt(t.timeStamp);for(let t=0;t<s.length;t++){const r=s[t],a=e.$h$.findIndex((e=>e.identifier==r.identifier));-1!=a&&(n=!0,ct($t()),e.$h$.splice(a,1),0===e.$h$.length?(0!==e.$l$?(window.clearTimeout(e.$l$),e.$l$=0,i&&Mi(e.$j$,e.target,o,Nt(r,!0),e.$m$)):(2===e.$g$||4===e.$g$)&&ut.$advancedGestures$&&ji(e.$j$,o),e.$m$=0,e.$g$=0):5===e.$g$?e.$g$=0:6===e.$g$&&(ut.$advancedGestures$&&Ri(e.$j$),e.$g$=0))}Di(e.$j$)&&n&&t.preventDefault()}function Vt(e){const t=Ct(e);e.$h$=.01<Math.abs(t.y-e.clientY),e.clientX=t.x,e.clientY=t.y}class Ut{constructor(e,t){this.radiusY=this.radiusX=this.clientY=this.clientX=0,this.$h$=!1,this.identifier=e.identifier,this.$g$=t,this.clientX=e.pageX,this.clientY=e.pageY,this.radiusX=e.radiusX,this.radiusY=e.radiusY,ut.$touchWarp$?Vt(this):this.$h$=!1}update(e){this.clientX=e.pageX,this.clientY=e.pageY,this.radiusX=e.radiusX,this.radiusY=e.radiusY,this.$h$&&Vt(this)}}class Gt{constructor(e,t,i,n,s){this.$h$=t,this.id=e.identifier,this.$u$=i,this.$l$=e.pageX,this.$m$=e.pageY,this.$o$=e.radiusX,this.$s$=e.radiusY,this.$g$=n,this.$j$=s}}function Ht(e,t,i,n){var s,o=0;for(let m of t){if(40<o)return void d.e("{ec05004}","{2faaf33}",t.length-o);var r=null===(s=e.$g$.get(m.identifier))||void 0===s?void 0:s.$g$;if(void 0===r)d.e("{ec05004}","{960ee4f}",m.identifier);else{if(c=e.$l$*(m.clientX-e.$u$.$horizontal$),l=e.$m$*(m.clientY-e.$u$.vertical),$=65535+(a=e.$l$*m.radiusX),u=-(h=e.$m$*m.radiusY),h=65535+h,c<-a||c>$||l<u||l>h)switch(i){case 2:case 8:break;default:continue}c=Math.min(Math.max(c,0),65535),l=Math.min(Math.max(l,0),65535);e:{var a=e.$I$,$=i,c=c,l=l,u=m.radiusX,h=m.radiusY,p=n;if(40<=o){r=!1;break e}const t=18+16*o;a.$j$.setUint8(t,r),a.$j$.setUint8(t+1,$),a.$j$.setUint16(t+2,c,!1),a.$j$.setUint16(t+4,l,!1),a.$j$.setUint8(t+6,u),a.$j$.setUint8(t+7,h),Et(p,a.$j$,t+8,!1,1e3),r=!0}if(!r){e.$j$+=t.length-o;break}o++}}0!=o&&(o>t.length?d.w("{ec05004}","{4e60a66}",o,t.length):(o=8+16*(t=o),(e=e.$I$).$j$.setUint16(14,o,!1),e.$j$.setUint16(16,t,!1),t=10,3<=e.$h$&&(o++,t--),o=new DataView(e.$j$.buffer,t,o),Yt(e),Yt(e,o)||d.e("{ec05004}","{56a8404}")))}function zt(e,t,i){var n=performance.now(),s=Bt(t.timeStamp);let o=!1,r=[];const a=t.changedTouches;let $=[];for(let s=0;s<a.length;s++){const c=a[s];if(c.target===e.target){let s=e.$g$.get(c.identifier);r.push(c.identifier),s&&(o=!0,ct($t()),s.update(c),$.push(s),e.$storeTouch$(c,s,i,n,t))}}Ht(e,$,i,s);for(const t of r)n=t,(s=(i=e).$g$.get(n))&&(i.$g$.delete(n),i.$o$.delete(s.$g$));ut.$storeTouch$&&(e.$G$=0==e.$g$.size),Di(e.$s$)&&o&&t.preventDefault()}var Wt=new Map([["Escape",27],["Digit0",48],["Digit1",49],["Digit2",50],["Digit3",51],["Digit4",52],["Digit5",53],["Digit6",54],["Digit7",55],["Digit8",56],["Digit9",57],["Minus",189],["Equal",187],["Backspace",8],["Tab",9],["KeyQ",81],["KeyW",87],["KeyE",69],["KeyR",82],["KeyT",84],["KeyY",89],["KeyU",85],["KeyI",73],["KeyO",79],["KeyP",80],["BracketLeft",219],["BracketRight",221],["Enter",13],["ControlLeft",162],["KeyA",65],["KeyS",83],["KeyD",68],["KeyF",70],["KeyG",71],["KeyH",72],["KeyJ",74],["KeyK",75],["KeyL",76],["Semicolon",186],["Quote",222],["Backquote",192],["ShiftLeft",160],["Backslash",220],["KeyZ",90],["KeyX",88],["KeyC",67],["KeyV",86],["KeyB",66],["KeyN",78],["KeyM",77],["Comma",188],["Period",190],["Slash",191],["ShiftRight",161],["NumpadMultiply",106],["AltLeft",164],["Space",32],["CapsLock",20],["F1",112],["F2",113],["F3",114],["F4",115],["F5",116],["F6",117],["F7",118],["F8",119],["F9",120],["F10",121],["Pause",19],["ScrollLock",145],["Numpad7",103],["Numpad8",104],["Numpad9",105],["NumpadSubtract",109],["Numpad4",100],["Numpad5",101],["Numpad6",102],["NumpadAdd",107],["Numpad1",97],["Numpad2",98],["Numpad3",99],["Numpad0",96],["NumpadDecimal",110],["PrintScreen",42],["IntlBackslash",226],["F11",122],["F12",123],["NumpadEqual",187],["F13",124],["F14",125],["F15",126],["F16",127],["F17",128],["F18",129],["F19",130],["F20",131],["F21",132],["F22",133],["F23",134],["F24",135],["KanaMode",233],["Lang2",25],["Lang1",21],["IntlRo",194],["Convert",234],["NonConvert",235],["IntlYen",193],["NumpadComma",188],["NumpadEnter",13],["ControlRight",163],["NumpadDivide",111],["PrintScreen",42],["AltRight",165],["NumLock",144],["Pause",19],["Home",36],["ArrowUp",38],["PageUp",33],["ArrowLeft",37],["ArrowRight",39],["End",35],["ArrowDown",40],["PageDown",34],["Insert",45],["Delete",46],["MetaLeft",91],["OSLeft",91],["MetaRight",92],["OSRight",92],["Lang2",25],["Lang1",21],["NumpadClear",12],["NumpadClearEntry",12]]),Kt=new Map([["HanjaMode",25],["HangulMode",21]]),Jt=new Map([["1",{vkCode:49,shift:!1}],["2",{vkCode:50,shift:!1}],["3",{vkCode:51,shift:!1}],["4",{vkCode:52,shift:!1}],["5",{vkCode:53,shift:!1}],["6",{vkCode:54,shift:!1}],["7",{vkCode:55,shift:!1}],["8",{vkCode:56,shift:!1}],["9",{vkCode:57,shift:!1}],["0",{vkCode:48,shift:!1}],["!",{vkCode:49,shift:!0}],["@",{vkCode:50,shift:!0}],["#",{vkCode:51,shift:!0}],["$",{vkCode:52,shift:!0}],["%",{vkCode:53,shift:!0}],["^",{vkCode:54,shift:!0}],["&",{vkCode:55,shift:!0}],["*",{vkCode:56,shift:!0}],["(",{vkCode:57,shift:!0}],[")",{vkCode:48,shift:!0}],["-",{vkCode:189,shift:!1}],["_",{vkCode:189,shift:!0}],["=",{vkCode:187,shift:!1}],["+",{vkCode:187,shift:!0}],[",",{vkCode:188,shift:!1}],["<",{vkCode:188,shift:!0}],[".",{vkCode:190,shift:!1}],[">",{vkCode:190,shift:!0}],[";",{vkCode:186,shift:!1}],[":",{vkCode:186,shift:!0}],["/",{vkCode:191,shift:!1}],["?",{vkCode:191,shift:!0}],["`",{vkCode:192,shift:!1}],["~",{vkCode:192,shift:!0}],["[",{vkCode:219,shift:!1}],["{",{vkCode:219,shift:!0}],["\\",{vkCode:220,shift:!1}],["|",{vkCode:220,shift:!0}],["]",{vkCode:221,shift:!1}],["}",{vkCode:221,shift:!0}],["'",{vkCode:222,shift:!1}],['"',{vkCode:222,shift:!0}],[" ",{vkCode:32,shift:!1}],["A",{vkCode:65,shift:!0}],["B",{vkCode:66,shift:!0}],["C",{vkCode:67,shift:!0}],["D",{vkCode:68,shift:!0}],["E",{vkCode:69,shift:!0}],["F",{vkCode:70,shift:!0}],["G",{vkCode:71,shift:!0}],["H",{vkCode:72,shift:!0}],["I",{vkCode:73,shift:!0}],["J",{vkCode:74,shift:!0}],["K",{vkCode:75,shift:!0}],["L",{vkCode:76,shift:!0}],["M",{vkCode:77,shift:!0}],["N",{vkCode:78,shift:!0}],["O",{vkCode:79,shift:!0}],["P",{vkCode:80,shift:!0}],["Q",{vkCode:81,shift:!0}],["R",{vkCode:82,shift:!0}],["S",{vkCode:83,shift:!0}],["T",{vkCode:84,shift:!0}],["U",{vkCode:85,shift:!0}],["V",{vkCode:86,shift:!0}],["W",{vkCode:87,shift:!0}],["X",{vkCode:88,shift:!0}],["Y",{vkCode:89,shift:!0}],["Z",{vkCode:90,shift:!0}],["a",{vkCode:65,shift:!1}],["b",{vkCode:66,shift:!1}],["c",{vkCode:67,shift:!1}],["d",{vkCode:68,shift:!1}],["e",{vkCode:69,shift:!1}],["f",{vkCode:70,shift:!1}],["g",{vkCode:71,shift:!1}],["h",{vkCode:72,shift:!1}],["i",{vkCode:73,shift:!1}],["j",{vkCode:74,shift:!1}],["k",{vkCode:75,shift:!1}],["l",{vkCode:76,shift:!1}],["m",{vkCode:77,shift:!1}],["n",{vkCode:78,shift:!1}],["o",{vkCode:79,shift:!1}],["p",{vkCode:80,shift:!1}],["q",{vkCode:81,shift:!1}],["r",{vkCode:82,shift:!1}],["s",{vkCode:83,shift:!1}],["t",{vkCode:84,shift:!1}],["u",{vkCode:85,shift:!1}],["v",{vkCode:86,shift:!1}],["w",{vkCode:87,shift:!1}],["x",{vkCode:88,shift:!1}],["y",{vkCode:89,shift:!1}],["z",{vkCode:90,shift:!1}]]);class qt extends DataView{constructor(e,t,i,n){super(e,t,i),this.shift=0,this.setUint8=(e,t)=>super.setUint8(e+this.shift,t),this.setUint16=(e,t,i)=>super.setUint16(e+this.shift,t,i),this.setUint32=(e,t,i)=>super.setUint32(e+this.shift,t,i),this.setInt8=(e,t)=>super.setInt8(e+this.shift,t),this.setInt16=(e,t,i)=>super.setInt16(e+this.shift,t,i),this.setInt32=(e,t,i)=>super.setInt32(e+this.shift,t,i),this.setFloat32=(e,t,i)=>super.setFloat32(e+this.shift,t,i),this.setFloat64=(e,t,i)=>super.setFloat64(e+this.shift,t,i),this.shift=null!=n?n:0}}function Yt(e,t,i=!0){if(0<e.$g$.$h$&&(t=e.$H$(t)),void 0===t)return!1;const n=window.performance.now();var s=e.$I$;if(s.$R$?(zi(s),s=!1):s=!0,!s)return!1;s=!1,2<e.$h$&&i&&(9>t.byteOffset?d.w("{57a6a4d}","{0fc6121}"):((t=new DataView(t.buffer,t.byteOffset-9,9+t.byteLength)).setUint8(0,35),Et(ft(vt),t,1,!1,1e3)));try{let i=performance.now();e.$A$.send(t),As(e.$J$,performance.now()-i);const o=window.performance.now();e.$o$.$sendInputCount$+=1,5<(t=o-n)&&(e.$o$.$sendInputOver5ms$+=1),10<t&&(e.$o$.$sendInputOver10ms$+=1),s=!0}catch(t){t.stack&&!t.stack.includes("Could not send data")&&(d.e("{57a6a4d}","{7a6bf7c}",t),Zt(e)&&e.$v$.$g$(t,"sendinput exception","{57a6a4d}.ts",0,0,!0))}return s}function Xt(e,t,i){const n=e.$l$(22);n.setUint32(0,10,!0),n.setUint16(4,0,!1),n.setUint16(6,-t,!1),n.setUint16(8,0,!1),n.setUint32(10,0),Et(i,n,14,!1,1e3);try{Yt(e,n)}catch(t){d.e("{57a6a4d}","{3d81a57}",t),e.$v$.$g$(t,"send mousewheel exception","{57a6a4d}.ts",0,0,!0)}}function Qt(e,t,i,n,s,o,r=0){let a=e.$G$.$displayVideoWidth$;e=e.$G$.$displayVideoHeight$;let $=7;n&&($=5);let c=0;return 5==$&&(c=4),t.setUint32(i,$,!0),t.setUint16(i+4,s,!1),t.setUint16(i+6,o,!1),t.setUint16(i+8,0,!1),t.setUint32(i+10+c,0,!1),Et(r,t,i+14+c,!1,1e3),c&&(t.setUint16(i+10,a,!1),t.setUint16(i+12,e,!1)),i+(n?26:22)}function Zt(e){return"open"===e.$A$.readyState}function ei(e,t,i,n=0){const s=e.$l$(26);Qt(e,s,0,!0,t,i,n);try{Zt(e)&&Yt(e,s)}catch(t){d.e("{57a6a4d}","{dba1265}",t),e.$v$.$g$(t,"send CursorPos exception","{57a6a4d}.ts",0,0,!0)}}function ti(e,t,i,n,s=0){if(4!==t&&3!==t)d.e("{57a6a4d}","{66e269d}",t);else{var o=e.$l$(18);o.setUint32(0,t,!0),o.setUint16(4,i,!1),o.setUint16(6,n,!1),o.setUint16(8,0,!1),Et(s,o,10,!1,1e3),Yt(e,o)}}function ii(e,t,i,n,s,o,r=0,a=0){e.setUint32(t,12,!0),e.setInt16(t+4,26,!0),e.setInt16(t+6,i,!0),e.setInt16(t+8,a,!0),e.setInt16(t+10,20,!0),e.setInt16(t+12,n,!0),e.setInt16(t+14,s,!0),e.setInt16(t+16,Math.round(32767.5*(o[0]+1))-32768,!0),e.setInt16(t+18,Math.round(32767.5*(1-o[1]))-32768,!0),e.setInt16(t+20,Math.round(32767.5*(o[2]+1))-32768,!0),e.setInt16(t+22,Math.round(32767.5*(1-o[3]))-32768,!0),e.setInt16(t+24,0,!0),e.setInt16(t+26,85,!0),e.setInt16(t+28,0,!0),Et(r,e,t+30,!0,1e3)}function ni(e,t,i,n,s,o=0,r=0){return ii(e=e.$l$(38),0,n,t,i,s,o,r),e}function si(e,t,i){t=new MouseEvent(i?e.$downName$:e.$upName$,{button:t,buttons:(e.$button1$?1:0)|(e.$button2$?2:0)}),e.$eventElement$.dispatchEvent(t)}var oi=class{constructor(e,t){this.$rsdmmTimer$=0,this.$rsdmmPollInterval$=8,this.$accumulatedV$=this.$accumulatedH$=this.$prevV$=this.$prevH$=0,this.$button2$=this.$button1$=!1,this.scale=12,this.$moveName$="mousemove",this.$downName$="mousedown",this.$upName$="mouseup",this.$rtThreshold$=58752,this.$ltThreshold$=229.5,this.$stickIndexX$=2,this.$stickIndexY$=3,this.$platformDetails$=t,this.$eventElement$=e,this.$rsdmmTickFunc$=this.$rsdmmTick$.bind(this),b(this.$platformDetails$)&&(this.$stickIndexX$=0,this.$stickIndexY$=1)}$gamepadStateUpdateHandler$(e,t,i,n,s){(e=[])[0]=-.1<s[0]&&.1>s[0]?0:s[0],e[1]=-.1<s[1]&&.1>s[1]?0:s[1],e[2]=-.1<s[2]&&.1>s[2]?0:s[2],e[3]=-.1<s[3]&&.1>s[3]?0:s[3],s=e[this.$stickIndexX$],e=e[this.$stickIndexY$],t=4-3*Math.min(1,Math.sqrt(s*s+e*e)),this.$prevH$=s*this.scale/t,this.$prevV$=e*this.scale/t,i=!!(4224&i)||(65280&n)>this.$rtThreshold$,n=(255&n)>this.$ltThreshold$,s=this.$button1$,e=this.$button2$,this.$button1$=i,this.$button2$=n,!i&&s&&si(this,0,!1),!n&&e&&si(this,2,!1),i&&!s&&si(this,0,!0),n&&!e&&si(this,2,!0)}$rsdmmTick$(){this.$accumulatedH$=Math.sign(this.$accumulatedH$)!=Math.sign(this.$prevH$)?this.$prevH$:this.$accumulatedH$+this.$prevH$,this.$accumulatedV$=Math.sign(this.$accumulatedV$)!=Math.sign(this.$prevV$)?this.$prevV$:this.$accumulatedV$+this.$prevV$;var e=0;let t=0;if((1<=this.$accumulatedH$||-1>=this.$accumulatedH$)&&(e=Math.trunc(this.$accumulatedH$),this.$accumulatedH$-=e),(1<=this.$accumulatedV$||-1>=this.$accumulatedV$)&&(t=Math.trunc(this.$accumulatedV$),this.$accumulatedV$-=t),0!=e||0!=t){let i;e={movementX:e,movementY:t,isPrimary:!0},i="pointerrawupdate"==this.$moveName$||"pointermove"==this.$moveName$?new PointerEvent(this.$moveName$,e):new MouseEvent("mousemove",e),this.$eventElement$.dispatchEvent(i)}}start(){this.$rsdmmTimer$&&this.stop(),this.$rsdmmTimer$=window.setInterval(this.$rsdmmTickFunc$,this.$rsdmmPollInterval$)}stop(){this.$rsdmmTimer$&&(clearInterval(this.$rsdmmTimer$),this.$rsdmmTimer$=0)}reset(){this.$button1$&&si(this,0,!1),this.$button2$&&si(this,2,!1),this.$accumulatedH$=this.$accumulatedV$=this.$prevH$=this.$prevV$=0,this.$button1$=this.$button2$=!1}$gamepadBitmapUpdateHandler$(){}$finalizeGamepadData$(){}$virtualGamepadUpdateHandler$(){}$connectUnsupportedGamepad$(){}};function ri(e){return{$mimeTypeStr$:"image/x-icon",scale:1,...e}}const ai={style:"default",$imageStr$:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAOAAAADAAAABwAAAAYAAAAOAAABDAAAAZwAAAHYAAAB4AAAAf+AAAH/AAAB/gAAAfwAAAH4AAAB8AAAAeAAAAHAAAABgAAAAQAAAAAAAAAAAAAAAAAAAA////////////////////////////////////////////5////8P///+D////h////wf//98P///OD///xh///8Af///AP///wAH//8AD///AB///wA///8Af///AP///wH///8D////B////w////8f////P////3/////////8=",$hotspotX$:2,$hotspotY$:1},$i=[{style:"none",$imageStr$:"",$hotspotX$:0,$hotspotY$:0},ai,{style:"text",$imageStr$:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAfvwAAAAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAfPwAAAAAAAAAAAAAAAAAA/////////////////////////////////////+BA///Agf///z////8/////P////z////8/////P////z////8/////P////z////8/////P////z////8/////P////z////8/////P////z///+BA///Agf////////////8=",$hotspotX$:8,$hotspotY$:13},{style:"wait",$imageStr$:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/8AAAzzAAAHDgAABfoAAAb2AAADbAAAAfgAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAB+AAAA/wAAAaWAAAH/gAABWoAAA//AAAP/wAAAAAAAAAAAAA//////////////////////////////////////////+AAf//gAH//4AB//+AAf//wAP//8AD///gB///8A////gf///8P////D////w////8P////D////gf///wD///4Af//8AD///AA///gAH//4AB//+AAf//gAH///////8=",$hotspotX$:7,$hotspotY$:12},{style:"crosshair",$imageStr$:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAABjAAABgMAAAQBAAAIAIAACACAABAAQAAAIAAAEABAAAgAgAAIAIAABgMAAAICAAABjAAAAFAAAAAAAAA//////////////////////////////////////////////////////////////////////////////////////4////5T///53P//+97///fff//333//79+//+AAP//v37//999///fff//53P///d3///5T////j////////8=",$hotspotX$:8,$hotspotY$:8},{style:"progress",$imageStr$:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD4AAAAiAAAAPgAAABwAAAYIAAAOCAAADAgAABwcAAAYNgAAOCoABDA+AAZwAAAHYAAAB4AAAAf+AAAH/AAAB/gAAAfwAAAH4AAAB8AAAAeAAAAHAAAABgAAAAQAAAAAAAAAAAAAAAAAAAA///////////////////////+A////gP///4D///+A///5wf//8OP//+Dj///h4///wcH/98OA//ODgP/xh4D/8AeA//AP///wAH//8AD///AB///wA///8Af///AP///wH///8D////B////w////8f////P////3/////////8=",$hotspotX$:2,$hotspotY$:1},{style:"nwse-resize",$imageStr$:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP4AAAB+AAAAPgAAAB4AAABuAAAA5gAAAcIAAEOAAABnAAAAdgAAAHgAAAB8AAAAfgAAAH8AAAAAAAAAAAAAA/////////////////////////////////////////////////////////////////////////////////wA///+AP///wD///+A////gP///wD//34A//88GP//GDz//wB+//8A////Af///wH///8A////AH///wA////////8=",$hotspotX$:9,$hotspotY$:8},{style:"nesw-resize",$imageStr$:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAfwAAAH4AAAB8AAAAeAAAAHYAAABnAAAAQ4AAAAHCAAAA5gAAAG4AAAAeAAAAPgAAAH4AAAD+AAAAAAAAAAAAA////////////////////////////////////////////////////////////////////////////////wA///8Af///AP///wH///8B////AP///wB+//8YPP//PBj//34A////AP///4D///+A////AP///gD///wA///////8=",$hotspotX$:9,$hotspotY$:9},{style:"ew-resize",$imageStr$:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAEAABgBgAA4AcAAeAHgAPv98AH7/fgA+/3wAHgB4AA4AcAAGAGAAAgBAAAAAAAAAAAAAAAAAA//////////////////////////////////////////////////////////////////////////////////////+/3///P8///j/H//w/w//4P8H/8AAA/+AAAH/AAAA/4AAAf/AAAP/4P8H//D/D//4/x///P8///7/f//////8=",$hotspotX$:13,$hotspotY$:8},{style:"ns-resize",$imageStr$:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADgAAAB8AAAA/gAAAf8AAAP/gAAAAAAAADgAAAA4AAAAOAAAADgAAAA4AAAAOAAAADgAAAA4AAAAAAAAA/+AAAH/AAAA/gAAAHwAAAA4AAAAEAAAAAAAAAAAAAA//////////////////////////////////////+/////H////g////wH///4A///8AH//+AA///AAH///g////4P///+D////g////4P///+D////g////4P///AAH//4AD///AB///4A////Af///4P////H////7////////8=",$hotspotX$:9,$hotspotY$:12},{style:"move",$imageStr$:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAABwAAAA+AAAAHAAAABwAAAAcAAAAHAAAABwAAAgACAAf3fwAP93+AB/d/AAIAAgAABwAAAAcAAAAHAAAABwAAAAcAAAAPgAAABwAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////f////j////wf///4D///8Af///wf///8H///vB7//zwef/4AAD/8AAAf+AAAD/wAAB/+AAA//zwef/+8Hv///B////wf///wB///+A////wf///+P////3///////////////////////8=",$hotspotX$:13,$hotspotY$:12},ai,{style:"pointer",$imageStr$:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH+AAAB/gAAA/4AAAP/AAAH/wAAB/8AAA//gAAP/4AAH/+AADttgABzbYAAY2wAAANsAAADYAAAAwAAAAMAAAAAAAAAAAAAA//////////////////////////////////////////////////////////////////////+Af///AD///wA///4AP//+AB///AAf//wAH//4AA//+AAP//AAD//gAA//wAAP/8IAH//mAH///gD///4H///+H////z////////8=",$hotspotX$:8,$hotspotY$:3},{style:"help",$imageStr$:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAABgAAAAYAAAYHAAAOAYAADADAABwwwAAYMMAAODDABDAZgAZwDwAHYAAAB4AAAAf+AAAH/AAAB/gAAAfwAAAH4AAAB8AAAAeAAAAHAAAABgAAAAQAAAAAAAAAAAAAAAAAAAA/////////////+f////D////5//////////n////w///58P//8PB//+D4P//hzB//wYYf98OGH/ODhh/xh8A/8Afgf/AP8P/wAH//8AD///AB///wA///8Af///AP///wH///8D////B////w////8f////P////3/////////8=",$hotspotX$:2,$hotspotY$:1}];function ci(e,t,i){var n,s,o=i.getBoundingClientRect();i=null!==(s=null===(n=i.parentElement)||void 0===n?void 0:n.getBoundingClientRect())&&void 0!==s?s:new DOMRect(0,0,0,0),s=vi(e),n=o.left-i.left-e.$j$.offsetX+s.$horizontal$+(e.$j$.$zoomFactor$-1)*e.$j$.$leftPadding$,o=o.top-i.top-e.$j$.offsetY+s.vertical+(e.$j$.$zoomFactor$-1)*e.$j$.$topPadding$,t.style.position="absolute",t.style.left=n+"px",t.style.top=o+"px",t.style.zIndex="200",Ai(e,t)}function di(e,t){if(e.$L$&&e.$F$!==t)switch(e.$A$&&Ei(e),e.$F$=t,e.$A$&&Ci(e),t){case 1:e.$D$=4;break;case 2:e.$D$=8;break;case 3:e.$D$=16;break;default:e.$D$=0}}function li(e){var t,i;return e.$isUserInputEnabled$()&&2!=e.cursorType&&e.$v$.$h$&&(!e.$g$.$absPositioning$||e.$g$.$confined$)&&(null===(i=null===(t=bs(e.$I$))||void 0===t?void 0:t.$allowPointerLock$())||void 0===i||i)}function ui(e){var t=li(e);const i=null!==e.$o$,n=e.$u$&&!e.$g$.$absPositioning$,s=e.$na$;!e.$allowPointerLock$||!t||i&&n===s?!t&&i&&(e.$o$=null,document.exitPointerLock&&document.exitPointerLock()):(t=e.$s$,e.$o$=t,t.requestPointerLock&&3>e.$J$&&(e.$sa$?(t=t.requestPointerLock({unadjustedMovement:n}))&&(e.$ia$=!0,t.then((()=>{e.$na$=n,e.$J$=0})).catch((t=>{e.$o$=null,"NotSupportedError"===t.name&&n?(d.i("{70cc40b}","{08fd91e}"),e.$u$=!1,ui(e)):("UnknownError"==t.name?(e.$J$++,d.w("{70cc40b}","{9f2ba9f}",e.$J$)):d.e("{70cc40b}","{4cdd98f}",t.name,t.message),ki(e))}))):t.requestPointerLock()))}function hi(e,t,i){gi(e,t-e.$j$.$leftPadding$,i-e.$j$.$topPadding$)}function pi(e,t,i){if(!e.$C$.has(t)){e.$C$.add(t);const n=(e=e.$m$).$l$(18);n.setUint32(0,8,!0),n.setUint8(4,t+1),n.setUint8(5,0),n.setUint32(6,0),Et(i,n,10,!1,1e3);try{Yt(e,n)}catch(t){d.e("{57a6a4d}","{b258856}",t),e.$v$.$g$(t,"send mousedown exception","{57a6a4d}.ts",0,0,!0)}}}function mi(e,t,i){if(e.$C$.has(t)){e.$C$.delete(t);const n=(e=e.$m$).$l$(18);n.setUint32(0,9,!0),n.setUint8(4,t+1),n.setUint8(5,0),n.setUint32(6,0),Et(i,n,10,!1,1e3);try{Yt(e,n)}catch(t){d.e("{57a6a4d}","{c1ae1fc}",t),e.$v$.$g$(t,"send mouseup exception","{57a6a4d}.ts",0,0,!0)}}}function fi(e,t){if(t instanceof PointerEvent){if(Pi(t))return;t.preventDefault()}let i=performance.now();if(!(!e.$v$.$h$||li(e)&&null===e.$o$||0===t.movementX&&0===t.movementY)){var n=1,s=0,o=e.$g$.$absPositioning$,r=e.$B$.$h$,a=t=>{if(e.$mouseFilter$.update(t.movementX,t.movementY,t.timeStamp)){var r=e.$mouseFilter$.$getX$(),a=e.$mouseFilter$.$getY$();o?(e.$g$.$confined$?($=e.$K$?e.$h$.$dpiRatio$:1,gi(e,e.$g$.$absX$+r/$,e.$g$.$absY$+a/$)):hi(e,t.offsetX,t.offsetY),e.$h$.$dirty$=!0,r=e.$g$.$absX$,a=e.$g$.$absY$):e.$K$&&($=e.$h$.$dpiRatio$,r+=e.$g$.$remX$,a+=e.$g$.$remY$,e.$g$.$remX$=r%$,e.$g$.$remY$=a%$,r/=$,a/=$);e:{var $=e.$B$;if(t=Bt(t.timeStamp),0!=s%n&&0<$.$j$){const e=$.$l$[$.$j$-1];if(e.$absPos$===o&&e.$callbackTimestamp$===i){o?(e.x=r,e.y=a):(e.x+=r,e.y+=a);break e}}$.$j$==$.$l$.length?($.$l$.push({$absPos$:o,x:r,y:a,captureTimestamp:t,$groupSize$:0,$callbackTimestamp$:i}),$.$j$++):(($=$.$l$[$.$j$++]).$absPos$=o,$.x=r,$.y=a,$.captureTimestamp=t,$.$groupSize$=0,$.$callbackTimestamp$=i)}s++}};if(t instanceof PointerEvent&&e.$N$){const i=t.getCoalescedEvents();if(0==i.length)a(t);else{t=e.$B$.$g$.length,t=i.length>2*t?1:Math.max(t-e.$B$.$h$-4,1),i.length>t&&(n=Math.ceil(i.length/t),e.$T$.$aggregatedCount$+=i.length);for(let e of i)a(e)}}else a(t);1<e.$m$.$S$&&0===r&&e.$B$.$h$>r&&(e.$B$.$l$[r].$groupSize$=e.$B$.$h$-r)}}function gi(e,t,i){e.$g$.$absX$=Math.min(Math.max(t,0),e.$j$.$displayVideoWidth$),e.$g$.$absY$=Math.min(Math.max(i,0),e.$j$.$displayVideoHeight$),e.$h$.$dirty$=!0}function vi(e){return{$horizontal$:e.$j$.$displayVideoWidth$*(e.$j$.$zoomFactor$-1)/2,vertical:e.$j$.$displayVideoHeight$*(e.$j$.$zoomFactor$-1)/2}}function Ai(e,t){(t=t.getContext("2d"))&&(e.$h$.$graphicsContext$=t,t=window.devicePixelRatio,e.$h$.$dpiRatio$!=t&&(d.i("{70cc40b}","{b786ba9}",t),e.$h$.$dpiRatio$=t,e.$h$.$imageChanged$=!0,e.$h$.$imageDimensionsChanged$=!0,e.$h$.$dirty$=!0))}function bi(e,t){if(e.$j$.$displayVideoWidth$&&e.$j$.$displayVideoHeight$){const i=t.$displayVideoHeight$/e.$j$.$displayVideoHeight$;e.$g$.$absX$*=t.$displayVideoWidth$/e.$j$.$displayVideoWidth$,e.$g$.$absY$*=i}e.$j$=t,e.$l$&&ci(e,e.$l$,e.$s$)}function wi(e,t){e.$h$.$showing$&&(e.$h$.$showing$=!1,t.style.visibility="hidden",e.$g$.image=void 0)}function Si(e,t){if(e.$l$)if("none"!==t.style){var i=()=>{const i=t.$imageElement$;e.$h$.$imageChanged$=!0,e.$h$.$imageDimensionsChanged$=!e.$g$.image||i.width!==e.$g$.image.width||i.height!==e.$g$.image.height,e.$g$.image=i,e.$g$.$hotspotX$=t.$hotspotX$,e.$g$.$hotspotY$=t.$hotspotY$,e.$g$.width=i.width,e.$g$.height=i.height,e.$g$.scale=t.scale,e.$h$.$dirty$=!0};if(t.$imageElement$)0!==t.$imageElement$.width||0!==t.$imageElement$.height?i():e.$g$.$imagePendingDecode$=t.$imageElement$;else{const n=new Image;t.$imageElement$=n,!n.decode&&n.decoding&&(n.decoding="sync"),n.src=`data:${t.$mimeTypeStr$};base64,${t.$imageStr$}`,n.decode?(e.$g$.$imagePendingDecode$=n,n.decode().then((()=>{e.$g$.$imagePendingDecode$===n&&(e.$g$.$imagePendingDecode$=void 0,i())})).catch((()=>{e.$g$.$imagePendingDecode$===n&&(e.$g$.$imagePendingDecode$=void 0,Si(e,e.$O$[1]))}))):(e.$g$.$imagePendingDecode$=void 0,i())}}else wi(e,e.$l$);else t.style||(t.style=`url(data:${t.$mimeTypeStr$};base64,${t.$imageStr$}) ${t.$hotspotX$} ${t.$hotspotY$}, auto`),e.$g$.style=t.style}function yi(e,t,i,n){const s="none"!==t.style;!e.$g$.$absPositioning$&&s&&void 0!==i&&void 0!==n&&gi(e,i*e.$j$.$displayVideoWidth$/65535,n*e.$j$.$displayVideoHeight$/65535),e.$g$.$absPositioning$=s,s||(e.$g$.$remX$=0,e.$g$.$remY$=0),ui(e),Si(e,t),ki(e)}function ki(e){const t=e.$s$;!e.$isUserInputEnabled$()||li(e)&&null===e.$o$||2==e.cursorType?t.style.cursor="default":t.style.cursor=e.$l$?"none":e.$g$.style}function Ci(e){2==e.cursorType?(e.$H$.$moveName$=Ti(e),e.videoAddEventListener(Ti(e),e.$G$?e.$aa$:e.$$$)):0!==e.$F$?(e.$H$.$moveName$="pointerrawupdate",e.videoAddEventListener("pointerrawupdate",e.$ka$)):(e.$H$.$moveName$=Ti(e),e.videoAddEventListener(Ti(e),e.$ja$))}function _i(e){if(0<e.$C$.size){d.i("{70cc40b}","{041c67f}",e.$C$.size);for(const t of e.$C$)mi(e,t,0)}}function Ei(e){2==e.cursorType?e.videoRemoveEventListener(Ti(e),e.$G$?e.$aa$:e.$$$):0!==e.$F$?e.videoRemoveEventListener("pointerrawupdate",e.$ka$):e.videoRemoveEventListener(Ti(e),e.$ja$)}function Ti(e){return e.$G$?"pointermove":"mousemove"}var Ii=class{constructor(e,t,i,n,s,o,r,a,$,c){var l,u,h,p,m,f,g,v,A,b,w,S,y,k,I;this.$v$=c,this.$J$=0,this.$allowPointerLock$=!1,this.$C$=new Set,this.$ia$=this.$na$=this.$u$=this.$N$=this.$G$=this.$L$=!1,this.$D$=this.$F$=0,this.$P$=!1,this.$fa$={passive:!1},this.$W$=!0,this.$A$=!1,this.$platformDetails$=s,this.$I$=e,this.$s$=t,this.$oa$=n,this.$H$=o,this.$T$=r,this.$B$=a,this.$m$=$,i.onmessage=e=>function(e,t){let i=new Uint8Array(t.data);switch(i[0]){case 0:case 1:t=i[1];let h=i[2],p=i[3];var n=i[4];let m=5,f=()=>{const e=i[m]+(i[m+1]<<8);return m+=2,e};var s="";0!=n&&(s=i.subarray(m,m+n),m+=n,s=new TextDecoder("utf-8").decode(s));var o="";let g,v,A;0!=(n=f())&&(o=i.subarray(m,m+n),m+=n,o=new TextDecoder("utf-8").decode(o)),m+4<=i.byteLength&&(g=f(),v=f()),m+2<=i.byteLength&&(A=f()/100),0==i[0]?(l=g,u=v,(c=t)>=($=e).$O$.length?d.e("{70cc40b}","{de8eabe}",c):yi($,$.$O$[c],l,u)):function(e,t,i,n,s,o,r,a,$){if(0<o.length)i={$imageStr$:o,$hotspotX$:i,$hotspotY$:n,$mimeTypeStr$:s,scale:$||1},e.$V$[t]=i;else if(void 0===(i=e.$V$[t]))return void d.e("{70cc40b}","{0196577}",t);yi(e,i,r,a)}(e,t,h,p,s,o,g,v,A);break;case 10:e.$oa$.allowUnconfined&&(r=e,a=1==i[1],r.$g$.$confined$=a,ui(r))}var r,a,$,c,l,u}(this,e),this.$j$={$displayVideoWidth$:t.clientWidth||window.screen.width,$displayVideoHeight$:t.clientHeight||window.screen.height,$scalingFactor$:1,$leftPadding$:0,$topPadding$:0,videoWidth:0,videoHeight:0,$viewportHeight$:0,offsetX:0,offsetY:0,$zoomFactor$:1},e=window.zoneless,this.documentAddEventListener=null!==(u=null===(l=null==e?void 0:e.documentAddEventListener)||void 0===l?void 0:l.bind(document))&&void 0!==u?u:document.addEventListener.bind(document),this.documentRemoveEventListener=null!==(p=null===(h=null==e?void 0:e.documentRemoveEventListener)||void 0===h?void 0:h.bind(document))&&void 0!==p?p:document.removeEventListener.bind(document),this.videoAddEventListener=null!==(v=null!==(f=null===(m=null==e?void 0:e.videoAddEventListener)||void 0===m?void 0:m.bind(t))&&void 0!==f?f:null===(g=null==e?void 0:e.documentAddEventListener)||void 0===g?void 0:g.bind(document))&&void 0!==v?v:t.addEventListener.bind(t),this.videoRemoveEventListener=null!==(S=null!==(b=null===(A=null==e?void 0:e.videoRemoveEventListener)||void 0===A?void 0:A.bind(t))&&void 0!==b?b:null===(w=null==e?void 0:e.documentRemoveEventListener)||void 0===w?void 0:w.bind(document))&&void 0!==S?S:t.removeEventListener.bind(t),this.$U$=this.$ba$.bind(this),this.$la$=this.$wa$.bind(this),this.$da$=this.$ca$.bind(this),this.$ma$=this.$za$.bind(this),this.$ea$=this.$ta$.bind(this),this.$ja$=this.$xa$.bind(this),this.$ka$=this.$ya$.bind(this),this.$$$=this.$Z$.bind(this),this.$aa$=this.$ra$.bind(this),this.$ha$=this.$ua$.bind(this),this.$ga$=this.$va$.bind(this),this.$R$=this.$pa$.bind(this),this.$S$=this.$qa$.bind(this),this.cursorType=null!==(y=n.cursorType)&&void 0!==y?y:0,d.i("{70cc40b}","{3277c0e}",this.cursorType),this.$g$={$absPositioning$:!1,$confined$:0===this.cursorType&&!n.allowUnconfined,$absX$:0,$absY$:0,$remX$:0,$remY$:0,style:"",$hotspotX$:0,$hotspotY$:0,width:0,height:0,scale:1},this.$h$={$dpiRatio$:1,$cursorScaling$:1,$dirty$:!1,$imageChanged$:!1,$imageDimensionsChanged$:!1,$showing$:!1},this.$V$=[],this.$M$="canvasId1",0==this.cursorType?(this.$l$=function(e,t){var i=document.getElementById(e.$M$);if(i&&i instanceof HTMLCanvasElement&&i.parentElement===t.parentElement)return i;if(i){let t;do{t="canvasId"+Math.round(1e4*Math.random()),i=document.getElementById(t)}while(i);e.$M$=t}return(i=document.createElement("canvas")).id=e.$M$,i.style.touchAction="none",i.style.pointerEvents="none",i.style.willChange="transform",ci(e,i,t),t.insertAdjacentElement("afterend",i),i}(this,this.$s$),ci(this,this.$l$,this.$s$)):this.$l$=null,this.$O$=$i.map(ri),this.$o$=null,this.$L$="onpointerrawupdate"in this.$s$,this.$N$=(this.$G$=!(null===PointerEvent||void 0===PointerEvent||!PointerEvent.prototype))&&"getCoalescedEvents"in PointerEvent.prototype&&"Firefox"!==s.browser,d.i("{70cc40b}","{f30b8ee}",this.$N$?"supported":"not supported"),this.$sa$=!!window.chrome,this.$L$&&(void 0!==(t=function(){const e=ut.$ragnarokConfig$.mouseCoalesceInterval;if(void 0!==e)return new Map([[0,0],[4,1],[8,2],[16,3]]).get(e)}())?di(this,t):_(s)?di(this,3):di(this,1),d.i("{70cc40b}","{20be0c0}",this.$D$,void 0!==t?" (overridden)":"")),this.$u$=null!==(k=ut.unadjustedMovement)&&void 0!==k?k:E(this.$platformDetails$)?O(this.$platformDetails$,84,0,4147,78):!(!_(this.$platformDetails$)&&!T(this.$platformDetails$))&&O(this.$platformDetails$,86,0,4240,198),k=_(s)&&O(this.$platformDetails$,84,0,4147,94)&&!O(this.$platformDetails$,88,0,4324,139),k=E(this.$platformDetails$)||!k||!O(this.$platformDetails$,84,0,4147,94),(null!==(I=ut.$mouseFilter$)&&void 0!==I?I:k)?this.$mouseFilter$=new class{constructor(){this.$l$=this.$j$=this.$o$=this.$m$=this.$A$=this.$v$=this.$s$=this.$h$=this.$g$=0,this.$u$=!1}$getX$(){return this.$g$}$getY$(){return this.$h$}update(e,t,i){if(0===e&&0===t)return this.$u$?this.$l$=this.$j$=0:this.$u$=!0,!1;if(this.$u$=!1,0===this.$j$&&0===this.$l$){if(i<this.$s$)return this.$j$=e,this.$l$=t,!1}else e+=this.$j$,t+=this.$l$,this.$l$=this.$j$=0;var n=e*this.$g$+t*this.$h$,s=e*e+t*t,o=this.$g$*this.$g$+this.$h$*this.$h$,r=!0;if(.95>i-this.$s$&&0>n&&0!==o&&n*n>.81*s*o&&(n=Math.sqrt(s)/Math.sqrt(o),.5<(n=Math.abs(n-Math.trunc(n)))&&(n=1-n),.1>n&&(r=!1)),n=e-this.$g$,s=t-this.$h$,r&&(r=2*(o=1+.1*Math.max(1,Math.min(16,i-this.$s$)))*Math.abs(this.$v$),o=2*o*Math.abs(this.$A$),!(r=n*n+s*s<(o=Math.max(8100,r*r+o*o)))&&(this.$m$||this.$o$))){r=e-this.$m$;const i=t-this.$o$;r=r*r+i*i<o}return r?(this.$v$=.4*this.$v$+.6*n,this.$A$=.4*this.$A$+.6*s,this.$g$=e,this.$h$=t,this.$s$=i,this.$o$=this.$m$=0,!0):(this.$m$=e,this.$o$=t,!1)}}:this.$mouseFilter$=new class{constructor(){this.y=this.x=0}$getX$(){return this.x}$getY$(){return this.y}update(e,t){return this.x=e,this.y=t,!0}},["pointerlockchange","mozpointerlockchange"].forEach((e=>this.documentAddEventListener(e,this.$ha$))),["pointerlockerror","mozpointerlockerror"].forEach((e=>this.documentAddEventListener(e,this.$ga$))),ls(this.$v$,0,this.$R$),ls(this.$v$,2,this.$S$),C(this.$platformDetails$)||"Tizen"===this.$platformDetails$.os?this.$K$=!0:"Chrome"!=s.browser||O(s,99,0,4844,44)||T(s)?this.$K$=!1:this.$K$=!0,d.d("{70cc40b}","{ec7c4c5}")}uninitialize(){["pointerlockerror","mozpointerlockerror"].forEach((e=>this.documentRemoveEventListener(e,this.$ga$))),["pointerlockchange","mozpointerlockchange"].forEach((e=>this.documentRemoveEventListener(e,this.$ha$))),us(this.$v$,0,this.$R$),us(this.$v$,2,this.$S$)}$wa$(e){Pi(e)||(e.preventDefault(),this.$ba$(e),2===this.cursorType&&this.$s$.setPointerCapture(e.pointerId))}$ba$(e){var t;null===(t=this.$I$.$I$)||void 0===t||2==t.$g$&&(d.i("{4c846ba}","{89b1a9f}"),Yo(t),qo(t),Xo(t)),hs(this.$v$,!0),this.$allowPointerLock$=!0,t=Bt(e.timeStamp),li(this)&&null===this.$o$?(ui(this),hi(this,e.offsetX,e.offsetY),this.$h$.$dirty$=!0,ei(this.$m$,this.$g$.$absX$,this.$g$.$absY$,t)):(ct($t()),pi(this,e.button,t))}$za$(e){Pi(e)||(e.preventDefault(),this.$ca$(e))}$ca$(e){ct($t()),mi(this,e.button,Bt(e.timeStamp))}$ta$(e){Xt(this.$m$,e.deltaY,Bt(e.timeStamp)),e.preventDefault()}$ra$(e){if(!Pi(e)){if(e.preventDefault(),-1!==e.button){let t;switch(e.button){case 1:t=2;break;case 2:t=1;break;default:t=e.button}const i=Bt(e.timeStamp);e.buttons&1<<t?pi(this,e.button,i):mi(this,e.button,i)}this.$Z$(e)}}$Z$(e){hi(this,e.offsetX,e.offsetY),ei(this.$m$,this.$g$.$absX$,this.$g$.$absY$,Bt(e.timeStamp))}$xa$(e){fi(this,e)}$ya$(e){const t=0<this.$m$.$g$.$h$;var i,n;fi(this,e),!t&&0<this.$m$.$g$.$h$&&((e=performance.now()-this.$m$.$O$)>=this.$D$?Yt(this.$m$):(i=this.$m$,n=this.$D$-e,i.$u$=window.setTimeout((()=>{i.$u$=0,Yt(i)}),n)))}$qa$(e){this.$allowPointerLock$=e,ui(this),ki(this)}$ua$(){document.pointerLockElement instanceof HTMLElement?this.$o$=document.pointerLockElement:(this.$o$=null,li(this)&&(d.i("{70cc40b}","{d4b3de3}"),this.$allowPointerLock$=!1,ki(this)))}$va$(){this.$ia$||(this.$o$=null,this.$u$?(this.$u$=!1,d.e("{70cc40b}","{7599808}"),ui(this)):(d.e("{70cc40b}","{d633cd1}"),ki(this)))}$isUserInputEnabled$(){return this.$A$}$pa$(e){e&&(this.$v$.$j$&&(this.$allowPointerLock$=!0,ui(this)),this.$l$&&Ai(this,this.$l$))}};function Pi(e){return!e.isPrimary||"touch"===e.pointerType||"pen"===e.pointerType}function ji(e,t){1===e.$g$.$zoomFactor$&&(en(e.$I$),mi(e.$l$,0,t))}function Ri(e){var t=e.$l$;t.$P$=!1,t.$h$.$dirty$=!0,1.1>e.$g$.$zoomFactor$&&Ni(e,e.$g$.offsetX,e.$g$.offsetY,1)}function Di(e){return e.$R$?(zi(e),!1):e.$C$.$h$}function xi(e,t){if(2===t.length){var i=e.$l$;i.$P$=!0,i.$h$.$dirty$=!0,i=t[0],t=t[1];var n=Math.hypot(i.clientX-t.clientX,i.clientY-t.clientY),s=Math.hypot(i.clientX-i.deltaX-(t.clientX-t.deltaX),i.clientY-i.deltaY-(t.clientY-t.deltaY));const o=e.$m$.getBoundingClientRect(),r=Yi(e);n=n/s*e.$g$.$zoomFactor$,n=Math.min(Math.max(n,1),3),s=(i.clientX+t.clientX)/2-o.left,s+=e.$g$.offsetX-r.$horizontal$-(o.width-s)/e.$g$.$zoomFactor$,s=(n/e.$g$.$zoomFactor$-1)*s*-1,s+=e.$g$.offsetX+(i.deltaX+t.deltaX)/2;let a=(i.clientY+t.clientY)/2-o.top;a+=e.$g$.offsetY-r.vertical-(o.height-a)/e.$g$.$zoomFactor$,a=(n/e.$g$.$zoomFactor$-1)*a*-1,a+=e.$g$.offsetY+(i.deltaY+t.deltaY)/2,Ni(e,s,a,n)}}function Mi(e,t,i,n,s){switch(en(e.$I$),s){case 1:Xi(e,t,n,i),e.$I$.delay((()=>{Qi(e,0,i)}));break;case 2:e.$Z$++,0===e.$G$&&(e.$G$=window.setTimeout((()=>{2===e.$Z$?e.$s$.toggleOnScreenStats():3===e.$Z$&&e.$s$.toggleOnScreenStats(ut.isInternalUser),Hi(e)}),300)),Qi(e,2,i);break;case 3:e.$ga$++,ut.isInternalUser&&0===e.$G$&&(e.$G$=window.setTimeout((()=>{2===e.$ga$&&ds(e.$N$),Hi(e)}),300)),Qi(e,1,i);break;case 4:Qi(e,3,i);break;case 5:Qi(e,4,i)}}function Li(e,t){(e.$R$=t)&&15!==e.$v$&&(e.$ca$=e.$v$,e.toggleUserInput(!0)),t?Wi(e).forEach((t=>e.documentAddEventListener(t,e.$ma$))):Wi(e).forEach((t=>e.documentRemoveEventListener(t,e.$ma$)))}function Oi(e){0!==e.$V$&&(window.clearTimeout(e.$V$),e.$V$=0)}function Bi(e,t){if(!(e.$aa$&&20===t.keyCode||w(e.$platformDetails$)&&20!==t.keyCode)){var i=16;if(e.$da$&&e.$W$||!t.getModifierState("CapsLock")||(i|=1),e.$va$&&(i|=96,t.getModifierState("NumLock")&&(i|=2),t.getModifierState("ScrollLock")&&(i|=4)),i!=e.$S$){e.$S$=i,(t=(e=e.$j$).$l$(5)).setUint32(0,19,!0),t.setUint8(4,i);try{Yt(e,t),d.d("{57a6a4d}","{56c9613}",i.toString(2))}catch(t){d.e("{57a6a4d}","{cbe483c}",t),e.$v$.$g$(t,"LockKeys state synchronize exception","{57a6a4d}.ts",0,0,!0)}}}}function Ni(e,t,i,n){e.$g$.$zoomFactor$=n;let s=Yi(e);s.$horizontal$-=e.$g$.$leftPadding$,s.vertical-=e.$g$.$topPadding$;let o=Math.max(s.vertical+Math.max(0,e.$g$.$displayVideoHeight$-e.$g$.$viewportHeight$+2*e.$g$.$topPadding$),0),r=Math.max(s.vertical,0);s.$horizontal$=Math.max(s.$horizontal$,0),t=Math.min(Math.max(t,-1*s.$horizontal$),s.$horizontal$),i=Math.min(Math.max(i,-1*o),r),e.$m$.style.transform=`translate3d(${t}px,${i}px,0px) scale3d(${n},${n},1)`,e.$g$.offsetX=t,e.$g$.offsetY=i,bi(e.$l$,e.$g$)}function Fi(e,t){var i;return e.$L$?e.$A$&&e.$isVirtualKeyboardVisible$?null!=(e=null!==(i=t.code)&&void 0!==i&&i.length?Wt.get(t.code):Wt.get(t.key))?e:0:null!=(t=t.code?Wt.get(t.code):Kt.get(t.key))?t:0:t.keyCode}function Vi(e,t){var i=0;let n;return t.ctrlKey&&!t.code.startsWith("Control")&&(i|=2),t.altKey&&!t.code.startsWith("Alt")&&(i|=4),t.metaKey&&!t.code.startsWith("Meta")&&(i|=8),w(e.$platformDetails$)&&1===t.key.length&&('!@#$%^&*()~_+{}|:"<>?'.includes(t.key)?n=1:"1234567890`-=[]\\;',./".includes(t.key)&&(n=0)),void 0===n&&t.shiftKey&&!t.code.startsWith("Shift")&&(n=1),i|(null!=n?n:0)}function Ui(e){Oi(e),e.$V$=window.setTimeout((()=>{e.$N$.send()}),350)}function Gi(e){if(0<e.$u$.size){d.i("{8bacfa5}","{7998ee8}",e.$u$.size);for(const t of e.$u$)ti(e.$j$,4,t,0);e.$u$.clear()}}function Hi(e){window.clearTimeout(e.$G$),e.$G$=0,e.$Z$=0,e.$ga$=0}function zi(e){Li(e,!1),e.$$$.emit("StreamingEvent",{streamingWarnings:{code:4}}),void 0!==e.$ca$&&(e.toggleUserInput(!1,15&~e.$ca$),e.$ca$=void 0);var t=e.$j$;const i=t.$l$(10);i.setUint32(0,2,!0);try{t.$A$.send(i),d.d("{57a6a4d}","{5693344}")}catch(e){d.e("{57a6a4d}","{ab52f04}",e),t.$v$.$g$(e,"heartbeat exception","{57a6a4d}.ts",0,0,!0)}Ir(e.$ya$)}function Wi(e){return[Ti(e.$l$),"pointerdown","touchstart"]}function Ki(e,t){t=(new TextEncoder).encode(t),e.sendTextInput(t.buffer),e.textInputElement.value=""}function Ji(e){for(let t=e.length-1;0<=t;t--)if(void 0===Jt.get(e.charAt(t)))return!1;return!0}function qi(e,t){let i=!1;16&e.$S$&&(i=!!(1&e.$S$));for(let s=0;s<t.length;s++){var n=Jt.get(t.charAt(s));if(!n)return void d.e("{8bacfa5}","{67554be}",t.charAt(s));const o=n.vkCode;n=n.shift?1:0,65<=o&&90>=o&&i&&(n=~n),n&&ti(e.$j$,3,160,0,performance.now()),ti(e.$j$,3,o,n,performance.now()),ti(e.$j$,4,o,n,performance.now()),n&&ti(e.$j$,4,160,0,performance.now())}e.textInputElement.value=""}function Yi(e){return{$horizontal$:e.$g$.$displayVideoWidth$*(e.$g$.$zoomFactor$-1)/2,vertical:e.$g$.$displayVideoHeight$*(e.$g$.$zoomFactor$-1)/2}}function Xi(e,t,i,n){en(e.$I$),t=t.getBoundingClientRect(),hi(e.$l$,(i.clientX-t.left)/e.$g$.$zoomFactor$,(i.clientY-t.top)/e.$g$.$zoomFactor$);const{$absX$:s,$absY$:o}=e.$l$.$g$;ei(e.$j$,s,o,n)}function Qi(e,t,i){pi(e.$l$,t,i),e.$I$.delay((()=>{mi(e.$l$,t,i)}))}var Zi=class{constructor(e,t,i,n,s,o,r,a,$,c,l,u,h,p,m){var f,g,v,A,b,S,y,k,C,I,P,j,R,M,L,O,B,N,F,V,U,G,H,z,W,K,J;this.$C$=p,this.$u$=new Set,this.$v$=0,this.$isVirtualKeyboardVisible$=!1,this.$L$=!0,this.$G$=0,this.$I$=new sn,this.$gamepadTesterEnabled$=!1,this.$H$=0,this.$W$=this.$fa$=!1,this.$V$=this.$ga$=this.$Z$=0,this.$ja$=this.$ia$="off",this.$platformDetails$=l,this.$s$=e,this.$m$=t,this.$ba$=s,this.$ya$=u,this.$N$=h,this.$g$={$displayVideoWidth$:t.clientWidth||window.screen.width,$displayVideoHeight$:t.clientHeight||window.screen.height,$scalingFactor$:1,$leftPadding$:0,$topPadding$:0,videoWidth:0,videoHeight:0,$viewportHeight$:0,offsetX:0,offsetY:0,$zoomFactor$:1},s=window.zoneless,this.windowAddEventListener=null!==(g=null===(f=null==s?void 0:s.windowAddEventListener)||void 0===f?void 0:f.bind(window))&&void 0!==g?g:window.addEventListener.bind(window),this.windowRemoveEventListener=null!==(A=null===(v=null==s?void 0:s.windowRemoveEventListener)||void 0===v?void 0:v.bind(window))&&void 0!==A?A:window.removeEventListener.bind(window),this.documentAddEventListener=null!==(S=null===(b=null==s?void 0:s.documentAddEventListener)||void 0===b?void 0:b.bind(document))&&void 0!==S?S:document.addEventListener.bind(document),this.documentRemoveEventListener=null!==(k=null===(y=null==s?void 0:s.documentRemoveEventListener)||void 0===y?void 0:y.bind(document))&&void 0!==k?k:document.removeEventListener.bind(document),this.videoAddEventListener=null!==(j=null!==(I=null===(C=null==s?void 0:s.videoAddEventListener)||void 0===C?void 0:C.bind(t))&&void 0!==I?I:null===(P=null==s?void 0:s.documentAddEventListener)||void 0===P?void 0:P.bind(document))&&void 0!==j?j:t.addEventListener.bind(t),this.videoRemoveEventListener=null!==(O=null!==(M=null===(R=null==s?void 0:s.videoRemoveEventListener)||void 0===R?void 0:R.bind(t))&&void 0!==M?M:null===(L=null==s?void 0:s.documentRemoveEventListener)||void 0===L?void 0:L.bind(document))&&void 0!==O?O:t.removeEventListener.bind(t),this.$pa$=this.$oa$.bind(this),this.$ra$=this.$qa$.bind(this),this.$ka$=this.$la$.bind(this),this.$ta$=this.$Aa$.bind(this),this.$ha$=this.$za$.bind(this),this.$U$=this.$T$.bind(this),this.$xa$=this.$Fa$.bind(this),this.$sa$=this.$Ca$.bind(this),this.$ma$=this.$Ba$.bind(this),this.$wa$=this.$Ea$.bind(this),this.$J$=this.$Da$.bind(this),this.$ea$=!1,this.$K$=$,this.preventNavigation=!!r.preventNavigation,this.$h$={$baseTime$:0,$baseTotalVideoFrames$:0,$animationFrameCount$:0,$sendInputCount$:0,$sendInputOver5ms$:0,$sendInputOver10ms$:0,$singleDroppedFrames$:0,$multiDroppedFrames$:0,$aggregatedCount$:0,$oversizedEventCount$:0},$=new class{constructor(){this.$m$=!1,this.$j$=0,this.$l$=Array(36);for(let e=0;e<this.$g$.length;e++)this.$l$[e]={$absPos$:!1,x:0,y:0,captureTimestamp:0,$groupSize$:0,$callbackTimestamp$:0}}get $g$(){return this.$l$}get $h$(){return this.$j$}},this.$j$=new class{constructor(e,t,i,n,s,o,r){this.$h$=this.$D$=0,this.$m$=new ArrayBuffer(1150),this.$K$=new DataView(this.$m$),this.$U$=new ArrayBuffer(658),this.$j$=new DataView(this.$U$),this.$s$=new DataView(new ArrayBuffer(173)),this.$T$=new ArrayBuffer(100),this.$u$=0,this.$H$=this.$P$,this.$l$=this.$L$,this.$C$=[],this.$I$=e,this.$g$=t,this.$J$=s,this.$G$=n,this.$A$=o,this.$A$.onmessage=e=>{if(e=new DataView(e.data),0===this.$h$){let t=e.getUint16(0,!0);526==t?(this.$F$=this.$N$.bind(this),this.$h$=e.getUint16(2,!0)):(this.$F$=this.$B$.bind(this),this.$h$=t),2==this.$h$?this.$g$.$m$=!0:2<this.$h$&&(this.$g$.$m$=!0,this.$H$=this.$R$,this.$l$=this.$M$),d.i("{57a6a4d}","{68c4654}",this.$h$)}else this.$F$(e,0)},this.$v$=r,this.$o$=i,this.$F$=this.$B$.bind(this),this.$j$.setUint8(9,34),this.$j$.setUint32(10,24,!0)}$N$(e,t){var i=e.getUint16(t,!0);if(267===i)this.$B$(e,t+2);else switch(t=255&i){case 32:case 33:case 34:case 35:case 36:case 255:34===(i=t)?267===(i=e.getUint32(1,!0))?this.$B$(e,5):d.w("{57a6a4d}","{25be6a3}",i):d.d("{57a6a4d}","{ba4ff6a}",i);break;default:d.w("{57a6a4d}","{aea35b8}",i)}}$B$(e,t){var i=e.getUint16(t,!0);if(1==i)if(6>(i=e.getUint16(t+2,!0)))d.e("{57a6a4d}","{1527181}",i);else{6<i&&d.w("{57a6a4d}","{78db114}",i),i=e.getUint16(t+4,!0);var n=e.getUint16(t+6,!0);e=e.getUint16(t+8,!0);for(const d of this.$C$){var s=t=void 0,o=void 0,r=void 0,a=d,$=i,c=e;if(a.$D$){var l=a.$h$[$];if(l){let e=l.$device$;e&&(0!=n||0!=c?(r=(o=performance.now())-a.$R$[$],a.$F$[$]=n/65535,a.$G$[$]=c/65535,(!l.$simplifiedHaptics$||500<r)&&(a.$R$[$]=o,null===(t=null===(s=e.vibrationActuator)||void 0===s?void 0:s.playEffect)||void 0===t||t.call(s,"dual-rumble",{startDelay:0,duration:1e3,weakMagnitude:a.$G$[$],strongMagnitude:a.$F$[$]}))):(a.$R$[$]=performance.now(),a.$F$[$]=0,a.$G$[$]=0,null===(o=null===(r=e.vibrationActuator)||void 0===r?void 0:r.playEffect)||void 0===o||o.call(r,"dual-rumble",ko)))}}}}else d.w("{57a6a4d}","{c7cf6da}",i)}$P$(e){0!==this.$u$&&(window.clearTimeout(this.$u$),this.$u$=0);var t=performance.now();this.$D$=t;for(var i=1,n=0;n<this.$g$.$h$;){i+=2;var s=this.$g$.$g$[n].$groupSize$;if(0<s){i+=19;for(var o=0;o<s;o++)i+=1+(this.$g$.$g$[n+o].$absPos$?26:22);n+=s}else i+=this.$g$.$g$[n].$absPos$?26:22,n++}(i+=e?2+e.byteLength:0)>this.$m$.byteLength?(i=new DataView(new ArrayBuffer(i)),this.$o$.$oversizedEventCount$++):i=new DataView(this.$m$,0,i),i.setUint8(0,255);var r=1;for(n=0;n<this.$g$.$h$;){if(s=r,r+=2,0<(o=this.$g$.$g$[n]).$groupSize$){var a=i,$=n,c=t;l=this.$g$.$g$[$],d=r,r+=19;for(let e=0;e<l.$groupSize$;++e){const t=this.$g$.$g$[$+e];a.setUint8(r,t.$absPos$?26:22),r=Qt(this,a,++r,t.$absPos$,t.x,t.y,t.captureTimestamp)}$=d;var d=r-d,l=l.$callbackTimestamp$;a.setUint8($,32),a.setUint16($+1,d,!1),Et(c,a,$+3,!1,1e3),Et(l,a,$+11,!1,1e3),n+=o.$groupSize$}else r=Qt(this,i,r,o.$absPos$,o.x,o.y,o.captureTimestamp),n++;i.setUint16(s,r-s-2)}if(this.$g$.$j$=0,e)for(i.setUint16(r,e.byteLength),r+=2,t=0;t<e.byteLength;t++)i.setUint8(r+t,e.getUint8(t));return i}$R$(e){var t;if(e&&e.buffer!=this.$m$)return Yt(this),e;0!==this.$u$&&(window.clearTimeout(this.$u$),this.$u$=0),this.$D$=performance.now();for(var i=0,n=-1,s=0;s<this.$g$.$h$;s++)0<this.$g$.$g$[s].$groupSize$?(i+=9,n=this.$g$.$g$[s].$groupSize$):0===n&&(i+=9),i+=3+(this.$g$.$g$[s].$absPos$?26:22),n--;if(i+=null!==(t=null==e?void 0:e.byteLength)&&void 0!==t?t:0,(t=9+i)>this.$m$.byteLength){if(t=new DataView(new ArrayBuffer(t),t-i,i),this.$o$.$oversizedEventCount$++,e)for(i=t.byteLength-e.byteLength,n=0;n<e.byteLength;n++)t.setUint8(i+n,e.getUint8(n))}else t=new DataView(this.$m$,this.$m$.byteLength-i,i);for(e=0,i=-1,n=0;n<this.$g$.$h$;n++)0<(s=this.$g$.$g$[n]).$groupSize$?(i=s.$groupSize$,t.setUint8(e,36),Et(s.$callbackTimestamp$,t,e+1,!1,1e3),e+=9):0===i&&(t.setUint8(e,36),Et(0,t,e+1,!1,1e3),e+=9),t.setUint8(e,33),t.setUint16(e+1,s.$absPos$?26:22),e=Qt(this,t,e+3,s.$absPos$,s.x,s.y,s.captureTimestamp),i--;return this.$g$.$j$=0,t}$L$(e){return new qt(this.$T$,0,e)}$M$(e){e+=1;const t=this.$m$.byteLength-e;return e=new qt(this.$m$,t,e,1),this.$K$.setUint8(t,34),e}sendTextInput(e){let t=0,i=new DataView(e,0,e.byteLength),n=new ArrayBuffer(1021);for(;t<e.byteLength;){let o;if(1016>=e.byteLength-t)o=e.byteLength-t;else{o=t+1016,s=!1;for(let e=0;4>e;e++){if(128!=(192&i.getUint8(o))){s=!0;break}o--}if(!s){d.e("{57a6a4d}","{938b0d3}");break}o-=t}var s=new DataView(n,0,o+5);s.setUint8(0,34),s.setUint32(1,23,!0),new Uint8Array(n).set(new Uint8Array(e,t,o),5),t+=o,Yt(this,s,!1)}}stop(){0<this.$A$.bufferedAmount&&d.w("{57a6a4d}","{5e5b9e5}",this.$A$.bufferedAmount)}get $S$(){return this.$h$}get $O$(){return this.$D$}$gamepadBitmapUpdateHandler$(e){Yt(this,e=ni(this,0,0,0,{},0,e))}$gamepadStateUpdateHandler$(e,t,i,n,s,o=0,r){2<this.$h$?(e=9+41*e,this.$s$.setUint8(e,33),this.$s$.setUint16(e+1,38),ii(this.$s$,e+3,t,i,n,s,o,r)):2==this.$h$?(e=1+40*e,this.$s$.setUint16(e,38),ii(this.$s$,e+2,t,i,n,s,o,r)):Yt(this,t=ni(this,i,n,t,s,o,r))}$virtualGamepadUpdateHandler$(e,t,i,n,s=0){Yt(this,e=ni(this,e,t,i,n,0,s))}$finalizeGamepadData$(e){if(!(2>this.$h$)){Yt(this);var t=null;2<this.$h$?t=new DataView(this.$s$.buffer,9,41*e):2==this.$h$&&(this.$s$.setUint8(0,255),t=new DataView(this.$s$.buffer,0,1+40*e)),t&&Yt(this,t)}}$connectUnsupportedGamepad$(){}$sendGamepadHapticsControl$(e){const t=this.$l$(6);t.setUint32(0,13,!0),t.setUint16(4,e?1:0,!1),Yt(this,t)}}(this,$,this.$h$,this.$g$,this.$s$,i,this.$ba$),this.$M$=new oi(this.$m$,this.$platformDetails$),this.$l$=new Ii(e,t,n,r,l,this.$M$,this.$h$,$,this.$j$,this.$C$),a?ut.$forceTouchCapable$||D()?(this.$B$=new class{constructor(e,t,i,n,s){this.target=e,this.videoAddEventListener=t,this.videoRemoveEventListener=i,this.$I$=n,this.$s$=s,this.$m$=this.$l$=0,this.$u$={$horizontal$:1,vertical:1},this.$g$=new Map,this.$o$=new Set,this.$j$=0,this.$h$=[],this.$v$=0,this.$G$=!0,this.$F$=e=>{const t=performance.now(),i=Bt(e.timeStamp);let n=!1;const s=e.changedTouches;let o=[];for(let i=0;i<s.length;i++){const a=s[i];if(a.target===this.target){n=!0,ct($t());var r=a;let i=0;for(;this.$o$.has(i);)i++;let s=new Ut(r,i);this.$g$.set(r.identifier,s),this.$o$.add(i),r=s,o.push(r),this.$storeTouch$(a,r,1,t,e)}}Ht(this,o,1,i),ut.$storeTouch$&&ut.$storeTouchGesture$&&8==this.$g$.size&&this.$G$&&(this.$A$(),this.$H$()),Di(this.$s$)&&n&&e.preventDefault()},this.$D$=e=>{const t=performance.now(),i=Bt(e.timeStamp);let n=!1;const s=e.changedTouches;let o=[];for(let i=0;i<s.length;i++){const r=s[i];if(r.target===this.target){let i=this.$g$.get(r.identifier);i&&(n=!0,i.update(r),o.push(i),this.$storeTouch$(r,i,4,t,e))}}Ht(this,o,4,i),Di(this.$s$)&&n&&e.preventDefault()},this.$B$=e=>{zt(this,e,8)},this.$C$=e=>{zt(this,e,2)},this.$A$=this.$K$.bind(this),this.$H$=this.$J$.bind(this)}$storeTouch$(e,t,i,n,s){ut.$storeTouch$&&this.$h$.push(new Gt(e,t.$g$,i,n,s.timeStamp))}$K$(){const e=this.$h$.length;if(e){var t=this.$h$[e-1].$g$-3e4,i=-1;for(let n=0;n<e&&this.$h$[n].$g$<t;n++)i=n;this.$h$.splice(0,i+1)}}$J$(){for(let e of this.$h$)d.d("{ec05004}","{3c6a946}",e.$j$.toFixed(2),e.$g$.toFixed(2),e.id,e.$h$,e.$u$,e.$l$.toFixed(2),e.$m$.toFixed(2),e.$o$.toFixed(0),e.$s$.toFixed(0));this.$h$=[]}start(){this.$j$=0;const e={passive:!1};this.videoAddEventListener("touchstart",this.$F$,e),this.videoAddEventListener("touchmove",this.$D$,e),this.videoAddEventListener("touchcancel",this.$B$,e),this.videoAddEventListener("touchend",this.$C$,e),ut.$storeTouch$&&(d.d("{ec05004}","{72764d2}",performance.now()),this.$h$=[],this.$v$=window.setInterval(this.$A$,6e4))}stop(){ut.$storeTouch$&&(this.$v$&&clearTimeout(this.$v$),this.$A$(),this.$H$()),this.$g$.size&&(Ht(this,Array.from(this.$g$.values()),8,performance.now()),this.$g$.clear(),this.$o$.clear()),this.$j$&&d.w("{ec05004}","{10858ae}",this.$j$);const e={passive:!1};this.videoRemoveEventListener("touchstart",this.$F$,e),this.videoRemoveEventListener("touchmove",this.$D$,e),this.videoRemoveEventListener("touchcancel",this.$B$,e),this.videoRemoveEventListener("touchend",this.$C$,e)}}(this.$m$,this.videoAddEventListener,this.videoRemoveEventListener,this.$j$,this),(H=this.$l$).$W$=!1,ui(H),d.i("{8bacfa5}","{60f3637}")):d.w("{8bacfa5}","{32104d3}"):d.i("{8bacfa5}","{6be89bf}"),!ut.$forceTouchCapable$&&!D()||x(this.$platformDetails$)||(this.$D$=new class{constructor(e,t,i,n){this.target=e,this.videoAddEventListener=t,this.videoRemoveEventListener=i,this.$j$=n,this.$h$=[],this.$g$=this.$m$=this.$l$=0,this.$v$=e=>{let t=!1;const i=e.changedTouches,n=Bt(e.timeStamp);for(let e=0;e<i.length;e++){const s=i[e];s.target===this.target&&(t=!0,ct($t()),0===this.$h$.length?(this.$g$=1,this.$l$=window.setTimeout((()=>{var e,t,i,o;this.$l$=0,1===this.$m$&&(this.$g$=2,ut.$advancedGestures$&&(e=this.$j$,t=this.target,i=n,o=Nt(s),1===e.$g$.$zoomFactor$&&(Xi(e,t,o,i),e.$I$.delay((()=>{pi(e.$l$,0,i)})))))}),500)):1!==this.$g$&&(2===this.$g$||4===this.$g$?ut.$advancedGestures$&&ji(this.$j$,n):6===this.$g$&&ut.$advancedGestures$&&Ri(this.$j$),this.$g$=0),this.$h$.push(Nt(s)),this.$h$.length>this.$m$&&(this.$m$=this.$h$.length))}Di(this.$j$)&&t&&e.preventDefault()},this.$u$=e=>{let t=!1;for(i of this.$h$)i.deltaX=0,i.deltaY=0;var i=e.changedTouches;const n=Bt(e.timeStamp);let s=[];for(let e=0;e<i.length;e++){const n=i[e],a=this.$h$.findIndex((e=>e.identifier==n.identifier));if(-1!=a){t=!0;var o=this.$h$[a],r=n.clientX-o.clientX;o=n.clientY-o.clientY;let e=!1;0!==this.$l$?(10<Math.abs(r)||10<Math.abs(o))&&(window.clearTimeout(this.$l$),this.$l$=0,e=!0):e=!0,e&&(r={identifier:n.identifier,clientX:n.clientX,clientY:n.clientY,deltaX:r,deltaY:o},s.push(a),this.$h$[a]=r)}}var a,$,c,d;0<s.length&&0===this.$l$&&0!==this.$g$&&(1===this.$h$.length?(1===this.$g$?this.$g$=3:2===this.$g$&&(this.$g$=4),ut.$advancedGestures$&&(a=this.$j$,$=this.target,c=n,d=this.$h$[0],1!==a.$g$.$zoomFactor$||a.$isVirtualKeyboardVisible$||void 0!==a.$B$?Ni(a,a.$g$.offsetX+d.deltaX,a.$g$.offsetY+d.deltaY,a.$g$.$zoomFactor$):Xi(a,$,d,c))):2===this.$h$.length?5===this.$g$?ut.$advancedGestures$&&this.$j$.scroll(this.target,n,this.$h$):6===this.$g$?ut.$advancedGestures$&&xi(this.$j$,this.$h$):1===this.$g$&&(0<this.$h$[0].deltaY*this.$h$[1].deltaY&&(Math.sign(this.$h$[0].deltaX)===Math.sign(this.$h$[1].deltaX)||10>Math.abs(this.$h$[0].deltaX)&&10>Math.abs(this.$h$[1].deltaX))?(this.$g$=5,ut.$advancedGestures$&&this.$j$.scroll(this.target,n,this.$h$)):(this.$g$=6,ut.$advancedGestures$&&xi(this.$j$,this.$h$))):this.$g$=0),Di(this.$j$)&&t&&e.preventDefault()},this.$o$=e=>{Ft(this,e,!1)},this.$s$=e=>{Ft(this,e,!0)}}start(){const e={passive:!ut.$advancedGestures$};this.videoAddEventListener("touchstart",this.$v$,e),this.videoAddEventListener("touchmove",this.$u$,e),this.videoAddEventListener("touchcancel",this.$o$,e),this.videoAddEventListener("touchend",this.$s$,e)}stop(){if(this.videoRemoveEventListener("touchstart",this.$v$),this.videoRemoveEventListener("touchmove",this.$u$),this.videoRemoveEventListener("touchcancel",this.$o$),this.videoRemoveEventListener("touchend",this.$s$),this.$h$=[],0!==this.$l$&&(window.clearTimeout(this.$l$),this.$l$=0),this.$m$=0,ut.$advancedGestures$)switch(this.$g$){case 6:Ri(this.$j$);break;case 2:case 4:ji(this.$j$,performance.now())}this.$g$=0}}(this.$m$,this.videoAddEventListener,this.videoRemoveEventListener,this)),this.$$$=o,this.$S$=0,this.$va$=E(this.$platformDetails$),this.$aa$=_(this.$platformDetails$),this.$da$=T(this.$platformDetails$),this.$A$="Android"===this.$platformDetails$.os,this.$va$?(d.d("{8bacfa5}","{da5ae1d}"),this.$P$=[20,144,145]):this.$aa$||"Linux"===this.$platformDetails$.os?(d.d("{8bacfa5}","{b7becf9}"),this.$P$=[]):(d.d("{8bacfa5}","{098ce9c}"),this.$P$=[20]),this.$O$=this.$R$=!1,this.$F$={$rafTime$:0,droppedVideoFrames:0,totalVideoFrames:0},PerformanceObserver?this.perf=new PerformanceObserver((e=>{return t=this,void e.getEntriesByType("longtask").forEach((e=>{let i=Math.round(e.duration);var n,s=vt;s.$h$&&(e={duration:{timestamp:e.startTime-s.$j$,duration:i}},s.$g$&&s.$g$.postMessage(e)),null===(n=t.$s$.$h$)||void 0===n||((s=n.$g$).$B$=Math.max(i,s.$B$)),d.i("{8bacfa5}","{7071359}",i)}));var t})):this.perf=null,ls(this.$C$,2,this.$ka$),d.d("{8bacfa5}","{cc9c05b}"),window.ResizeObserver?(this.$ua$=new ResizeObserver((()=>{this.$T$()})),this.$ua$.observe(this.$m$)):this.windowAddEventListener("resize",this.$U$),(w(l)||"Tizen"===l.os)&&window.IntersectionObserver&&(this.$na$=new IntersectionObserver((()=>{this.$T$()}),{threshold:[1]}),this.$na$.observe(this.$m$)),this.$m$.addEventListener("resize",this.$U$),(e=window.visualViewport)&&(this.$g$.$viewportHeight$=e.height,e.addEventListener("resize",this.$xa$)),this.$o$=c,z=this.$o$,W=this.$j$,z.$o$&&(Co(z,z.$o$),Do(z,z.$o$)),z.$o$=W,z.$l$.push(z.$o$),this.$j$.$C$.push(this.$o$),K=this.$o$,J=this.$M$,ut.$rsdmm$&&(K.$m$&&Co(K,K.$m$),K.$m$=J),this.$o$.$I$=this.$ba$,this.$la$(this.$C$.$j$),ls(this.$C$,0,this.$ha$),this.perf&&PerformanceObserver.supportedEntryTypes&&PerformanceObserver.supportedEntryTypes.includes("longtask")&&this.perf.observe({entryTypes:["longtask"]}),ut.$latencyTest$&&$t().initialize(this.$m$,this.$platformDetails$),(x(this.$platformDetails$)||this.$A$||w(this.$platformDetails$))&&(this.textInputElement=m,this.$A$&&(this.$ia$=null!==(N=null===(B=this.textInputElement)||void 0===B?void 0:B.getAttribute("autocapitalize"))&&void 0!==N?N:"off",this.$ja$=null!==(V=null===(F=this.textInputElement)||void 0===F?void 0:F.getAttribute("autocorrect"))&&void 0!==V?V:"off",null===(U=this.textInputElement)||void 0===U||U.setAttribute("autocapitalize","off"),null===(G=this.textInputElement)||void 0===G||G.setAttribute("autocorrect","off")))}uninitialize(){var e,t,i,n,s,o,r;Li(this,!1);var a=this.$m$.paused;if(a=void 0!==a?a?"paused":"playing":"unknown",(this.$m$.paused||1>(null!==(e=this.$m$.currentTime)&&void 0!==e?e:1))&&this.$ba$.$emitDebugEvent$("VideoPaused",a,null===(t=this.$m$.currentTime)||void 0===t?void 0:t.toFixed(2)),d.i("{8bacfa5}","{fdc8bf7}",a,this.$m$.currentTime),null===(i=this.$na$)||void 0===i||i.disconnect(),null===(n=this.$ua$)||void 0===n||n.disconnect(),this.$j$.stop(),this.perf&&this.perf.disconnect(),this.toggleUserInput(!1),this.windowRemoveEventListener("resize",this.$U$),this.$m$.removeEventListener("resize",this.$U$),null===(s=window.visualViewport)||void 0===s||s.removeEventListener("resize",this.$xa$),(e=this.$o$).$j$){for($ of(t=!0,e.$h$))$&&($.$telemetryData$.state=Mo(e,$.$telemetryData$.state,!0),Uo(e,$.$device$.index,!0,t),t=!1);Io(e),e.$j$=0,e.$g$.$v_connected$=!1,e.$gamepadBitmapUpdateHandler$(),e.gamepadPollInterval=100,jo(e),e.$h$=[],e.$J$=!1}var $=this.$j$;-1<(e=$.$C$.indexOf(this.$o$))&&$.$C$.splice(e,1),us(this.$C$,2,this.$ka$),this.$M$.stop(),Co(this.$o$,this.$M$),Co(this.$o$,this.$j$),this.$gamepadTesterEnabled$&&(Co(this.$o$,this.$K$),bo(this.$K$,this.$m$)),this.$l$.uninitialize(),us(this.$C$,0,this.$ha$),Oi(this),null===(o=this.textInputElement)||void 0===o||o.setAttribute("autocapitalize",this.$ia$),null===(r=this.textInputElement)||void 0===r||r.setAttribute("autocorrect",this.$ja$),d.d("{8bacfa5}","{b6b2756}")}$Aa$(){if(function(){var e=vt;if(e.$h$){if(0!=e.perf.RAFTS){const t={perf:e.perf};e.$g$&&e.$g$.postMessage(t),pt(e)}e.perf.RAFTS=ft(e)}}(),!ut.$leanMode$){const o=window.performance.now(),r=(e=this.$m$).getVideoPlaybackQuality?{$decoded$:(e=e.getVideoPlaybackQuality()).totalVideoFrames,$dropped$:e.droppedVideoFrames}:void 0!==e.webkitDecodedFrameCount?{$decoded$:e.webkitDecodedFrameCount,$dropped$:null!==(t=e.webkitDroppedFrameCount)&&void 0!==t?t:0}:void 0;if(r){const e=r.$dropped$,t=e-this.$F$.droppedVideoFrames,o=r.$decoded$-this.$F$.totalVideoFrames;this.$F$.droppedVideoFrames=e,this.$F$.totalVideoFrames=r.$decoded$,1==t?this.$h$.$singleDroppedFrames$++:1<t&&(this.$h$.$multiDroppedFrames$+=t),i=o,n=t,(s=vt).$h$&&(s.perf.FrameInfo=Math.min(i,15)<<4|Math.min(n,15))}this.$F$.$rafTime$=o}var e,t,i,n,s;window.setTimeout((()=>{this.$ea$&&window.requestAnimationFrame(this.$ta$);var e=this.$l$;0===e.$F$&&Yt(e.$m$),ut.$gamepadEnabled$&&ut.$gamepadRaf$&&this.$o$.$W$(),ut.$leanMode$||((e=window.performance.now())>this.$h$.$baseTime$+1e4?(0!==this.$h$.$baseTime$&&d.i("{8bacfa5}","{5fa9066}",this.$h$.$animationFrameCount$,this.$h$.$sendInputCount$,this.$h$.$sendInputOver5ms$,this.$h$.$sendInputOver10ms$,this.$F$.totalVideoFrames-this.$h$.$baseTotalVideoFrames$,this.$h$.$singleDroppedFrames$,this.$h$.$multiDroppedFrames$,this.$h$.$aggregatedCount$,this.$h$.$oversizedEventCount$),this.$h$.$baseTime$=e,this.$h$.$baseTotalVideoFrames$=this.$F$.totalVideoFrames,this.$h$.$animationFrameCount$=1,this.$h$.$sendInputCount$=0,this.$h$.$sendInputOver5ms$=0,this.$h$.$sendInputOver10ms$=0,this.$h$.$singleDroppedFrames$=0,this.$h$.$multiDroppedFrames$=0,this.$h$.$aggregatedCount$=0,this.$h$.$oversizedEventCount$=0):this.$h$.$animationFrameCount$+=1)})),function(e){if(e.$h$.$dirty$&&(e.$h$.$dirty$=!1,e.$l$))if(e.$W$&&e.$g$.$absPositioning$){if(o=vi(e),e.$l$){var t=e.$h$.$dpiRatio$,i=t/e.$g$.scale,n=1.499<=i&&1.999>i?2:Math.max(1,Math.floor(i+.001)),s=n/t;i=(e.$g$.$absX$*e.$j$.$zoomFactor$+e.$j$.offsetX-o.$horizontal$-e.$g$.$hotspotX$*s+e.$j$.$leftPadding$)*t;var o=(e.$g$.$absY$*e.$j$.$zoomFactor$+e.$j$.offsetY-o.vertical-e.$g$.$hotspotY$*s+e.$j$.$topPadding$)*t;if(e.$P$||(i=Math.round(i),o=Math.round(o)),i/=t,o/=t,e.$h$.$imageChanged$&&e.$g$.image){e.$h$.$imageChanged$=!1,s=e.$g$.width*n,n*=e.$g$.height;const i=e.$h$.$graphicsContext$;i.clearRect(0,0,e.$l$.width,e.$l$.height),e.$h$.$imageDimensionsChanged$&&(e.$h$.$imageDimensionsChanged$=!1,e.$l$.style.width=s/t+"px",e.$l$.style.height=n/t+"px",e.$l$.width=Math.ceil(s),e.$l$.height=Math.ceil(n),i.scale(1,1),i.imageSmoothingEnabled=!1),i.drawImage(e.$g$.image,0,0,s,n)}e.$h$.$showing$||(e.$h$.$showing$=!0,e.$l$.style.visibility="visible"),e.$l$.style.transform="translate("+i+"px, "+o+"px)"}}else wi(e,e.$l$)}(this.$l$)}$virtualGamepadUpdateHandler$(){Zt(this.$j$)&&this.$o$.$virtualGamepadUpdateHandler$()}$T$(){var e,t=this.$m$;if(!(0>=t.videoWidth||0>=t.videoHeight)){var i=0,n=0,s=t.clientWidth/t.clientHeight,o=t.videoWidth/t.videoHeight;if(!(.01>Math.abs(s-o))&&s>o){s=t.clientHeight/t.videoHeight,o=t.videoWidth*s;var r=t.videoHeight*s;n=(t.clientWidth-o)/2}else s=t.clientWidth/t.videoWidth,o=t.videoWidth*s,r=t.videoHeight*s,i=(t.clientHeight-r)/2;var a=1,$=1;this.$g$.$displayVideoWidth$&&this.$g$.$displayVideoHeight$&&(a=o/this.$g$.$displayVideoWidth$,$=r/this.$g$.$displayVideoHeight$),this.$g$.$displayVideoWidth$=o,this.$g$.$displayVideoHeight$=r,this.$g$.$scalingFactor$=s,this.$g$.$topPadding$=i,this.$g$.$leftPadding$=n,this.$g$.videoWidth=t.videoWidth,this.$g$.videoHeight=t.videoHeight,Ni(this,this.$g$.offsetX*a,this.$g$.offsetY*$,this.$g$.$zoomFactor$),bi(this.$l$,this.$g$),t=this.$N$,i=this.$g$.$leftPadding$,t.$topPadding$=this.$g$.$topPadding$,t.$leftPadding$=i,Ui(this)}null===(e=this.$B$)||void 0===e||(t=this.$g$,n=this.$m$.getBoundingClientRect(),i=this.$g$.$zoomFactor$,e.$u$={$horizontal$:n.left+window.pageXOffset+this.$g$.$leftPadding$*this.$g$.$zoomFactor$,vertical:n.top+window.pageYOffset+this.$g$.$topPadding$*this.$g$.$zoomFactor$},e.$l$=65535/t.$displayVideoWidth$,e.$m$=65535/t.$displayVideoHeight$,e.$l$/=i,e.$m$/=i)}$Fa$(){this.$g$.$viewportHeight$=window.visualViewport.height,Ni(this,this.$g$.offsetX,this.$g$.offsetY,this.$g$.$zoomFactor$)}$Ca$(){d.d("{8bacfa5}","{b6fbd34}"),history.pushState(null,document.title,location.href)}$oa$(e){var t,i;let n=!1;this.$fa$=!1;const s=Bt(e.timeStamp);if(this.$C$.$h$){(function(e,t){var i;if(null!==(i=bs(e.$s$))&&void 0!==i&&i.isVisible())return!1;if(e.$aa$)switch(t.code){case"Tab":return!t.altKey;case"ZoomToggle":case"SelectTask":case"BrightnessDown":case"BrightnessUp":case"AudioVolumeMute":case"AudioVolumeDown":case"AudioVolumeUp":return!1}return!0})(this,e)&&e.preventDefault();var o,r=!(!this.$da$||!this.$W$)&&"CapsLock"==e.code;r&&(n=n||r),Bi(this,e),!(o="CapsLock"==e.code&&("Alphanumeric"==e.key||"Katakana"==e.key||"Hiragana"==e.key))&&(o="KanaMode"==e.code)&&(o="Hiragana"==(o=e.key)||"Katakana"==o||"Romaji"==o||"KanaMode"==o),o=!!o;var a="Lang1"==e.code||"HangulMode"==e.key;if(n=n||o||a,(!this.$P$.includes(e.keyCode)||o||r)&&0!==(r=r?160:Fi(this,e))&&!this.$u$.has(r)){if(this.$u$.add(r),o=!1,a=bs(this.$s$),187==r){var $;if(null===($=(o=this.$s$).$I$)||void 0===$)var c=0;else 1==$.$g$?(d.i("{4c846ba}","{1f67b97}"),$.$g$=2,c=!0):c=!1;c?(Ls(o,{latencyTrigger:!0}),o=!0):o=!1,o=!o}else if(e.ctrlKey&&e.altKey)if(!ut.isInternalUser&&!ut.stutterIndicator||119!=r&&219!=r)if(ut.isInternalUser)switch(r){case 48:if($="UNSUPPORTED",(c=this.$l$).$L$)switch(di(c,(c.$F$+1)%4),c.$F$){case 1:$="4ms";break;case 2:$="8ms";break;case 3:$="16ms";break;default:$="OFF"}ws(c.$I$,"Non-vsync mouse events: "+$),d.i("{70cc40b}","{bac28ff}",$);break;case 49:(c=this.$s$).$ga$^=1,Ls(c,{riDeviceOverlay:{bitmap:c.$ga$}});break;case 56:this.$s$.sendCustomMessage({messageType:"GpuViewStartRequest",messageRecipient:"GPUViewTraceControl",data:"GpuView"}),d.i("{93c7910}","{0915cd3}");break;case 68:var l;null===(l=(c=this.$s$).$I$)||void 0===l?$=0:0==l.$g$?(l.$g$=1,d.i("{4c846ba}","{008dc86}"),qo(l),Xo(l),$=!0):$=!1,$&&Ls(c,{pcmDumpTrigger:!0});break;case 71:this.$gamepadTesterEnabled$=!this.$gamepadTesterEnabled$,bo(this.$K$,this.$m$),this.$gamepadTesterEnabled$?this.$o$.$l$.push(this.$K$):Co(this.$o$,this.$K$);break;case 76:null==a||Tn(a,!a.isVisible()),ui(this.$l$);break;case 83:ds(this.$N$);break;case 115:(c=this.$s$).$ea$?(mt(),c.$ea$=!1,Hs(c),ws(c,"Profiler: OFF, Stats: OFF")):(Ms(c),zs(c),ws(c,"Profiler: ON, Stats: ON"));break;case 116:Gs(c=this.$s$)?(Hs(c),ws(c,"Stats: OFF")):(zs(c),ws(c,"Stats: ON"));break;case 117:this.$s$.toggleOnScreenStats(e.shiftKey);break;case 118:case 192:(c=this.$s$).perfIndicator=!c.perfIndicator,Ls(c,{perfIndicator:{on:c.perfIndicator}});break;case 120:(c=this.$l$).$u$=!c.$u$,ws(c.$I$,"UnadjustedMovement: "+(c.$u$?"ON":"OFF")),d.i("{70cc40b}","{796c5cb}",c.$u$?"ON":"OFF");break;case 189:this.$L$=!this.$L$,ws(this.$s$,"Position dependent keys: "+(this.$L$?"ON":"OFF")),d.i("{8bacfa5}","{61d2ab5}",this.$L$?"ON":"OFF");break;default:o=!0}else o=!0;else this.$s$.toggleStutterIndicator();else if(null!=a&&a.isVisible())if(13==r)a.toggle(),ui(this.$l$);else if(82==r)a.reset(),ui(this.$l$);else if(65==r)_n(a,!a.$autoFireCheckbox$.checked);else if(83==r)if(a.$latencyData$.length){$=`LDAT_${(new Date).toISOString()}.csv`,l=["Sample #,Total,Render,Decode,Begin,Server + Rtd + Receive,Input Callback"];for(let e=0;e<a.$latencyData$.length;e++){const t=a.$latencyData$[e],i=null!==(c=t.processingDuration)&&void 0!==c?c:"";l.push([e,t.$videoFrameCallbackTime$-t.$mouseClickTime$,t.$videoFrameCallbackTime$-t.presentationTime,i,t.receiveTime&&t.processingDuration?t.presentationTime-t.processingDuration-t.receiveTime:"",t.receiveTime?t.receiveTime-t.$mouseClickCallbackTime$:"",t.$mouseClickCallbackTime$-t.$mouseClickTime$].join())}xt([l.join("\n")],$,"text/plain")&&d.i("{50c79eb}","{690879e}",$)}else d.w("{50c79eb}","{2884507}");else 67==r?(d.i("{50c79eb}","{d2811a7}"),a.$loupePositionX$.value="50",a.$loupePositionY$.value="50",Dn(a,.5,.5)):o=!0;else o=!0;o&&(ct($t()),ti(this.$j$,3,r,Vi(this,e),s)),"Hankaku"!=e.key&&"Zenkaku"!=e.key||192!=r||(n=!0),this.$A$&&this.$isVirtualKeyboardVisible$&&("Backspace"==e.code&&(n=!0),""==e.code&&"Enter"==e.key&&(o=new CompositionEvent("compositionend",{data:null===(t=this.textInputElement)||void 0===t?void 0:t.value}),null===(i=this.textInputElement)||void 0===i||i.dispatchEvent(o))),n&&(ti(this.$j$,4,r,Vi(this,e),s),this.$u$.delete(r))}}}$qa$(e){let t=!1;const i=Bt(e.timeStamp);if(this.$A$&&this.$isVirtualKeyboardVisible$&&""==e.code&&"Unidentified"==e.key&&!this.$fa$)ti(this.$j$,3,8,0,i),ti(this.$j$,4,8,0,i);else{var n=!(!this.$da$||!this.$W$)&&"CapsLock"==e.code;n&&(t=t||n),Bi(this,e),this.$P$.includes(e.keyCode)&&!n||(n=n?160:Fi(this,e),t&&(ti(this.$j$,3,n,Vi(this,e),i),this.$u$.add(n)),this.$u$.has(n)&&(this.$u$.delete(n),ct($t()),ti(this.$j$,4,n,Vi(this,e),i)))}}$la$(e){d.d("{8bacfa5}","{77df54c}",e?"fullscreen":"not fullscreen"),this.$T$({}),e?(window.isSecureContext&&(e=window.navigator.keyboard)&&e.lock&&e.lock("Escape F11 BrowserBack BrowserForward BrowserRefresh BrowserHome BrowserFavorites BrowserSearch BrowserStop Sleep Power WakeUp KeyT KeyZ Slash Digit1 Digit2 Digit3 Digit4 Digit5 Digit6 Digit7 Digit8 Digit9 KeyM KeyD KeyN KeyS KeyK KeyL Space PrintScreen LaunchApp1 LaunchApp2 LaunchMail Comma Semicolon ArrowLeft ArrowRight BracketLeft BracketRight KeyW KeyQ KeyR KeyY KeyO KeyP KeyF KeyG".split(" ")),this.$m$.onclick=null,this.$m$.removeAttribute("controls")):(Gi(this),_i(this.$l$),window.isSecureContext&&(e=window.navigator.keyboard)&&e.unlock&&e.unlock())}toggleUserInput(e,t){if(d.d("{8bacfa5}","{2424824}",e,t),t=null!=t?t:15,e){var i,n,s,o,r=!this.$isUserInputEnabled$();if(c=(this.$v$^t)&t){if(this.$v$|=c,r&&(this.$ea$=!0,window.requestAnimationFrame(this.$ta$)),4&c&&_o(this.$o$),1&c){var a=this.$l$;if(!a.$A$){if(a.$A$=!0,!w(a.$platformDetails$))if(2==a.cursorType&&a.$G$){var $=a.$H$;$.$downName$="pointerdown",$.$upName$="pointerup",a.videoAddEventListener("pointerdown",a.$la$),a.videoAddEventListener("pointerup",a.$ma$)}else($=a.$H$).$downName$="mousedown",$.$upName$="mouseup",a.videoAddEventListener("mousedown",a.$U$),a.videoAddEventListener("mouseup",a.$da$);(2!==a.cursorType?a.documentAddEventListener:a.videoAddEventListener)("wheel",a.$ea$,a.$fa$),Ci(a),a.$l$&&(a.$l$.style.display="block",a.$s$.style.cursor="none"),ui(a)}}2&c&&(this.documentAddEventListener("keydown",this.$pa$),this.documentAddEventListener("keyup",this.$ra$),null===(i=this.textInputElement)||void 0===i||i.addEventListener("input",this.$wa$),null===(n=this.textInputElement)||void 0===n||n.addEventListener("compositionstart",this.$J$),null===(s=this.textInputElement)||void 0===s||s.addEventListener("compositionupdate",this.$J$),null===(o=this.textInputElement)||void 0===o||o.addEventListener("compositionend",this.$J$),this.$H$=0),8&c&&(this.$B$&&!this.$isVirtualKeyboardVisible$?this.$B$.start():this.$D$&&this.$D$.start()),r&&this.preventNavigation&&!this.$O$&&(this.$O$=!0,history.pushState(null,document.title,location.href),this.windowAddEventListener("popstate",this.$sa$))}}else{var c;(n=this.$v$&t)&&(this.$v$^=n,(i=!this.$isUserInputEnabled$())&&(this.$ea$=!1),4&n&&((s=this.$o$).$v$=!1,Ho(s),ut.$gamepadEnabled$&&(s.$o$&&Do(s,s.$o$),s.windowRemoveEventListener("gamepadconnected",s.$U$),s.windowRemoveEventListener("gamepaddisconnected",s.$V$),jo(s),s.$u$&&(s.$m$.stop(),s.$m$.reset()))),1&n&&(s=this.$l$).$A$&&(_i(s),s.$A$=!1,w(s.$platformDetails$)||(2==s.cursorType&&s.$G$?(s.videoRemoveEventListener("pointerdown",s.$la$),s.videoRemoveEventListener("pointerup",s.$ma$)):(s.videoRemoveEventListener("mousedown",s.$U$),s.videoRemoveEventListener("mouseup",s.$da$))),(2!==s.cursorType?s.documentRemoveEventListener:s.videoRemoveEventListener)("wheel",s.$ea$,s.$fa$),Ei(s),s.$l$&&(s.$l$.style.display="none",s.$s$.style.cursor="default"),ui(s)),2&n&&(Gi(this),this.documentRemoveEventListener("keydown",this.$pa$),this.documentRemoveEventListener("keyup",this.$ra$),null===(r=this.textInputElement)||void 0===r||r.removeEventListener("input",this.$wa$),null===(a=this.textInputElement)||void 0===a||a.removeEventListener("compositionstart",this.$J$),null===(c=this.textInputElement)||void 0===c||c.removeEventListener("compositionupdate",this.$J$),null===($=this.textInputElement)||void 0===$||$.removeEventListener("compositionend",this.$J$)),8&n&&(this.$D$&&this.$D$.stop(),this.$B$&&this.$B$.stop(),0!==this.$G$&&Hi(this),(n=this.$I$).$h$=void 0,tn(n)),i&&this.preventNavigation&&this.$O$&&(this.windowRemoveEventListener("popstate",this.$sa$),history.back(),this.$O$=!1))}}$isUserInputEnabled$(){return 0!==this.$v$}$za$(e){e?(Ui(this),d.d("{8bacfa5}","{cb19d31}")):(d.d("{8bacfa5}","{8744dbe}"),Gi(this),_i(this.$l$))}$Ba$(){this.$R$&&zi(this)}getVirtualGamepadHandler(){return this.$o$.getVirtualGamepadHandler()}sendTextInput(e){this.$j$.sendTextInput(e)}$Da$(e){switch(e.type){case"compositionstart":this.$H$=1;break;case"compositionupdate":!w(this.$platformDetails$)&&Ji(e.data)||this.$$$.emit("TextComposition",{compositionText:e.data,imeRecommendation:!0});break;case"compositionend":const t=this.$A$?e.data.trim():e.data;t.length&&(e=w(this.$platformDetails$)||!Ji(e.data),this.$A$&&!e?qi(this,t):Ki(this,t),e&&this.$$$.emit("TextComposition",{compositionText:""})),this.$H$=0}}$Ea$(){this.$fa$=!0;let e=this.textInputElement.value;1==this.$H$&&(this.$A$&&1<e.length&&(e=e.charAt(e.length-1)),this.$H$=2),this.$A$&&Ji(e)?(qi(this,e),this.$H$=0):2!=this.$H$&&Ki(this,e)}setVirtualKeyboardState(e){d.i("{8bacfa5}","{60b2d45}",e),this.$isVirtualKeyboardVisible$!==e&&(this.$isVirtualKeyboardVisible$=e,this.$D$&&this.$B$&&(this.$isVirtualKeyboardVisible$?(this.$B$.stop(),this.$D$.start()):(this.$D$.stop(),1!==this.$g$.$zoomFactor$&&Ni(this,0,0,1),this.$B$.start())))}setKeyboardLayout(e){this.$W$="zh-TW"==e}scroll(e,t,i){0<i.length&&Xt(this.$j$,Math.sign(i[0].deltaY),t)}sendKeyEvent(e){Zt(this.$j$)&&(Fi(this,e)?"keydown"===e.type?this.$oa$(e):"keyup"===e.type&&this.$qa$(e):"keydown"===e.type&&1===e.key.length&&(e=(new TextEncoder).encode(e.key),this.sendTextInput(e.buffer)))}};function en(e){e.$j$=!0,tn(e),nn(e),e.$j$=!1}function tn(e){0!==e.$g$&&(window.clearTimeout(e.$g$),e.$g$=0)}function nn(e){const t=e.$h$;t&&(e.$h$=void 0,t())}class sn{constructor(){this.$g$=0,this.$j$=!1}delay(e){this.$j$?e():(en(this),this.$h$=e,this.$g$=window.setTimeout((()=>{this.$g$=0,nn(this)}),on))}}var on=30;function rn(e){return e.qualityScore=3*e.qualityScore/4+Math.min(e.latencyScore,e.networkLossScore,e.bandwidthScore)/4,{latencyScore:e.latencyScore,networkLossScore:e.networkLossScore,bandwidthScore:e.bandwidthScore,qualityScore:e.qualityScore}}var an=class{constructor(e){this.maxBitrate=e/1e3,this.networkLossScore=this.bandwidthScore=this.latencyScore=this.qualityScore=100}};function $n(e){const t=e.$j$-e.$g$;return 0!=t?(e.$l$-e.$h$)/t:0}class cn{constructor(){this.$j$=this.$g$=this.$l$=this.$h$=0}update(e,t){0==this.$h$&&0==this.$g$?(this.$h$=e,this.$g$=t):(this.$j$=t,this.$l$=e)}reset(){this.$h$=this.$l$,this.$g$=this.$j$}}function dn(e,t){var i,n=`Seat: ${e.$h$.zoneName} (${e.$h$.$requestedRegion$}) / ${e.$h$.gpuType}\n`,s=`Game: CMS ${e.$h$.appId}`;void 0!==e.avgGameFps&&(s+=` / fps ${e.avgGameFps.toFixed()}`);var o=`Stream: Current ${Dt(e.streamingResolution)}@${e.fps} / Default: ${e.$h$.streamInfo.width}x${e.$h$.streamInfo.height}@${e.$h$.streamInfo.fps} / Codec ${null!==(i=e.codec)&&void 0!==i?i:""}\n`;i=n+(s+"\n")+o+`Network: RTD ${e.rtd}ms / FL ${e.$u$} / PL ${e.$C$} / J ${e.$D$.toFixed(2)}ms / Bitrate ${e.$s$.toFixed(2)}Mbps / BWU ${e.$bwu$.toFixed(2)}%\n`+`QOS: frame ${e.$A$} / FT ${e.$H$.toFixed(2)} / D ${(1e3*$n(e.$m$)).toFixed(2)} / Q ${Math.floor(e.$o$.qualityScore)}\n`+`Client: ${e.$platformDetails$.os} ${e.$h$.clientAppVersion} ${e.$h$.clientLocale} Resolution ${Dt({width:window.innerWidth*window.devicePixelRatio,height:window.innerHeight*window.devicePixelRatio})}\n`+`Input ${e.$g$.$inputMode$}\n`,n=`DC ${un(e.$j$)}ms (${e.$j$.max.toFixed(2)}ms) / Blocked ${e.$B$}\n`,s=`Stats ${un(e.$l$)}ms (${e.$l$.max.toFixed(2)}ms) / FR ${e.$G$} / FDR ${e.$F$}\n`,o=`Latency ${e.$o$.latencyScore.toFixed(1)} / Network ${e.$o$.networkLossScore.toFixed(1)} / Bandwidth ${e.$o$.bandwidthScore.toFixed(1)}\n`;const r=`VP ${e.$g$.$isVideoElementPaused$?"y":"n"} / AP ${e.$g$.$isAudioElementPaused$?"y":"n"} / UI ${e.$g$.$isUserInputEnabled$?"y":"n"} / VKB ${e.$g$.$isVirtualKeyboardVisible$?"y":"n"} / MS ${e.$g$.$micState$} / RSDMM ${+e.$g$.$isRsdmmActive$}\n`,a=`KBL ${e.$g$.keyboardLayout} / ALM ${+e.$g$.appLaunchMode} / SWD ${e.$L$?"y":"n"} / ${e.$decoder$}`;t&&(i+=n+s+o+r+a),e.$J$.innerText=i,e.$j$={value:0,count:0,max:0},e.$l$={value:0,count:0,max:0},e.$m$.reset()}var ln=class{constructor(e,t,i){this.$s$=this.fps=0,this.$bwu$=4,this.$C$=this.rtd=this.$D$=this.$F$=this.$G$=this.$A$=this.$I$=this.$v$=0,this.streamingResolution={width:0,height:0},this.$B$=this.$H$=0,this.$j$={count:0,max:0,value:0},this.$l$={count:0,max:0,value:0},this.$m$=new cn,this.$K$=this.$u$=this.$cumulativeAvgDecodeTime$=0,this.$L$=!1,this.$decoder$="",this.$videoElement$=e,this.$platformDetails$=t,this.$h$=i,this.$o$={qualityScore:0,bandwidthScore:0,networkLossScore:0,latencyScore:0},(e=document.getElementById("overlay-543d9968"))||((e=document.createElement("div")).id="overlay-543d9968",e.style.display="none",e.style.position="fixed",w(this.$platformDetails$)?(e.style.top="env(safe-area-inset-top, 0)",e.style.left="max(24px, env(safe-area-inset-left, 0))"):(e.style.top="0",e.style.left="0"),e.style.padding="0.5em",e.style.backgroundColor="rgba(0,0,0,0.5)",e.style.zIndex="300",e.style.fontSize="12px",e.style.fontFamily="monospace",e.style.color="white",e.style.whiteSpace="pre",e.style.lineHeight="100%",e.style.pointerEvents="none",this.$videoElement$.insertAdjacentElement("afterend",e)),this.$J$=e,this.$g$={$isVideoElementPaused$:!1,$isAudioElementPaused$:!1,$isUserInputEnabled$:!1,$isVirtualKeyboardVisible$:!1,$micState$:0,$isRsdmmActive$:!1,keyboardLayout:"",appLaunchMode:0,$inputMode$:""}}};function un(e){let t=0;return 0<e.count&&(t=e.value/e.count),t.toFixed(2)}var hn={size:70,version:1,name:"DEPR"},pn={size:80,version:3,name:"RTPV"},mn={size:48,version:1,name:"RTPA"},fn={size:88,version:1,name:"TRAA"},gn={size:20,version:1,name:"PFDA"};function vn(e){0<e.$g$.length&&(gt(e.$g$,5),e.$g$=[])}function An(e){let t=0;return null!=e&&e.supported&&(t|=1),null!=e&&e.smooth&&(t|=2),null!=e&&e.powerEfficient&&(t|=4),t}function bn(e,t=1920,i=1080,n=60){const s=navigator.mediaCapabilities;return s?s.decodingInfo({type:"webrtc",video:{contentType:"video/"+e,width:t,height:i,framerate:n,bitrate:1e3*At(t,i,n)}}).catch((t=>{d.w("{5083445}","{f5c2155}",e,t)})):Promise.resolve(void 0)}function wn(){var e=yn;return e.$l$?Promise.resolve(e.$l$):e.$g$?e.$g$:e.$m$()}function Sn(e,t){return t&&(e.refreshRate=void 0),e.refreshRate?Promise.resolve(e.refreshRate):e.$j$?e.$j$:((i=e).$j$=new Promise(((e,t)=>{let i=!1;const n=window.setTimeout((()=>{i=!0}),4e3),s=[];let o,r=window.innerWidth,a=window.innerHeight,$=window.screenX,c=window.screenY;const l=()=>{window.requestAnimationFrame((()=>{if(i)d.w("{5083445}","{0b0c6f9}","Timed out during the refreshRate loop"),window.clearTimeout(n),t();else{if(window.innerWidth!=r||window.innerHeight!=a||$!=window.screenX||c!=window.screenY){r=window.innerWidth,a=window.innerHeight,$=window.screenX,c=window.screenY;var u=!0}else u=!1;u?(d.w("{5083445}","{824b461}"),s.length=0,l()):(u=performance.now(),s.length&&s[0]<=u-2e3?(o=Math.floor(s.length/2),d.d("{5083445}","{8c3d290}",o,s[s.length-1]-s[0]),u=o,window.clearTimeout(n),e(u)):(s.push(u),l()))}}))};l()})).then((e=>(i.refreshRate=e,i.refreshRate)),(()=>{var e;return null!==(e=i.refreshRate)&&void 0!==e?e:0})),i.$j$);var i}var yn=new class{constructor(){Rt.push(this.$s$.bind(this)),Rt.push(this.$m$.bind(this)),Rt.push(this.$o$.bind(this))}$m$(){return this.$g$=bn("av1").then((e=>this.$l$=e))}$o$(){return this.$h$=Promise.resolve(void 0)}async $s$(){return 117<=await Sn(this,!0)}};function kn(e,t){const i=e.$videoElement$.videoWidth;return e=e.$videoElement$.videoHeight,new DOMRect(t.x*i,t.y*e,t.width*i,t.height*e)}function Cn(e){const t={isPrimary:!0,pointerId:1,button:0};e.$videoElement$.dispatchEvent(new PointerEvent("pointerdown",t)),e.$videoElement$.dispatchEvent(new MouseEvent("mousedown")),e.$videoElement$.dispatchEvent(new PointerEvent("pointerup",t)),e.$videoElement$.dispatchEvent(new MouseEvent("mouseup"))}function _n(e,t){e.$autoFireCheckbox$.checked=t,e.$v$.disabled=!t,e.$A$.disabled=!t,e.$l$.style.color=t?"white":"gray"}function En(e,t=!1){t&&(e.$g$.style.bottom="5px",e.$g$.style.left="300px",e.$g$.style.top="",e.$g$.style.right="",e.$g$.style.width="150px",e.$g$.style.height="150px"),e.$o$()?(e.$m$.style.display="none",e.$g$.style.border="2px rgb(76, 175, 80) solid",e.$g$.style.backgroundColor="transparent"):(e.$m$.style.display="block",e.$g$.style.border="none",e.$g$.style.backgroundColor="rgb(105, 105, 105, 0.7)")}function Tn(e,t){if(t!==e.visible){for(n of(d.i("{50c79eb}","{5595c14}",t),e.visible=t,[e.$D$,e.$g$,e.$s$]))n===e.$s$&&t?jn(e,"Show hotkeys"!==e.$h$.value):n.style.display=t?"block":"none";var i=!(null===PointerEvent||void 0===PointerEvent||!PointerEvent.prototype),n=i?"pointerdown":"mousedown";if(i=i?"pointermove":"mousemove",t){e.$I$(),function(e,t){let i=0,n=0,s=0,o=0;const r=document.onmouseup,a=document.onmousemove;t.onmousedown=t=>{t.preventDefault(),i=t.clientX,n=t.clientY,document.onmouseup=()=>{document.onmouseup=r,document.onmousemove=a},document.onmousemove=t=>{t.preventDefault(),s=i-t.clientX,o=n-t.clientY,i=t.clientX,n=t.clientY,e.style.top=e.offsetTop-o+"px",e.style.left=e.offsetLeft-s+"px"}}}(e.$g$,e.$m$),e.$H$.oninput=t=>{t=parseFloat(t.target.value);var i=e.$j$;0>=t||1<=t?d.e("{0c7ed7c}","{1cbd879}",t.toFixed(2)):i.$m$=t,e.$K$.innerHTML=(100*t).toFixed()+"%"},e.$autoFireCheckbox$.oninput=t=>{_n(e,t.target.checked)},e.$v$.oninput=t=>{e.$M$.innerHTML=t.target.value},e.$A$.oninput=t=>{e.$N$.innerHTML=t.target.value+" ms"},e.$u$.oninput=t=>{e.$u$.checked=t.target.checked};const t=(t,i)=>{i.value=Math.max(Math.min(parseInt(t.target.value),100),0).toFixed(0),Dn(e,parseInt(e.$loupePositionX$.value||"50")/100,parseInt(e.$loupePositionY$.value||"50")/100)};e.$loupePositionX$.oninput=i=>t(i,e.$loupePositionX$),e.$loupePositionY$.oninput=i=>t(i,e.$loupePositionY$),e.$C$.onclick=()=>In(e,"Start"===e.$C$.value),e.$h$.onclick=()=>jn(e,"Show hotkeys"===e.$h$.value),e.$g$.onmouseup=e.$I$.bind(e),e.$g$.onmousedown=()=>{e.$o$()&&Cn(e.$j$)},ls(e.$P$,2,e.$O$),e.$videoElement$.addEventListener(n,e.$R$),e.$videoElement$.addEventListener(i,e.$S$)}else In(e,!1),e.$H$.oninput=null,e.$autoFireCheckbox$.oninput=null,e.$v$.oninput=null,e.$A$.oninput=null,e.$u$.oninput=null,e.$loupePositionX$.oninput=null,e.$loupePositionY$.oninput=null,e.$C$.onclick=null,e.$h$.onclick=null,e.$g$.onmouseup=null,e.$g$.onmousedown=null,e.$m$.onmousedown=null,us(e.$P$,2,e.$O$),e.$videoElement$.removeEventListener(n,e.$R$),e.$videoElement$.removeEventListener(i,e.$S$)}}function In(e,t){var i,n,s;t&&!function(e){const t=kn(e,e.$l$);return!(0>t.x||0>t.y||t.x+t.width>e.$videoElement$.videoWidth||t.y+t.height>e.$videoElement$.videoHeight)}(e.$j$)?((s=e).$J$.style.display="block",window.setTimeout((()=>s.$J$.style.display="none"),5e3)):t&&e.$F$?d.e("{50c79eb}","{89742e9}"):(n=t,(i=e.$j$).active!==n&&((i.active=n)?(d.i("{0c7ed7c}","{b56e30d}"),i.$videoElement$.dispatchEvent(new Event("focus",{bubbles:!0})),i.$videoElement$.addEventListener("pointerdown",i.$j$),i.$videoElement$.addEventListener("mousedown",i.$j$)):(d.i("{0c7ed7c}","{00425c2}"),i.$videoElement$.removeEventListener("pointerdown",i.$j$),i.$videoElement$.removeEventListener("mousedown",i.$j$),i.$g$=[],i.$h$=[])),En(e),t?(e.$C$.value="Stop",e.$autoFireCheckbox$.checked&&(d.i("{50c79eb}","{5974b2c}"),e.$F$=!0,e.$T$=parseInt(e.$v$.value),e.$G$=window.setInterval((()=>{0<e.$T$--?Cn(e.$j$):(d.i("{50c79eb}","{d37e51d}"),Rn(e),In(e,!1))}),parseInt(e.$A$.value)))):(e.$C$.value="Start",e.$F$&&(e.$G$?(d.i("{50c79eb}","{d340c50}"),Rn(e)):d.w("{50c79eb}","{6d8948b}"))))}function Pn(e,t){e.value=t.toString(),e.dispatchEvent(new Event("input"))}function jn(e,t){t?(e.$h$.value="Hide hotkeys",e.$s$.style.display="block"):(e.$h$.value="Show hotkeys",e.$s$.style.display="none")}function Rn(e){window.clearInterval(e.$G$),e.$G$=0,e.$F$=!1}function Dn(e,t,i){const n=e.$videoElement$.getBoundingClientRect(),s=e.$g$.getBoundingClientRect(),{paddingTop:o,paddingRight:r,paddingBottom:a,paddingLeft:$}=Fn(e.$videoElement$);t=n.left+$+(n.width-$-r)*t-s.width*t,e.$g$.style.top=(n.top+o+(n.height-o-a)*i-s.height*i).toString()+"px",e.$g$.style.left=t.toString()+"px",e.$I$()}function xn(){const e=document.createElement("div");return e.style.display="none",e.style.position="absolute",e.style.color="white",e.style.backgroundColor="rgb(105, 105, 105, 0.7)",e.style.padding="2px",e}function Mn(e){const t=document.createElement("div");return t.style.width="100%",t.style.borderBottom="1px dashed darkgray",t.style.paddingBottom="2px",t.innerHTML=e,t}function Ln(e){const t=document.createElement("input");return t.type="button",t.value=e,t.style.margin="5px",t.style.backgroundColor="rgb(132, 130, 143, .7)",t.style.color="white",t.style.padding="8px 40px",t.style.border="none",t.style.borderRadius="4px",t.style.cursor="pointer",t}function On(){const e=document.createElement("input");return e.type="checkbox",e}function Bn(e){const t=document.createElement("label");return t.innerHTML=e,t}function Nn(e,t,i,n=1){const s=document.createElement("input");return s.type="range",s.min=t.toString(),s.max=i.toString(),s.step=n.toString(),s.value=e.toString(),s}function Fn(e){const t=e=>{if(!e)return 0;const t=e.length;return"%"===e.substring(t-1)?parseInt(e.substring(0,t-1)):"px"===e.substring(t-2)?parseInt(e.substring(0,t-2)):(d.w("{50c79eb}","{3351f27}",e),0)};return{paddingTop:t(e.style.paddingTop),paddingRight:t(e.style.paddingRight),paddingBottom:t(e.style.paddingBottom),paddingLeft:t(e.style.paddingLeft)}}var Vn=class extends Map{constructor(){super([["TCP",0],["MDNS",0],["IPV6",0],["IPV4",0],["UNKNOWN",0]])}};function Un(e){var t,i,n,s;e.$l$=window.setInterval((()=>{!function(e){if(!e.$A$)if(e.$A$=!0,0===e.$L$)e.$u$.getStats().then((t=>{e.$j$=t})).catch((t=>Hn(e,t,"early"))).finally((()=>{e.$A$=!1}));else if(1===e.$L$)if(e.$V$){const t=e.$u$.getReceivers().find((t=>t.track.kind===e.mediaType&&t.track.enabled));t&&t.getStats().then((t=>Gn(e,t))).catch((t=>Hn(e,t,"standard"))).finally((()=>{e.$A$=!1}))}else(t=e).$u$.getStats(null).then((e=>{let i=!1;for(let n of e.values())if("track"===n.type&&(i=!0),["transport","inbound-rtp","candidate-pair"].includes(n.type)){"audio"===n.kind&&(t.$fa$=!0);const e=t.$G$.get(n.type);e?e.includes(n.id)?d.e("{5cea617}","{76f5968}",n.id):e.push(n.id):t.$G$.set(n.type,[n.id])}t.$P$=!i,d.i("{5cea617}","{1317761}",t.$P$?"yes":"no"),t.$V$=!0,t.$j$=e,Gn(t,e)})).catch((e=>Hn(t,e,"init"))).finally((()=>{t.$A$=!1}));else e.$A$=!1;var t}(e)}),null!==(t=ut.$ragnarokConfig$.getStatsInterval)&&void 0!==t?t:96),window.chrome&&(e.$I$=window.setInterval((()=>{!function(e){if(!e.$K$){e.$K$=!0;var t=t=>{Hn(e,t,"deprecated"),e.$K$=!1};e.$u$.getStats((t=>{for(i of t.result())if("ssrc"==i.type)for(n of i.names()){"video"===i.stat("mediaType")&&(e.$v$.ts=ft(vt),e.$v$.timingFrameInfo=i.stat("googTimingFrameInfo"),e.$v$.targetDelayMs=+i.stat("googTargetDelayMs"),e.$v$.minPlayoutDelayMs=+i.stat("googMinPlayoutDelayMs"),e.$v$.currentDelayMs=+i.stat("googCurrentDelayMs"));break}var i=(t=e.$v$).timingFrameInfo.split(",",15);if(!(15>i.length)){var n=new ArrayBuffer(hn.size),s=new DataView(n);s.setUint32(0,t.targetDelayMs||0,!0),s.setUint32(4,t.minPlayoutDelayMs||0,!0),s.setUint32(8,t.currentDelayMs||0,!0),s.setFloat64(12,ft(vt),!0),s.setFloat64(20,parseFloat(i[3])||0,!0),s.setFloat64(28,parseFloat(i[4])||0,!0),s.setFloat64(36,parseFloat(i[8])||0,!0),s.setFloat64(44,parseFloat(i[9])||0,!0),s.setFloat64(52,parseFloat(i[10])||0,!0),s.setFloat64(60,parseFloat(i[11])||0,!0),s.setUint8(68,parseFloat(i[13])||0),s.setUint8(69,parseFloat(i[14])||0),gt([n],0)}e.$K$=!1}),t).catch(t)}}(e)}),null!==(i=ut.$ragnarokConfig$.getDeprecatedStatsInterval)&&void 0!==i?i:201)),null===(s=(n=e.$videoElement$).requestVideoFrameCallback)||void 0===s||s.call(n,e.$da$)}function Gn(e,t){var i=performance.now();if(i>=e.$O$&&"video"===e.mediaType){!function(e,t){var i,n,s,o,r,a=e.$G$.get("inbound-rtp");if(a&&e.$j$)if(a=a.map((e=>t.get(e))).find((e=>"video"===(null==e?void 0:e.kind)||"video"===(null==e?void 0:e.mediaType)))){var $=(a=Kn(e,t,a)).decoderImplementation;null!=$&&$.indexOf&&(-1!==$.indexOf("fallback")&&-1===e.$h$.$fallbackFrameNumber$&&(e.$h$.$fallbackFrameNumber$=null!==(i=a.framesDecoded)&&void 0!==i?i:e.$s$,function(){var e=vt;if(e.$h$){const t={clientEvent:{TS:ft(e),eventtype:"SoftwareDecodeFallback"}};e.$g$&&e.$g$.postMessage(t)}}(),i="Fallback to software decode at frame "+String(e.$h$.$fallbackFrameNumber$),d.d("{5cea617}","{0b0c6f9}",i),e.$g$.$L$=!0,Ls(e.$C$,{etwPrint:i})),$!==e.$h$.$decoder$&&"unknown"!==$&&(e.$h$.$decoder$=$,e.$g$.$decoder$=$)),(i=e.$j$.get(a.id))?(e.$h$.$counts$.$success$++,($=a.codecId)&&(e.$R$=t.get($).mimeType,o=e.$g$,(r=(r=e.$R$).toUpperCase()).includes("H265")?o.codec=5:r.includes("AV1")?o.codec=6:o.codec=4),function(e,t,i){var n=t.packetsLost-i.packetsLost;let s=100-n/(t.packetsReceived-i.packetsReceived+n)*100;for((isNaN(s)||void 0===s)&&(s=0),0<(t=t.pliCount-i.pliCount)&&n&&(s=0),n=0;n<t+1;n++)e.networkLossScore=7*e.networkLossScore/8+s/8}(e.$B$,a,i),function(e,t){if(t.frameWidth&&t.frameHeight&&(e.streamingResolution={width:t.frameWidth,height:t.frameHeight}),t.framesDecoded){const i=e.$I$,n=t.timestamp;i!==n&&(e.fps=Math.floor((t.framesDecoded-e.$A$)/(n-i)*1e3)),e.$A$=t.framesDecoded,t.totalDecodeTime&&(e.$m$.update(t.totalDecodeTime,t.framesDecoded),e.$cumulativeAvgDecodeTime$=1e3*t.totalDecodeTime/t.framesDecoded)}t.framesReceived&&(e.$G$=t.framesReceived,t.totalInterFrameDelay&&(e.$H$=1e3*t.totalInterFrameDelay/(t.framesReceived-1))),t.framesDropped&&(e.$F$=t.framesDropped),t.packetsLost&&(e.$C$=t.packetsLost),t.pliCount&&(e.$u$=t.pliCount),e.$I$=t.timestamp}(e.$g$,a),e.$s$=null!==(n=a.framesDecoded)&&void 0!==n?n:0,e.$ea$=null!==(s=a.packetsReceived)&&void 0!==s?s:0,async function(e){var t={width:screen.width*window.devicePixelRatio,height:screen.height*window.devicePixelRatio};const i={width:screen.width,height:screen.height},n=e.$s$;var s=e.$$$;(s=!(t.width===s.width&&t.height===s.height))||(s=e.$W$,s=!(i.width===s.width&&i.height===s.height)),s&&(e.$$$=t,e.$W$=i,s=await Sn(yn),t=`Stream[0]: Client display[-1] resolution : {physical : ${Dt(t)}@${s}, logical : ${Dt(i)}@${s}} at frame#${n}`,d.i("{5cea617}","{0b0c6f9}",t),Ls(e.$C$,{etwPrint:t}))}(e)):e.$h$.$counts$.$prevReportFailed$++}else e.$h$.$counts$.$currReportFailed$++}(e,t);var n,s,o,r,a,$,c=e.$g$,l=e.$C$,u=l.$videoElement$.paused,h=l.$audioElement$.paused,p=null!==(s=null===(n=l.$m$)||void 0===n?void 0:n.$isUserInputEnabled$())&&void 0!==s&&s;n=null!==(r=null===(o=l.$m$)||void 0===o?void 0:o.$isVirtualKeyboardVisible$)&&void 0!==r&&r,o=l.$na$.getMicState(),r=l.$R$.$isRsdmmActive$(),s=l.keyboardLayout;var m,f=l.appLaunchMode;u={$isVideoElementPaused$:u,$isAudioElementPaused$:h,$isUserInputEnabled$:p,$isVirtualKeyboardVisible$:n,$micState$:o,$isRsdmmActive$:r,keyboardLayout:s,appLaunchMode:f,$inputMode$:null!==($=l=null===(a=l.$m$)||void 0===a?void 0:`${(l=a.$l$).$g$.$absPositioning$?"local":"alt"} ${null!==l.$o$?"locked":"unlocked"}`)&&void 0!==$?$:""},c.$g$=u,function(e,t){var i,n=e.$G$.get("candidate-pair");if(n=null==n?void 0:n.map((e=>t.get(e))).find((e=>e))){6<=e.$o$.length&&e.$o$.splice(0,1),e.$o$.push(n);var s=null===(i=e.$j$)||void 0===i?void 0:i.get(n.id);s&&function(e,t,i){var n,s,o,r;let a=null!==(n=t.bytesReceived)&&void 0!==n?n:0;n=null!==(s=i.bytesReceived)&&void 0!==s?s:0,(t=null!==(o=t.timestamp)&&void 0!==o?o:0)!=(i=null!==(r=i.timestamp)&&void 0!==r?r:0)&&(e.$s$=(a-n)/(125*(t-i)))}(e.$g$,n,s)}}(e,t),0!==e.$F$&&dn(e.$g$,2===e.$F$),$={avgGameFps:null!==(m=(c=e.$g$).avgGameFps)&&void 0!==m?m:0,fps:c.fps,rtd:c.rtd,avgDecodeTime:1e3*$n(c.$m$),frameLoss:c.$u$-c.$K$,packetLoss:c.$C$,totalBandwidth:c.$v$,utilizedBandwidth:c.$bwu$,streamingResolution:c.streamingResolution},c.$K$=c.$u$,e.$H$.emit("StreamStatsUpdate",$),e.$j$=t,e.$O$=i+1e3}for(const[i,d]of e.$G$.entries())for(g of(m=i,c=d))if((c=t.get(g))&&"inbound-rtp"===m)if($=e.$m$,"audio"===(c=Kn(e,t,c)).kind)$=c,u=new ArrayBuffer(mn.size),h=new DataView(u),Et($.packetsReceived||0,h,0,!0),Et($.bytesReceived||0,h,8,!0),Et($.packetsLost||0,h,16,!0),h.setFloat64(24,$.lastPacketReceivedTimestamp||0,!0),h.setFloat64(32,$.jitter||0,!0),h.setFloat64(40,ft(vt),!0),gt([u],2),$=new ArrayBuffer(fn.size),(u=new DataView($)).setFloat64(0,c.audioLevel||0,!0),Et(c.concealedSamples||0,u,8,!0),Et(c.concealmentEvents||0,u,16,!0),Et(c.insertedSamplesForDeceleration||0,u,24,!0),u.setFloat64(32,c.jitterBufferDelay||0,!0),Et(c.jitterBufferEmittedCount||0,u,40,!0),Et(c.removedSamplesForAcceleration||0,u,48,!0),Et(c.silentConcealedSamples||0,u,56,!0),u.setFloat64(64,c.totalSamplesReceived||0,!0),u.setFloat64(72,c.totalSamplesDuration||0,!0),u.setFloat64(80,ft(vt),!0),gt([$],4);else if(h=(u=c).packetsLost||0,r=p=u.framesDecoded||0,s=l=u.totalDecodeTime||0,f=a=u.pliCount||0,(o=h)>=(n=$).$o$&&(n.$v$=o-n.$o$,n.$o$=o),f>=n.$l$&&(n.pliCount=f-n.$l$,n.$l$=f),n.framesDecoded=r-n.$s$,0<n.framesDecoded&&s>n.$m$&&(n.$u$=1e3*(s-n.$m$)/n.framesDecoded,n.$s$=r,n.$m$=s),n=new ArrayBuffer(pn.size),(o=new DataView(n)).setUint32(0,p,!0),o.setUint32(4,u.keyFramesDecoded||0,!0),o.setUint32(8,u.nackCount||0,!0),o.setInt32(12,h,!0),o.setInt32(16,a,!0),Et(u.bytesReceived||0,o,20,!0),Et(u.packetsReceived||0,o,28,!0),o.setFloat64(36,l,!0),o.setFloat64(44,u.totalInterFrameDelay||0,!0),o.setFloat64(52,u.totalSquaredInterFrameDelay||0,!0),o.setFloat64(60,u.totalAssemblyTime||0,!0),o.setUint32(68,u.framesAssembledFromMultiplePackets||0,!0),o.setFloat64(72,ft(vt),!0),gt([n],1),$.sendVideoTrack(c),c.perFrameEntries){for(c=JSON.parse(c.perFrameEntries),u=[],h=$.$h$,p=0;p<c.length;p++)c[p].frameNumber>$.$h$&&(l=new ArrayBuffer(gn.size),(a=new DataView(l)).setUint32(0,c[p].frameNumber,!0),a.setFloat64(4,c[p].decodeTime,!0),a.setFloat64(12,c[p].assemblyTime,!0),u.push(l)),h=Math.max(h,c[p].frameNumber);$.$h$=h,0<u.length&&gt(u,6)}var g=performance.memory;g&&(t=g.usedJSHeapSize,c=g.totalJSHeapSize,g=t-e.$ca$,m=c-e.$ba$,e.$ca$=t,e.$ba$=c,0<=g&&0<=m||(t=vt).$h$&&(g={garbageCollectionStats:{timestamp:ft(t),deltaUsedHeapSize:g,deltaTotalHeapSize:m}},t.$g$&&t.$g$.postMessage(g))),t=e.$C$,(g=vt).$h$&&(m={inputChannelStats:{timestamp:ft(g),bufferedAmount:t.$B$.bufferedAmount,maxSchedulingDelay:t.$R$.maxSchedulingDelay}},g.$g$&&g.$g$.postMessage(m)),t.$R$.maxSchedulingDelay=0,i>=e.$Z$&&e.$N$&&(t=e.$N$,g=new ArrayBuffer(15),(m=new DataView(g)).setUint8(0,2),m.setUint8(1,1),m.setUint8(2,1),m.setUint32(3,t.$rtp$,!0),m.setFloat64(7,t.client,!0),Jn(e,g,"rtpmapping"),e.$N$=void 0,e.$Z$=i+1e3),"video"===e.mediaType&&(Pt(e.$platformDetails$)&&(t=new ArrayBuffer(12),(g=new DataView(t)).setUint8(0,1),g.setUint8(1,1),g.setUint16(2,e.$m$.$v$,!0),g.setUint16(4,Math.round(e.$m$.$u$),!0),g.setUint16(6,e.$m$.framesDecoded,!0),g.setUint16(8,e.$m$.pliCount,!0),g.setUint16(10,e.$m$.framesDropped,!0),Jn(e,t,"clientperf")),t=rn(e.$B$),e.$g$.$o$=t,g=rn(e.$B$),e.$H$.emit("StreamingQuality",g),e.$ga$&&(t=e.$g$,e.$H$.emit("StreamingStats",{fps:t.fps,$cumulativeAvgDecodeTime$:t.$cumulativeAvgDecodeTime$,avgDecodeTime:1e3*$n(t.$m$),$bwe$:t.$v$,$bwu$:t.$bwu$,width:t.streamingResolution.width,height:t.streamingResolution.height})),(t=vt).$h$&&(g={sq:{latencyScore:g.latencyScore,bandwidthScore:g.bandwidthScore,qualityScore:g.qualityScore,networkLossScore:g.networkLossScore,timestamp:ft(t)}},t.$g$&&t.$g$.postMessage(g))),i=performance.now()-i,(t=vt).$h$&&(t.perf.GetStats+=i),(t=e.$g$).$l$.value+=i,t.$l$.count+=1,t.$l$.max=Math.max(i,t.$l$.max),e.$fa$&&(e.mediaType="video"===e.mediaType?"audio":"video")}function Hn(e,t,i){e.$T$.$g$(t,`Exception in ${i} getStats`,"clientstatsservice.ts",0,0,!0,"getStats")}function zn(e){e.$l$&&(clearInterval(e.$l$),e.$l$=0),e.$I$&&(clearInterval(e.$I$),e.$I$=0),vn(e.$m$)}function Wn(e,t,i=!1){e.$g$.$J$.style.display=t?"block":"none",t?(e.$F$=i?2:1,dn(e.$g$,i),e.$O$=performance.now()):e.$F$=0}function Kn(e,t,i){return e.$P$||(e=t.get(i.trackId))&&(i=Object.assign(e,i)),i}function Jn(e,t,i){try{"open"===e.$D$.readyState&&e.$D$.send(t)}catch(t){d.e("{5cea617}","{78e74c5}",t),Hn(e,t,i)}}function qn(e){if(!(2>e.$o$.length)){var t=e.$o$[0],i=e.$o$[e.$o$.length-1];e=i.requestsSent-t.requestsSent+i.consentRequestsSent-t.consentRequestsSent;var n=i.responsesReceived-t.responsesReceived;return t=i.packetsReceived-t.packetsReceived,{$recentRequestsSent$:isNaN(e)?-1:e,$recentResponsesReceived$:isNaN(n)?-1:n,$recentPacketsReceived$:isNaN(t)?-1:t}}}var Yn=class{constructor(e,t,i,n,s,o,r,a,$){var c,l,u,h,p;this.$aa$=!0,this.$s$=this.$ea$=this.$I$=this.$l$=0,this.$R$="",this.$V$=!1,this.$G$=new Map,this.$U$=this.rtd=this.jitter=this.$M$=0,this.mediaType="video",this.$ba$=this.$ca$=this.$O$=this.$F$=0,this.$o$=[],this.$W$={width:0,height:0},this.$$$={width:0,height:0},this.$P$=this.$K$=this.$A$=!1,this.$L$=this.$Z$=0,this.$H$=e,this.$C$=t,this.$videoElement$=i,this.$u$=n,this.$mapRtpTimestampsToFrames$=null!==(l=null===(c=s.video)||void 0===c?void 0:c[0].$mapRtpTimestampsToFrames$)&&void 0!==l&&l,this.maxBitrate=null!==(h=null===(u=s.video)||void 0===u?void 0:u[0].$maximumBitrateKbps$)&&void 0!==h?h:0,this.$T$=o,this.$platformDetails$=r,this.$S$=a,this.$v$={ts:0,timingFrameInfo:"",targetDelayMs:0,minPlayoutDelayMs:0,currentDelayMs:0},this.$B$=new an(this.maxBitrate),this.$g$=new ln(i,this.$platformDetails$,this.$S$),ut.isInternalUser&&(this.$J$=new class{constructor(e,t){this.$P$=t,this.visible=!1,this.$latencyData$=[],this.$F$=!1,this.$T$=this.$G$=0,this.$L$={x:0,y:0},this.$videoElement$=e,this.$j$=new class{constructor(e){this.active=!1,this.$m$=.06,this.$l$=new DOMRect(0,0,0,0),this.$g$=[],this.$h$=[],this.$videoElement$=e,this.$j$=this.$u$.bind(this)}$o$(){return this.active}$u$(e){if(this.$g$.length){if(!(this.$h$.length&&100>e.timeStamp-this.$h$[this.$h$.length-1].$mouseClickTime$))for(this.$h$.push({$mouseClickTime$:e.timeStamp,$mouseClickCallbackTime$:performance.now()});32<this.$h$.length;)this.$h$.shift()}else d.w("{0c7ed7c}","{fe08a50}")}}(e),this.$O$=this.$W$.bind(this),this.$R$=this.$V$.bind(this),this.$S$=this.onmousemove.bind(this),t=xn();var i=Mn("Latency Display Analysis Tool (LDAT)");this.$C$=Ln("Start"),this.$h$=Ln("Show hotkeys"),t.style.bottom="0px",t.style.left="0px",t.style.margin="5px",this.$h$.style.border="1px solid white",this.$h$.style.fontSize="10px",this.$h$.style.padding="5px",this.$h$.style.position="absolute",this.$h$.style.right="0px",t.appendChild(i),t.appendChild(this.$C$),t.appendChild(this.$h$),i=t.appendChild;var n=document.createElement("div"),s=this.$j$.$m$;this.$H$=Nn(s,.01,.2,.01),this.$K$=document.createElement("span");var o=Bn("Activation Level"),r=document.createElement("span");for(a of(this.$K$.innerHTML=(100*s).toFixed()+"%",r.style.paddingRight="2px",r.title="% increase in luminance used to determine whether a flash occurred",r.innerHTML="<sup> i </sup>",n.appendChild(o),n.appendChild(r),n.appendChild(this.$H$),n.appendChild(this.$K$),i.call(t,n),i=t.appendChild,n=document.createElement("div"),this.$l$=document.createElement("div"),this.$autoFireCheckbox$=On(),this.$v$=Nn(20,5,100,5),this.$A$=Nn(1e3,100,5e3,100),s=Bn("Autofire"),o=Bn("# Shots"),r=Bn("Shot Delay"),this.$M$=document.createElement("span"),this.$N$=document.createElement("span"),this.$M$.innerHTML=this.$v$.value,this.$N$.innerHTML=this.$A$.value+" ms",this.$l$.appendChild(o),this.$l$.appendChild(this.$v$),this.$l$.appendChild(this.$M$),this.$l$.appendChild(document.createElement("br")),this.$l$.appendChild(r),this.$l$.appendChild(this.$A$),this.$l$.appendChild(this.$N$),n.appendChild(s),n.appendChild(this.$autoFireCheckbox$),n.appendChild(this.$l$),i.call(t,n),t.appendChild(function(e){const t=document.createElement("div"),i=Bn("Loupe Position:"),n=Bn("X"),s=Bn("Y");n.style.paddingLeft="10px",s.style.paddingLeft="10px",n.style.paddingRight="2px",s.style.paddingRight="2px";const o=()=>{const e=document.createElement("input");return e.type="number",e.min="0",e.max="100",e.step="1",e.placeholder="Int",e.style.width="40px",e};return e.$loupePositionX$=o(),e.$loupePositionY$=o(),t.appendChild(i),t.appendChild(n),t.appendChild(e.$loupePositionX$),t.appendChild(Bn("%")),t.appendChild(s),t.appendChild(e.$loupePositionY$),t.appendChild(Bn("%")),t}(this)),this.$u$=On(),(i=document.createElement("span")).title="Simulate mouse move event whenever a mouse click is detected.  Introduces two 300 ms delays between move events and requires a minimum shot delay of 1 sec.",i.innerHTML="<sup> i </sup>",t.appendChild(Bn("Move On Click")),t.appendChild(i),t.appendChild(this.$u$),this.$D$=t,t=xn(),i=Mn("Loupe"),this.$m$=document.createElement("div"),this.$m$.style.cursor="move",this.$m$.style.width="100%",this.$m$.style.height="100%",this.$m$.innerHTML="Click here to drag the loupe to the area of the screen where flashes will occur.  Then, press start.",t.appendChild(i),t.appendChild(this.$m$),this.$g$=t,(t=xn()).style.position="relative",t.style.backgroundColor="gray",t.style.textAlign="center",t.innerHTML="Warning: Must place loupe over video element to activate the LDAT.  Please reposition the loupe and then click start.",this.$J$=t,t=xn(),i=Mn("LDAT Hot Keys"),n=document.createElement("ul"),t.style.bottom="195px",t.style.left="0px",t.style.margin="5px",n.style.listStyle="none",n.style.paddingLeft="2px",n.style.margin="5px",["Enter - Start/Stop","R - Reset","A - Turn On/Off Auto-Fire Mode","S - Save Log File","C - Center Loupe on Screen"]))(s=document.createElement("li")).innerHTML=a,n.append(s);t.appendChild(i),t.appendChild(n),this.$s$=t;var a=xn();a.style.bottom="325px",a.style.left="0px",a.style.margin="5px",this.$B$=a,e.insertAdjacentElement("afterend",this.$D$),this.$D$.insertAdjacentElement("afterend",this.$g$),this.$g$.insertAdjacentElement("afterend",this.$J$),this.$D$.insertAdjacentElement("beforebegin",this.$s$),this.$s$.insertAdjacentElement("beforebegin",this.$B$),this.$j$.$s$=this.$U$.bind(this),_n(this,!1),this.$u$.checked=!1,En(this,!0)}stop(){this.$D$.remove(),this.$g$.remove(),this.$J$.remove(),this.$s$.remove(),this.$B$.remove(),Tn(this,!1),this.$latencyData$=[]}reset(){In(this,!1),Pn(this.$H$,.06),Pn(this.$v$,20),Pn(this.$A$,1e3),_n(this,!1),this.$u$.checked=!1,En(this,!0),jn(this,!1),this.$loupePositionX$.value="",this.$loupePositionY$.value="",this.$latencyData$=[]}isVisible(){return this.visible}toggle(){In(this,!this.$o$())}$o$(){return this.$j$.$o$()}$allowPointerLock$(){return!this.isVisible()||this.$o$()}$V$(e){if(this.$u$.checked&&this.$o$()&&!e.$fromSelf$){const t=(e,t)=>{switch(e){case 0:this.$videoElement$.dispatchEvent(new PointerEvent("pointerup",t)),this.$videoElement$.dispatchEvent(new MouseEvent("mouseup",t));break;case 1:e=new PointerEvent("pointerdown",t),t=new MouseEvent("mousedown",t),e.$fromSelf$=!0,t.$fromSelf$=!0,this.$videoElement$.dispatchEvent(e),this.$videoElement$.dispatchEvent(t);break;case 2:this.$videoElement$.dispatchEvent(new PointerEvent("pointerrawupdate",t)),this.$videoElement$.dispatchEvent(new PointerEvent("pointermove",t)),this.$videoElement$.dispatchEvent(new MouseEvent("mousemove",t))}},i={button:2,isPrimary:!0,pointerId:1},n={clientX:(Math.max(e.clientX,0)||this.$L$.x)+64,clientY:Math.max(e.clientY,0)||this.$L$.y,movementX:64,isPrimary:!0};t(1,i),window.setTimeout((()=>{t(2,n),window.setTimeout((()=>{n.clientX-=64,n.movementX=-64,t(2,n),window.setTimeout((()=>t(0,i)),300)}),300)}),300)}}onmousemove(e){this.$L$={x:e.clientX,y:e.clientY}}$I$(){var e=this.$videoElement$.getBoundingClientRect();const t=this.$g$.getBoundingClientRect();if(this.$videoElement$.style.paddingTop||this.$videoElement$.style.paddingRight||this.$videoElement$.style.paddingBottom||this.$videoElement$.style.paddingLeft){const{paddingTop:t,paddingRight:i,paddingBottom:n,paddingLeft:s}=Fn(this.$videoElement$);e.x+=s,e.y+=t,e.width-=s+i,e.height-=t+n}t.x=(t.x-e.x)/e.width,t.y=(t.y-e.y)/e.height,t.width/=e.width,t.height/=e.height,e=this.$j$,0>=t.width||0>=t.height?d.e("{0c7ed7c}","{3e0eb8f}",t.width,t.height):e.$l$=t}$W$(){this.$I$()}$U$(e){this.$latencyData$.push(e),e=`Flash occurred at frame\n            ${e.presentedFrames}. Latency: ${(e.$videoFrameCallbackTime$-e.$mouseClickTime$).toFixed()} ms`,d.i("{50c79eb}","{0b0c6f9}",e),this.$B$.innerHTML=e,this.$B$.style.display="block",window.setTimeout((()=>{this.$B$.innerHTML="",this.$B$.style.display="none"}),5e3)}}(i,$)),this.$u$=n,(p=this).$D$=p.$u$.createDataChannel("stats_channel",{ordered:!1,reliable:!1,maxRetransmits:0}),p.$D$.binaryType="arraybuffer",Ss(p.$C$,p.$D$,{open:()=>{p.$L$=1},close:()=>{zn(p),p.$L$=2}}),p.$D$.onmessage=e=>{var t=(e=new DataView(e.data)).getUint8(0);if(2<=t){p.$M$=e.getFloat64(1,!0)/1e6,p.jitter=1e3*e.getFloat64(9,!0),p.rtd=e.getFloat64(17,!0),p.$g$.$D$=p.jitter,p.$g$.rtd=p.rtd,3<=t&&(p.$U$=e.getFloat64(25,!0),p.$g$.avgGameFps=p.$U$),e=p.$B$,t=p.$M$;var i=p.$g$,n=p.$M$;n&&i.$s$<=n&&(i.$bwu$=i.$s$/n*100),i.$v$=n,n=100,25<=i.$bwu$&&(n=t/e.maxBitrate*100),100<n&&(n=100),void 0===n||isNaN(n)||(e.bandwidthScore=15*e.bandwidthScore/16+n/16,e.bandwidthScore=Math.min(e.bandwidthScore,100)),e=p.$B$,i=0,250>(t=p.rtd)&&(void 0===(i=100*(250-t)/240)||isNaN(i))&&(i=0),e.latencyScore=15*e.latencyScore/16+i/16,e.latencyScore=Math.min(e.latencyScore,100)}else d.e("{5cea617}","{4f9f4b7}",t)},this.$ga$=this.$H$.hasListener("StreamingStats"),this.$m$=new class{constructor(){this.$j$=this.framesDropped=this.$l$=this.pliCount=this.framesDecoded=this.$m$=this.$s$=this.$o$=this.$u$=this.$v$=0,this.$g$=[],this.$h$=-1}sendVideoTrack(e){const t=e.framesDropped||0;t>=this.$j$&&(this.framesDropped=t-this.$j$,this.$j$=t);const i=new ArrayBuffer(44),n=new DataView(i);n.setUint32(0,e.framesDecoded||0,!0),n.setUint32(4,t,!0),n.setUint32(8,e.frameHeight||0,!0),n.setUint32(12,e.frameWidth||0,!0),n.setUint32(16,e.framesReceived||0,!0),n.setFloat64(20,e.jitterBufferDelay||0,!0),Et(e.jitterBufferEmittedCount||0,n,28,!0),n.setFloat64(36,ft(vt),!0),gt([i],3)}},this.$h$={$counts$:{$currReportFailed$:0,$prevReportFailed$:0,$success$:0},$decoder$:"",$fallbackFrameNumber$:-1},this.$da$=this.$ha$.bind(this),Un(this)}$ha$(e,t){var i,n,s,o,r,a=this.$m$,$=null!==(o=t.receiveTime)&&void 0!==o?o:0;o=t.presentationTime-$,$=1e3*(null!==(r=t.processingDuration)&&void 0!==r?r:0),r=void 0!==(r=t.presentationTime)?r-vt.$j$:0;const c=new ArrayBuffer(12),l=new DataView(c);var u,h,p,m,f,g,v,A;l.setFloat64(0,r,!0),l.setUint16(8,Math.min(100*o,65535),!0),l.setUint16(10,Math.min(100*$,65535),!0),a.$g$.push(c),120==a.$g$.length&&vn(a),null!==(i=this.$J$)&&void 0!==i&&i.$o$()&&(u=this.$J$.$j$,h=e,p=t,u.$g$.push({presentedFrames:p.presentedFrames,$videoFrameCallbackTime$:h,presentationTime:p.presentationTime,receiveTime:p.receiveTime,processingDuration:p.processingDuration}),h=kn(u,u.$l$),(m=u.$videoElement$,f=h.x,g=h.y,v=h.width,A=h.height,new Promise(((e,t)=>{window.setTimeout((()=>{e:if(0>=v||0>=A)var i=-1;else{var n=new OffscreenCanvas(v,A).getContext("2d");if(n){try{n.drawImage(m,f,g,v,A,0,0,v,A),i=n.getImageData(0,0,v,A).data}catch(e){d.e("{0c7ed7c}","{b16b792}",e),i=-1;break e}var s=n=0;for(let e=0;e<i.length-3;e+=4)n+=.2126*i[e]+.7152*i[e+1]+.0722*i[e+2],s++;i=n/s/255}else d.e("{0c7ed7c}","{b72639c}"),i=-1}-1===i&&t(-1),e(i)}),0)}))).then((e=>{var t,i=p.presentedFrames;const n=u.$g$[u.$g$.length-1];if(i!==n.presentedFrames)d.d("{0c7ed7c}","{06323ea}",i);else{for(n.$luma$=e;32<u.$g$.length;)u.$g$.shift();if(1!=u.$g$.length&&!((e=u.$g$[u.$g$.length-2]).presentedFrames<i-2||void 0===e.$luma$||-1===e.$luma$)&&n.$luma$-e.$luma$>u.$m$){let s;e=0;const o={presentedFrames:i,$videoFrameCallbackTime$:n.$videoFrameCallbackTime$,presentationTime:n.presentationTime,receiveTime:n.receiveTime,processingDuration:n.processingDuration,$mouseClickTime$:0,$mouseClickCallbackTime$:0};for(;u.$h$.length&&u.$h$[0].$mouseClickTime$<(null!==(t=n.receiveTime)&&void 0!==t?t:n.presentationTime);)e++,s=u.$h$.shift();s&&(1<e&&d.d("{0c7ed7c}","{a4b8c55}",i,e),o.$mouseClickTime$=s.$mouseClickTime$,o.$mouseClickCallbackTime$=s.$mouseClickCallbackTime$,u.$s$&&u.$s$(o))}}}))),this.$mapRtpTimestampsToFrames$&&t.rtpTimestamp&&t.receiveTime&&(this.$N$={$rtp$:t.rtpTimestamp,client:t.receiveTime-vt.$j$}),0!=this.$l$&&(null===(s=(n=this.$videoElement$).requestVideoFrameCallback)||void 0===s||s.call(n,this.$da$))}reset(){zn(this),this.$B$=new an(this.maxBitrate),this.$g$=new ln(this.$videoElement$,this.$platformDetails$,this.$S$),this.$j$=void 0}stop(){var e;this.$aa$&&(this.$aa$=!1,0!=this.$l$&&(this.reset(),Wn(this,!1)),null===(e=this.$J$)||void 0===e||e.stop(),io(this.$T$,"InboundVideoStats",this.$h$.$decoder$,this.$h$.$counts$.$success$,this.$h$.$counts$.$currReportFailed$,this.$h$.$fallbackFrameNumber$,this.$h$.$counts$.$prevReportFailed$))}toggleOnScreenStats(e){Wn(this,0===this.$F$,e)}packetsReceived(){return this.$ea$}};function Xn(e){return"tcp"===e.protocol?"TCP":(e=e.address||e.relatedAddress)?e.endsWith(".local")?"MDNS":-1!==e.indexOf(":")?"IPV6":"IPV4":"UNKNOWN"}function Qn(e){var t=null==(e=e.address||e.relatedAddress)?void 0:e.split(".");if(4===(null==t?void 0:t.length)&&(e=parseInt(t[0]),t=parseInt(t[1]),!isNaN(e)&&!isNaN(t))){let i="UNKNOWN";return 10===e?i="10/8":192===e&&168===t?i="192.168/16":172===e&&16==(240&t)&&(i="172.16/12"),"UNKNOWN"!==i&&d.d("{5cea617}","{343589d}",i),i}return d.i("{5cea617}","{fa2d6b9}"),"UNKNOWN"}function Zn(e,t,i,n){const s=/^([^[.]+)(?:\[(\d+)\])?\.([^:]+): *(.+)$/;let o=!0;for(const $ of e.split(/\r?\n/)){var r=s.exec($);if(r){var a=r[1];e=void 0!==r[2]?Number.parseInt(r[2]):void 0;const s=r[4];r=a+"."+r[3];const $=ts(t,a=es(a),e),c=ts(i,a,e);$&&c?c.has(r)?(d.d("{eb7c2d0}","{2beb68f}",n,r,s),$.set(r,s)):(d.w("{eb7c2d0}","{cc4fdef}",n,r,s),o=!1):(d.w("{eb7c2d0}","{a649ad8}",n,a,e),o=!1)}}return o}function es(e){switch(e){case"video":case"vqos":case"qscore":case"bwe":case"clientPerfBr":case"packetPacing":return"video";case"audio":case"aqos":case"audioBitrate":return"audio";case"ri":return"application";case"mic":return"mic"}}function ts(e,t,i){var n;return void 0===t?e.$generalAttributes$:null===(n=e.media.filter((e=>e.mediaType===t))[null!=i?i:0])||void 0===n?void 0:n.attributes}function is(e,t){let i=`v=0\no=${e.origin}\ns=-\nt=${e.time}\n`;const n=(e,t)=>{for(const[n,s]of e){e=n;const o=s;o!==t.get(e)&&(i+=`a=${e}:${o}\n`)}};n(e.$generalAttributes$,t.$generalAttributes$);for(const s of e.media)i+=`m=${s.mediaType} 0 RTP/AVP\n`,i+=`a=msid:${s.$msid$}\n`,e=t.media.find((e=>e.$msid$===s.$msid$)),n(s.attributes,e.attributes);return i}function ns(e,t=!1){try{let i;e.url.includes("wss")&&(i="x-nv-sessionid."+e.sessionId,e.accessToken&&(i+="-Authorization.Bearer-"+e.accessToken));let n=e.url;t&&(n+="&reconnect=1");let s=new WebSocket(n,i);s.onopen=()=>{if(e.$h$("{aaf44dc}"),vs(e.$wsHandler$),s===e.$g$){for(const t of e.$j$)t.stats?s.send(t.stats):s.send(JSON.stringify(t));for(const t of e.$m$)rs(e,t);e.$m$=[]}},s.onclose=t=>{e.$h$("{7a09ad8}"),fs(e.$wsHandler$,{error:e.$o$,code:t.code,reason:t.reason,wasClean:t.wasClean}),s===e.$g$&&(e.$g$=void 0),e.$o$=!1},s.onerror=()=>{e.$h$("{418a180}"),e.$o$=!0},s.onmessage=t=>{if(t=JSON.parse(t.data),e.serverSupportsAck&&os(e),void 0===t.ackid||e.serverSupportsAck||(e.serverSupportsAck=!0,e.$h$("{523f5b9}"),os(e)),!t.hb)if(e.serverSupportsAck){if(void 0!==t.ack){var i=t.ack;for(let t=e.$j$.length-1;0<=t;t--)e.$j$[t].ackid<=i&&e.$j$.splice(t,1)}void 0!==t.ackid?(e.maxReceivedAckId<t.ackid&&(gs(e.$wsHandler$,t),e.maxReceivedAckId=t.ackid),e.$g$&&(t=JSON.stringify({ack:e.maxReceivedAckId}),e.$h$("{903be10}"+t),e.$g$.send(t))):void 0===t.ack&&gs(e.$wsHandler$,t)}else gs(e.$wsHandler$,t)},e.$g$=s}catch(t){e.$g$=void 0,e.$s$("WebSocket creation exception: "+t)}}function ss(e){0!==e.$l$&&(self.clearTimeout(e.$l$),e.$l$=0)}function os(e){ss(e),e.$l$=self.setTimeout((()=>{var t;e.$h$("{6c3505a}"+(null===(t=e.$g$)||void 0===t?void 0:t.readyState)),e.$g$||ns(e,!0),os(e)}),3e3)}function rs(e,t){void 0!==t.ackid&&e.serverSupportsAck&&void 0!==t.ackid&&e.$j$.push(t),e.$g$&&(t.stats?e.$g$.send(t.stats):e.$g$.send(JSON.stringify(t)))}var as=class{constructor(e,t,i){this.sessionId=e,this.accessToken=t,this.serverSupportsAck=this.$o$=!1,this.$j$=[],this.$m$=[],this.maxReceivedAckId=this.$l$=0,this.url="",this.$h$=i.$logCallback$.info,this.$s$=i.$logCallback$.exception,this.$wsHandler$=i.$wsHandler$}initialize(e,t,i,n=!1){this.url=e,this.maxReceivedAckId=t,this.serverSupportsAck=i,ns(this,n),this.$h$("{f4b05a4}")}uninitialize(e){var t;this.maxReceivedAckId=0,this.serverSupportsAck=!1,this.$j$=[],this.$m$=[],ss(this),null===(t=this.$g$)||void 0===t||t.close(e),this.$h$("{986b258}"+e)}reconnect(){ns(this,!0)}send(e){this.serverSupportsAck||this.$g$||ns(this,!0),this.$g$&&this.$g$.readyState===WebSocket.OPEN?rs(this,e):this.$m$.push(e)}};function $s(e){switch(e){case"H264":return"h264";case"H265":return"hevc";case"AV1":return"av1";default:return"video"}}var cs=class{constructor(e,t){this.$g$=e,this.$h$=t,this.streams=[]}start(e){if(1&this.$g$.$clientCapture$&&(e=e.getTransceivers().find((e=>{var t,i;return"video"===(null===(i=null===(t=e.receiver)||void 0===t?void 0:t.track)||void 0===i?void 0:i.kind)})))){const t={data:new DataView(new ArrayBuffer(209715200)),size:0,$namePrefix$:"video",$extension$:$s(this.$h$),$isFull$:!1};!function(e,t,i){const{readable:n,writable:s}=t.createEncodedStreams();t=new TransformStream({start:()=>{d.i("{d7392d2}","{b96b3ec}",i.$namePrefix$)},flush:()=>{},transform:(e,t)=>{if(!i.$isFull$){const t=new Uint8Array(e.data);if(i.size+t.byteLength<=i.data.byteLength){var n=i.data,s=i.size,o=t;const e=o.byteLength;for(let t=0;t<e;++t)n.setUint8(s+t,o[t]);i.size+=t.byteLength}else i.$isFull$=!0,d.w("{d7392d2}","{f35b2f4}",i.size,i.$namePrefix$)}t.enqueue(e)}}),n.pipeThrough(t).pipeTo(s),e.streams.push(i)}(this,e.receiver,t)}}};function ds(e){e.$g$&&(e.$j$=!e.$j$,e.$g$.style.display=e.$j$?"block":"none")}function ls(e,t,i){e.$g$.get(t).push(i)}function us(e,t,i){-1!==(i=(e=e.$g$.get(t)).indexOf(i))&&e.splice(i,1)}function hs(e,t){if(e.$B$&&ps(e,t),e.$h$!==t){e.$h$=t;for(const i of e.$g$.get(0))i(t)}}function ps(e,t){if(e.$l$!==t){e.$l$=t;for(const i of e.$g$.get(1))i(t)}}function ms(e,t,i,n){let s=e.split("\r\n"),o=-1;for(let e=0;e<s.length;e++)if(0===s[e].indexOf("m=video")){o=e;break}if(-1===o)return d.e("{93c7910}","{e0899ab}","video"),e;for(d.d("{93c7910}","{5cc346f}","video",o),o++,e=";x-google-max-bitrate="+i+";x-google-min-bitrate="+t+";x-google-start-bitrate="+n,t=new Set;o<s.length&&0!==s[o].indexOf("m=");)0===(i=s[o]).indexOf("a=rtpmap:")&&0<i.indexOf("H264/")?t.add(i.slice(9,i.indexOf(" "))):0===i.indexOf("a=fmtp:")&&t.has(i.slice(7,i.indexOf(" ")))&&(s[o]+=e),o++;return s.join("\r\n")}function fs(e,t){var i,n,s,o;if(t.error&&0!==e.$v$){var r=e.$j$,a=e.$O$,$=String(null!==(i=t.code)&&void 0!==i?i:"");i=e.$session$.sessionId;var c=e.$session$.subSessionId,l=String(null!==(n=t.wasClean)&&void 0!==n?n:"");n=null!==(o=null===(s=e.$session$)||void 0===s?void 0:s.signalConnectionInfo.ip)&&void 0!==o?o:"",no(r,{name:(s=new Ne({callDuration:e.$ha$,verb:"WS",sessionId:i,subSessionId:c,serverId:n,url:a,overrideConfigType:ut.$remoteOverrideInfo$.type,overrideConfigVersion:ut.$remoteOverrideInfo$.version,requestStatusCode:$,requestId:l,networkType:to.$g$,statusCode:$,cmsId:String(r.cmsId),moduleName:"RAGNAROK"})).name,gdprLevel:s.gdprLevel,parameters:s.parameters,ts:s.ts,clientConfig:Xs}),e.$ha$++,3>=e.$ha$?(ks(e),js(e)):(window.clearTimeout(e.$v$),e.$v$=0,d.i("{93c7910}","{8595cb4}"),Cs(e,{code:3237093890}))}t.wasClean||e.$la$++}function gs(e,t){var i;d.i("{93c7910}","{39024c3}",JSON.stringify(t)),t.ackid&&e.maxReceivedAckId<t.ackid&&(e.maxReceivedAckId=t.ackid),t.peer_info?(e.$N$||void 0===t.ackid||(e.$N$=!0),(t.peer_info.name===e.name||0===e.id)&&(e.id=t.peer_info.id,d.d("{93c7910}","{c5faf27}",e.id))):t.peer_msg?async function(e,t,i){var n,s;d.d("{93c7910}","{9978507}",t);try{const o=JSON.parse(i);if("offer"===o.type){e.$qa$=!0;let i,r=o.sdp||"";d.d("{93c7910}","{ca9a155}",r);const a=await e.$Ba$,$=function(e,t){e=e.split("\r\n");var i=-1;if(!t.length)return"H264";for(n=0;n<e.length;n++)if(e[n].startsWith("m=video")){i=n;break}if(-1===i)return d.e("{93c7910}","{3ab33e3}"),"H264";i+=1;for(var n=new Set;i<e.length&&!e[i].startsWith("m=");){var s=e[i];0===s.indexOf("a=rtpmap:")&&("H264"!==(s=s.slice(s.indexOf(" ")+1,s.indexOf("/")))&&"H265"!==s&&"AV1"!==s||n.add(s)),i++}for(const e of t)if(n.has(e))return d.i("{93c7910}","{304c3b1}",e),e;return d.i("{93c7910}","{81357e4}"),"H264"}(r,a);if(o.nvstSdp){const t=null!==(n=o.nvstServerOverrides)&&void 0!==n?n:"";if(i=function(e,t,i){var n,s=e.$u$,o=e.$platformDetails$;if(t=function(e){let t,i,n={origin:"",time:"",$generalAttributes$:new Map,media:[]},s=new Map,o=!1;const r=()=>{if(o){if(!i||!t)return d.e("{eb7c2d0}","{adc37a7}"),!1;n.media.push({mediaType:i,$msid$:t,attributes:s}),t=i=void 0}else n.$generalAttributes$=s,o=!0;return s=new Map,!0};for(const $ of e.split(/\r?\n/))if(!(2>$.length||"="!==$[1])){var a=$[0];if(e=$.substr(2),"m"==a){if(!r())return;i=e.split(" ")[0]}else if("a"==a){if(1!==(a=e.split(":",2)).length){if(2!==a.length)return void d.e("{eb7c2d0}","{f6bdb84}",e);if(e=a[0],a=a[1],"msid"===e){if(void 0!==t)return void d.e("{eb7c2d0}","{dc7fbec}",a);t=a}else s.set(e,a)}}else if("t"==a){if(o)return void d.e("{eb7c2d0}","{14fc069}");n.time=e}else if("o"==a){if(o)return void d.e("{eb7c2d0}","{eb0287a}");n.origin=e}}if(r()){if(""!==n.time&&""!==n.origin)return n;d.e("{eb7c2d0}","{8e7e486}")}}(t)){var r,a=t;const e={origin:a.origin,time:a.time,$generalAttributes$:new Map,media:[]};for(h of(e.$generalAttributes$.set("general.clientSupportsIntraRefresh","Safari"===o.browser?"0":"1"),e.$generalAttributes$.set("general.clientCapture",null!==(r=a.$generalAttributes$.get("general.clientCapture"))&&void 0!==r?r:"0"),e.$generalAttributes$.set("runtime.serverTraceCapture",2..toString()),r=0,a.media)){const t=new Map;if("video"===h.mediaType&&r<s.video.length){a=t;var $=s.video[r],c=o;a.set("vqos.fec.rateDropWindow","10"),a.set("vqos.fec.minRequiredFecPackets","2"),a.set("vqos.drc.minRequiredBitrateCheckEnabled","1"),a.set("video.dx9EnableNv12","1"),a.set("vqos.qpg.enable","1"),a.set("bwe.useOwdCongestionControl","1"),a.set("video.enableRtpNack","1"),a.set("vqos.bw.txRxLag.minFeedbackTxDeltaMs","200"),a.set("vqos.fec.repairMinPercent","5"),a.set("vqos.fec.repairPercent","5"),a.set("vqos.fec.repairMaxPercent","35"),a.set("vqos.drc.bitrateIirFilterFactor","18"),a.set("video.packetSize","1140"),a.set("packetPacing.minNumPacketsPerGroup","15"),a.set("vqos.bllFec.enable","0");const e=120<=$.$maxFps$,i=120===$.$maxFps$,n=240===$.$maxFps$,d=4953600<=$.$clientViewportWd$*$.$clientViewportHt$,l=Tt($.$clientViewportWd$,$.$clientViewportHt$)||d,u=Pt(c);u&&a.set("vqos.resControl.cpmRtc.featureMask","3"),e&&(a.set("bwe.iirFilterFactor","8"),a.set("vqos.drc.enable","0"),a.set("vqos.dfc.enable","1"),a.set("vqos.dfc.decodeFpsAdjPercent","85"),a.set("vqos.dfc.targetDownCooldownMs","250"),a.set("vqos.dfc.dfcAlgoVersion",1..toString()),a.set("vqos.dfc.minTargetFps","60"),u&&a.set("vqos.cpm.flags","1"),a.set("video.encoderFeatureSetting",47..toString()),a.set("video.encoderPreset",6..toString()),a.set("vqos.resControl.dfc.useClientFpsPerf","0"),a.set("vqos.resControl.cpmRtc.badNwSkipFramesCount"," 600"),a.set("vqos.resControl.cpmRtc.decodeTimeThresholdMs","9"),i?(a.set("video.fbcDynamicFpsGrabTimeoutMs","6"),a.set("vqos.resControl.cpmRtc.serverResolutionUpdateCoolDownCount","6000")):n&&(a.set("video.fbcDynamicFpsGrabTimeoutMs","18"),a.set("vqos.resControl.cpmRtc.serverResolutionUpdateCoolDownCount","12000"),a.set("video.enableNextCaptureMode","1"),a.set("vqos.maxStreamFpsEstimate","240"),a.set("video.videoSplitEncodeStripsPerFrame","3"),a.set("video.updateSplitEncodeStateDynamically","1"))),(l||42e3<=$.$maximumBitrateKbps$)&&(i?a.set("packetPacing.numGroups","3"):a.set("packetPacing.numGroups","5"),a.set("packetPacing.maxDelayUs","1000"),a.set("packetPacing.minNumPacketsFrame","10"),a.set("video.rtpNackQueueLength","1024"),a.set("video.rtpNackQueueMaxPackets","512"),a.set("video.rtpNackMaxPacketCount","25"),a.set("vqos.drc.qpMaxResThresholdAdj","4"),a.set("vqos.grc.qpMaxResThresholdAdj","4"),a.set("vqos.drc.iirFilterFactor","100"),a.set("vqos.qpg.enable","0"),l&&(a.set("video.videoSplitEncodeStripsPerFrame","3"),a.set("video.updateSplitEncodeStateDynamically","1")),d&&(a.set("video.encoderPreset",6..toString()),a.set("vqos.drc.add1440pResLevelFor4kDrcTable","1"),a.set("vqos.drc.minAdaptiveQpThreshold","40"),a.set("vqos.grc.minAdaptiveQpThreshold","40"),a.set("vqos.drc.upperQpThreshold","40"),a.set("vqos.grc.upperQpThreshold","40"),a.set("vqos.drc.qpMaxResThresholdAdj","5"),a.set("vqos.grc.qpMaxResThresholdAdj","5"),a.set("vqos.drc.iirFilterFactor","100"),a.set("vqos.fec.repairMinPercent","0"),a.set("vqos.qpg.enable","0"))),a.set("video.clientViewportWd",$.$clientViewportWd$.toString()),a.set("video.clientViewportHt",$.$clientViewportHt$.toString()),a.set("video.maxFPS",$.$maxFps$.toString()),a.set("video.initialBitrateKbps",$.$initialBitrateKbps$.toString()),a.set("video.initialPeakBitrateKbps",$.$initialPeakBitrateKbps$.toString()),a.set("vqos.bw.maximumBitrateKbps",$.$maximumBitrateKbps$.toString()),a.set("vqos.bw.minimumBitrateKbps",$.$minimumBitrateKbps$.toString()),a.set("video.maxNumReferenceFrames","4"),a.set("video.mapRtpTimestampsToFrames",$.$mapRtpTimestampsToFrames$?"1":"0"),a.set("video.encoderCscMode","3"),k()&&(a.set("vqos.drc.stepDownMinHeight","480"),B(c,!1,14,5)||(c=$.$clientViewportWd$/$.$clientViewportHt$*100,a.set("vqos.drc.stepDownResolutionAlignment","16"),a.set("vqos.drc.stepDownTargetAspectRatioX100",c.toFixed(0)))),void 0!==$.$drcDfcEnabled$&&(c=$.$drcDfcEnabled$?"1":"0",e?a.set("vqos.dfc.adjustResAndFps",c):a.set("vqos.drc.enable",c)),ut.hdr&&1===$.sdrHdrMode&&(a.set("video.encoderCscMode",4..toString()),a.set("video.dynamicRangeMode","1")),r++}e.media.push({mediaType:h.mediaType,$msid$:h.$msid$,attributes:t})}var l,u;o=e;var h=null!==(u=null===(l=ut.$ragnarokConfig$.nvscClientConfigFields)||void 0===l?void 0:l.join("\n"))&&void 0!==u?u:"";Zn(h,o,t,"remoteconfig"),Zn(i,o,t,"server"),i=ut.isInternalUser&&!Zn(ut.clientConfigOverride,o,t,"client")?{error:3237093917}:function(e,t){let i=!0;const n=(e,t)=>(e=e.get(t))&&(e=parseInt(e),!Number.isNaN(e))?e:(d.e("{eb7c2d0}","{0a60213}",t),i=!1,0);e.$clientCapture$=n(t.$generalAttributes$,"general.clientCapture");let s=0;for(const i of t.media)if("video"===i.mediaType&&s<e.video.length){t=e.video[s];const o=i.attributes;t.$clientViewportWd$=n(o,"video.clientViewportWd"),t.$clientViewportHt$=n(o,"video.clientViewportHt"),t.$maxFps$=n(o,"video.maxFPS"),t.$initialBitrateKbps$=n(o,"video.initialBitrateKbps"),t.$initialPeakBitrateKbps$=n(o,"video.initialPeakBitrateKbps"),t.$maximumBitrateKbps$=n(o,"vqos.bw.maximumBitrateKbps"),t.$minimumBitrateKbps$=n(o,"vqos.bw.minimumBitrateKbps"),t.$mapRtpTimestampsToFrames$=0<n(o,"video.mapRtpTimestampsToFrames"),s++}return i}(s,o)?{config:s,$answer$:is(o,t)}:{error:3237093918}}else i={error:3237093911};if(i.config&&i.$answer$)return e.$u$=i.config,i.$answer$;Cs(e,{code:null!==(n=i.error)&&void 0!==n?n:3237093910})}(e,o.nvstSdp,t),!i)return}e.$S$=new cs(e.$u$,$),function(e,t){var i,n,s,o,r;d.d("{93c7910}","{d79ed0a}",t);try{let a={iceServers:[{urls:"stun:s1.stun.gamestream.nvidia.com:19308"}]};null===(i=e.$S$)||void 0===i||i.$g$.$clientCapture$&&(a.encodedInsertableStreams=!0),d.d("{93c7910}","{93106c2}",JSON.stringify(a)),e.$fa$=t,e.$g$=new RTCPeerConnection(a);const $=t=>{var i;if(e.$L$){var n=e.$L$;io(e.$j$,"IceStats","disconnected",0,n.$recentRequestsSent$,n.$recentResponsesReceived$,n.$recentPacketsReceived$),e.$L$=void 0}(n=null===(i=e.$h$)||void 0===i?void 0:qn(i))&&io(e.$j$,"IceStats","failed",0,n.$recentRequestsSent$,n.$recentResponsesReceived$,n.$recentPacketsReceived$),e.$l$|=16,4&e.$l$?e.$h$&&0==e.$h$.packetsReceived()?Ps(e,3237093900):e.$h$&&0==e.$h$.$s$?Ps(e,3237093901):Ps(e,t?3237093906:3237093899):Ps(e,3237093894)};if(e.$g$.onconnectionstatechange=()=>{e.$g$?"failed"===(d.d("{93c7910}","{4ced155}",e.$g$.connectionState),e.$g$.connectionState)&&$(!1):d.e("{93c7910}","{648f784}")},e.$g$.oniceconnectionstatechange=()=>{var t;if(e.$g$)switch(d.d("{93c7910}","{3a3143a}",e.$g$.iceConnectionState),e.$g$.iceConnectionState){case"new":e.$l$|=1;break;case"checking":e.$l$|=2;break;case"connected":e.$L$=void 0,32&e.$l$&&(e.$D$.emit("StreamingEvent",{streamingState:{state:"reconnected"}}),e.$ta$++),e.$l$|=4;break;case"completed":e.$L$=void 0,e.$l$|=8;break;case"failed":$(!0);break;case"disconnected":e.$L$=null===(t=e.$h$)||void 0===t?void 0:qn(t),4&e.$l$&&e.$D$.emit("StreamingEvent",{streamingState:{state:"reconnecting"}}),e.$l$|=32;break;case"closed":e.$l$|=64,32&e.$l$&&Ps(e,3237093892)}else d.e("{93c7910}","{648f784}")},e.$g$.ondatachannel=t=>{d.d("{93c7910}","{b364db9}",t.channel.label),"control_channel"==t.channel.label&&(Ss(e,t.channel,{errorCode:3237093898,open:()=>{var i,n;e.$J$=t.channel;for(const t of e.$V$)_s(e,t);d.d("{93c7910}","{038895c}",e.$V$.length),e.$V$=[],Ls(e,{etwPrint:`NvRtcClient Browser name: ${e.$platformDetails$.browser}, Browser version: ${e.$platformDetails$.browserFullVer}`}),Fs(e,null!==(n=null===(i=e.$h$)||void 0===i?void 0:i.$s$)&&void 0!==n?n:0),ls(e.$s$,0,e.$H$),ls(e.$s$,1,e.$H$),ls(e.$s$,2,e.$H$)}}),t.channel.onmessage=t=>{try{var i=JSON.parse(t.data);if(d.d("{93c7910}","{9371373}"),i.exitMessage)Ps(e,function(e){if(e.stopData){var t=function(e){if(2>e.length)return null;const t=atob(e);let i=0;const n=()=>{const e=256*t.charCodeAt(i)+t.charCodeAt(i+1);return i+=2,e};return 0==n()?e.length<i+2?null:n():null}(e.stopData);if(t)return d.d("{c00be32}","{921626d}",t),at(t)}if(e.nvstResult){switch(d.d("{c00be32}","{f30bc33}",e.nvstResult),t=15868672,e=e.nvstResult){case 2147680256:case 2147680291:t=15868704;break;case 2147680257:t=15868705;break;case 2147680258:t=3237093635;break;case 2147680259:t=3237094152;break;case 2147680260:t=15868706;break;case 2147680262:t=15868707;break;case 2147680263:t=15868708;break;case 2147680264:t=15868736;break;case 2147680265:t=15868737;break;case 2147680266:t=15868738;break;case 2147680267:t=15868739;break;case 2147680268:t=15868741;break;case 2147680269:t=15868740;break;case 2147680270:t=15868742;break;case 2147680271:t=3237094147;break;case 2147680275:t=15868743;break;case 2147680277:t=15868709;break;case 2147680278:t=15868744;break;case 2147680279:t=15868710;break;case 2147680280:t=15868711;break;case 2147680281:t=15868712;break;case 2147680283:t=3237094155;break;case 2147680284:t=3237094156;break;case 2147680285:t=3237094157;break;case 2147680286:t=3237093678;break;case 2147680287:t=15868715;break;case 2147680288:t=15868716;break;case 2147745794:case 2147745797:case 2147745803:t=3237093892;break;case 2147745796:t=3237094158;break;case 2147745804:t=3237094146;break;case 2147745805:t=3237094148;break;case 2147745806:t=3237094149;break;case 2147745807:t=3237094150;break;case 2148438786:t=15868718;break;default:d.d("{c00be32}","{094c45e}",y(e))}return t}return e.code?(d.d("{c00be32}","{6210ab0}",e.code),at(e.code)):15868672}(i.exitMessage));else if(i.timerNotification){var n=(t=i).timerNotification.code;switch(i=0,d.d("{c00be32}","{44bd2b6}",n),n){case 1:case 2:i=1;break;case 4:i=2;break;case 6:i=3}var s=i;0===s?d.e("{93c7910}","{de37ac5}",t.timerNotification.code):Os(e,s,t.timerNotification.secondsLeft)}else i.debugMessage?ws(e,i.debugMessage.message):i.customMessage?e.$D$.emit("CustomMessage",JSON.parse(i.customMessage)):i.videoStreamProgressEvent?e.videoStreamProgress=i.videoStreamProgressEvent.videoStreamProgress:d.d("{93c7910}","{d14e0fd}")}catch(t){d.e("{93c7910}","{a40734a}",t),e.$j$.$g$(t,"Error in control_channel message handling","{93c7910}.ts",0,0,!0)}})},d.d("{93c7910}","{d9ffda2}"),d.d("{93c7910}","{2bd4728}"),e.$B$=e.$g$.createDataChannel("input_channel_v1",{ordered:!0,reliable:!0}),e.$B$.binaryType="arraybuffer",Ss(e,e.$B$,{errorCode:3237093896}),e.$K$=e.$g$.createDataChannel("cursor_channel",{ordered:!0,reliable:!0}),e.$K$.binaryType="arraybuffer",Ss(e,e.$K$,{errorCode:3237093897}),e.$m$=new Zi(e,e.$videoElement$,e.$B$,e.$K$,e.$j$,e.$D$,e.$za$,2===e.appLaunchMode,e.$Aa$,e.$R$,e.$platformDetails$,e.$Z$,e.$$$,e.$s$,e.textInputElement),e.$da$&&(e.setKeyboardLayout(e.keyboardLayout),e.$da$=!1),ut.$webrtcStatsEnabled$){d.d("{93c7910}","{9ae428b}");const t={zoneName:e.$session$.zoneName,clientAppVersion:null!==(n=e.clientAppVersion)&&void 0!==n?n:"",appId:e.$session$.appId,$requestedRegion$:null!==(s=e.$requestedRegion$)&&void 0!==s?s:"",gpuType:e.$session$.gpuType,streamInfo:null!==(o=e.$session$.streamInfo[0])&&void 0!==o?o:{width:0,height:0,fps:0},clientLocale:e.$session$.clientLocale};e.$h$=new Yn(e.$D$,e,e.$videoElement$,e.$g$,e.$u$,e.$j$,e.$platformDetails$,t,e.$s$)}e.$g$.addEventListener("icecandidate",e.$sa$),e.$g$.onsignalingstatechange=()=>{d.i("{93c7910}","{3236227}",e.$g$.signalingState)},e.$g$.onicecandidate=t=>Bs(e,t),e.$g$.$g$=e=>{d.w("{93c7910}","{9871b05}",e.port,e.url,e.errorCode,e.$errorText$)},(null!==(r=ut.$micEnabled$)&&void 0!==r?r:!C(e.$platformDetails$))&&e.$na$.initialize(e.$g$,e.$D$,e.$videoElement$,e.$audioElement$),e.$g$.ontrack=t=>{var i;const n=t.streams[0];d.d("{93c7910}","{47359d4}",n.id,t.track.kind,t.track.id,t.streams.length,y(e.$l$));let s={kind:"video"===t.track.kind?"video":"audio",trackId:t.track.id};const o=()=>"stream_id"===n.id||"app_media_stream"===n.id,r=()=>"second_stream_id"===n.id||"app_audio_stream"===n.id;var a,$;"video"===t.track.kind&&o()&&!e.$M$?(e.$M$=!0,qs()||(e.$videoElement$.srcObject=n)):"audio"===t.track.kind&&(o()||r())&&(e.$ba$=!0,e.$ua$=t.track.id,r()&&!qs()&&(e.$audioElement$.srcObject=n),a=e,($=function(e){let t=null;return(e=e.getAudioTracks()).length&&(t=e[0]),t}($=n))&&($.onunmute=()=>{a.$oa$=!1}),null===(i=e.$I$)||void 0===i||i.initialize(new MediaStream(n.getAudioTracks()))),(t=e.$o$.find((e=>e.streamId===n.id)))?t.tracks.push(s):e.$o$.push({streamId:n.id,tracks:[s]}),Vs(e)}}catch(t){d.e("{93c7910}","{ff11182}",t),e.$j$.$g$(t,"Exception in creating peer connection","{93c7910}.ts",0,0,!0)}}(e,t);let c=Date.now();s=e,r=r.split("\r\n").map((e=>e.startsWith("a=candidate:")?(s.$ca$=!0,"a="+Us(s,e.substr(2))):e)).join("\r\n"),r=function(e,t,i,n){let s=e.split("\r\n"),o=-1;for(var r=0;r<s.length;r++)if(s[r].startsWith("m=video")){o=r;break}if(-1===o)return d.e("{93c7910}","{3ab33e3}"),e;for(o++,r=o;r<s.length;r++)if(s[r].startsWith("a=imageattr"))return d.d("{93c7910}","{b38bf22}"),e;for(e=new Set;o<s.length&&!s[o].startsWith("m=");)r=s[o],/a=rtpmap:.*H26[45]\//.test(r)?e.add(r.slice(9,r.indexOf(" "))):0===r.indexOf("a=fmtp:")&&(r=r.slice(7,r.indexOf(" ")),e.has(r)&&(o++,s.splice(o,0,`a=imageattr:${r} send [x=[960:${t}],y=[540:${i}],fps=[30:${n}]]`))),o++;return s.join("\r\n")}(r,e.$u$.video[0].$clientViewportWd$,e.$u$.video[0].$clientViewportHt$,e.$u$.video[0].$maxFps$),d.d("{93c7910}","{542f9d5}",r),e.$g$.setRemoteDescription({type:o.type,sdp:r}).then((()=>{var n,s;e.$ka$=Date.now()-c,function(e){let t=e.$g$.getTransceivers();if(0===t.length)d.d("{93c7910}","{3399d9d}"),Cs(e,{code:3237093909});else{for(const i of t)"3"===i.mid&&i.receiver.track.id!==e.$ua$?(d.i("{93c7910}","{981392f}"),i.receiver.track.enabled=!1):e.$P$.push(i.receiver.track.id);d.d("{93c7910}","{648ae93}",JSON.stringify(e.$P$))}}(e),d.d("{93c7910}","{ab7b3af}",e.$ka$),function(e){for(const t of e.$o$)"stream_id"===t.streamId&&2===e.$o$.length?t.streamId="app_video_stream":"stream_id"===t.streamId?t.streamId="app_media_stream":"second_stream_id"===t.streamId&&(t.streamId="app_audio_stream")}(e),qs()&&function(e){var t=e.$o$.find((e=>"app_media_stream"===e.streamId));if(t)Ds(e,t,e.$videoElement$),d.i("{93c7910}","{a5e354c}");else{t=e.$o$.find((e=>"app_video_stream"===e.streamId));var i=e.$o$.find((e=>"app_audio_stream"===e.streamId));if(t&&i){const n={streamId:"app_media_stream",tracks:t.tracks.concat(i.tracks)};e.$o$.splice(e.$o$.indexOf(t),1),e.$o$.splice(e.$o$.indexOf(i),1),e.$o$.push(n),Ds(e,n,e.$videoElement$),d.i("{93c7910}","{e2dc4ec}")}else t?(Ds(e,t,e.$videoElement$),d.i("{93c7910}","{07f3411}")):i?(Ds(e,i,e.$audioElement$),d.i("{93c7910}","{243a50b}")):d.w("{93c7910}","{c3a2679}")}}(e),null===(s=(n=e).$S$)||void 0===s||s.start(n.$g$),function(e){try{if(e.$g$&&e.sendVideoTrack){const t=e.$g$.getTransceivers().find((e=>"video"===e.receiver.track.kind));if(t){let i="",n=t.direction;"sendrecv"!==t.direction&&(t.direction="sendrecv",i=" ("+n+" direction is overridden by sendrecv)"),t.sender.replaceTrack(e.sendVideoTrack).then((()=>{d.i("{93c7910}","{b54f651}",i)})).catch((e=>{t.direction!==n&&(t.direction=n),d.w("{93c7910}","{d225159}",e)}))}else d.w("{93c7910}","{8272b59}")}}catch(e){d.w("{93c7910}","{66082ec}",e)}}(e),function(e,t){var i,n,s;const o=e.$g$.getTransceivers().find((e=>"video"===e.receiver.track.kind&&("recvonly"===e.direction||"sendrecv"===e.direction)));if(o)if(RTCRtpReceiver.getCapabilities&&RTCRtpSender.getCapabilities&&o.setCodecPreferences){var r=[t,"flexfec-03","rtx"];if(t=null===(i=RTCRtpReceiver.getCapabilities("video"))||void 0===i?void 0:i.codecs,i=[],t){for(const e of r)(r=t.filter((t=>t.mimeType==="video/"+e)))&&i.push.apply(i,r);try{o.setCodecPreferences(i)}catch(t){xs(e,"Failed to set codec preferences to receiver capabilities",t);try{i=i.concat(null!==(s=null===(n=RTCRtpSender.getCapabilities("video"))||void 0===n?void 0:n.codecs)&&void 0!==s?s:[]),o.setCodecPreferences(i)}catch(t){xs(e,"Failed to set codec preferences to sender and receiver capabilities",t)}}}}else d.w("{93c7910}","{274c489}")}(e,$),c=Date.now(),e.$g$.createAnswer().then((n=>{e.$ia$=Date.now()-c,d.d("{93c7910}","{2984003}",e.$ia$);const s=e.$u$.video[0].$maximumBitrateKbps$.toString(),o=e.$u$.video[0].$minimumBitrateKbps$.toString(),a=e.$u$.video[0].$initialBitrateKbps$.toString();if(d.d("{93c7910}","{b535c15}",n.sdp),void 0!==n.sdp){n.sdp=function(e,t){let i=e.split("\r\n"),n=-1;for(let e=0;e<i.length;e++)if(0===i[e].indexOf("m=video")){n=e;break}if(-1===n)return d.e("{93c7910}","{e0899ab}","video"),e;for(d.d("{93c7910}","{5cc346f}","video",n),n++;0===i[n].indexOf("i=")||0===i[n].indexOf("c=");)n++;return 0===i[n].indexOf("b")?(d.d("{93c7910}","{e77177e}",n),i[n]="b=AS:"+t,i.join("\r\n")):(d.d("{93c7910}","{3dfc348}",n),(e=i.slice(0,n)).push("b=AS:"+t),(e=e.concat(i.slice(n,i.length))).join("\r\n"))}(n.sdp,s),window.chrome&&(n.sdp=ms(n.sdp,o,s,a)),n.sdp=function(e){var t=[];let i=e.split("\r\n");var n="-1";let s;for(let e=0;e<i.length;e++)0===i[e].indexOf("a=rtpmap:")?(s=i[e].split(" ")[1],0===s.indexOf("opus")&&(n=i[e].split(" ")[0].slice(9),d.i("{93c7910}","{c3dd71b}","audio",n))):0===i[e].indexOf("a=fmtp:"+n+" ")&&(t.push(e),n="-1");if(0===t.length)return d.e("{93c7910}","{115f256}","audio"),e;e=-1,n=[];for(const s of t)t=i[s],d.d("{93c7910}","{9bb0e6f}",t),t+=";stereo=1",d.d("{93c7910}","{4f021eb}",t),(n=n.concat(i.slice(e+1,s))).push(t),e=s;return(n=n.concat(i.slice(e+1))).join("\r\n")}(n.sdp);const e=function(e){e=e.split("\r\n");var t=-1;for(i=0;i<e.length;i++)if(0===e[i].indexOf("m=audio")){t=i;break}if(-1===t)d.d("{93c7910}","{a939549}","audio");else{var i=void 0,n=void 0,s=void 0,o=void 0;for(a=t+1;a<e.length;a++)if(0===e[a].indexOf("a=rtpmap:")){var r=e[a].split(" ")[1];0===r.indexOf("red")?(n=e[a].split(" ")[0].slice(9),o=r.split("/")[2],d.i("{93c7910}","{4e6ce55}","audio",n,o)):0===r.indexOf("multiopus")&&(i=e[a].split(" ")[0].slice(9),s=r.split("/")[2],d.i("{93c7910}","{53ebbb1}","audio",i,s))}else if(0===e[a].indexOf("m=")){d.d("{93c7910}","{9fc6964}",e[a]);break}if(i){r=[];var a=[];for(t+=1;t<e.length;t++)if(0===e[t].indexOf("a=rtpmap:"+n)||0===e[t].indexOf("a=rtcp-fb:"+n)||0===e[t].indexOf("a=fmtp:"+n))a.push(e[t]);else if(0===e[t].indexOf("a=rtpmap:"+i)||0===e[t].indexOf("a=rtcp-fb:"+i)||0===e[t].indexOf("a=fmtp:"+i))r.push(e[t]);else if(0===e[t].indexOf("m=")){d.d("{93c7910}","{9fc6964}",e[t]);break}return o&&o!==s&&(n=void 0,a=[],d.w("{93c7910}","{ad53601}",o,s)),{$fmtRed$:n,$fmtCodec$:i,$specificationRed$:a.join("\r\n"),$specificationCodec$:r.join("\r\n")}}d.d("{93c7910}","{cf4ee2d}","audio")}}(r);e&&(n.sdp=function(e,t){let i=e.split("\r\n"),n=-1,s=-1;for(o=0;o<i.length;o++)if(0===i[o].indexOf("m=audio")){n=o;break}if(-1===n)return d.d("{93c7910}","{e0899ab}","audio"),e;var o=i.slice(0,n);let r=i[n].split(" ");if("0"!==r[3])return d.d("{93c7910}","{794b3c6}","audio",r.join(" ")),e;for(t.$fmtRed$?(r[3]=t.$fmtRed$,r[4]=t.$fmtCodec$):r[3]=t.$fmtCodec$,o.push(r.join(" ")),e=n+1;e<i.length;e++)if(0===i[e].indexOf("m=")){s=e;break}return-1===s&&(s=i.length-1),o=o.concat(i.slice(n+1,s)),t.$fmtRed$&&(o=o.concat(t.$specificationRed$.split("\r\n"))),(o=(o=o.concat(t.$specificationCodec$.split("\r\n"))).concat(i.slice(s))).join("\r\n")}(n.sdp,e)),d.d("{93c7910}","{1a048a7}",n.sdp)}c=Date.now(),e.$g$.setLocalDescription(n).then((()=>{if(e.$ja$=Date.now()-c,d.d("{93c7910}","{de86c01}",e.$ja$),void 0===n.sdp||window.chrome||(n.sdp=ms(n.sdp,o,s,a)),void 0!==n.sdp&&i){var r=(h=g(n.sdp)).shift(),$=h[0],l=r,u=v($+l,"a=ice-ufrag:")[0];$=v($+l,"a=ice-pwd:")[0],u=u.substr(12),$=$.substr(10);var h=v(h[0]+r,"a=fingerprint:").map(A);(r=g(i))[0]+="a=general.icePassword:"+$+"\r\n",r[0]+="a=general.iceUserNameFragment:"+u+"\r\n",r[0]+="a=general.dtlsFingerprint:"+h[0].value+"\r\n",i=r.join("")}Ns(e,t,{type:n.type,sdp:n.sdp,nvstSdp:i}),d.i("{93c7910}","{bd70666}",JSON.stringify(e.$o$)),Vs(e)})).catch((t=>{d.e("{93c7910}","{ba2deaa}",t),Ps(e,3237093902)}))})).catch((e=>{d.d("{93c7910}","{40c0f69}",e)}))})).catch((t=>{d.e("{93c7910}","{ec2853e}",t),Ps(e,3237093902)}))}else if(o.candidate){d.d("{93c7910}","{cf4c103}");let t=Us(e,o.candidate);d.d("{93c7910}","{43e80e0}",t),e.$g$.addIceCandidate({sdpMLineIndex:o.sdpMLineIndex,sdpMid:o.sdpMid,candidate:t}).then((()=>{d.d("{93c7910}","{db0ae14}"),e.$ca$=!0})).catch((t=>{d.e("{93c7910}","{62f207e}",t),e.$j$.$emitDebugEvent$("AddCandidateFailed",null==t?void 0:t.name,null==t?void 0:t.message)})),d.d("{93c7910}","{9454009}")}}catch(t){"BYE"===i?Ps(e,15868672):(d.e("{93c7910}","{93367fc}",t),e.$j$.$g$(t,"Invalid handlePeerMessage Response","{93c7910}.ts",0,0,!0))}}(e,t.peer_msg.from,t.peer_msg.msg):t.error&&("peerRemoved"===t.error?(0!==e.$A$?(t=null!==(i=Is(e))&&void 0!==i?i:3237094161,d.w("{93c7910}","{cbb35d3}")):t=3237094159,Ps(e,t)):Ps(e,3237094160))}function vs(e){var t;0!==e.$v$&&(window.clearTimeout(e.$v$),e.$v$=0,e.$va$=Date.now()-e.$wa$),e.$C$||0!==e.$A$||((t=e).$A$=window.setTimeout((()=>{var e;t.$A$=0,d.i("{93c7910}","{d22df91}"),Ps(t,null!==(e=Is(t))&&void 0!==e?e:3237093895)}),3e4),t.$ya$=Date.now())}function As(e,t){var i,n=vt;n.$h$&&(n.perf.DCSend+=t),null===(i=e.$h$)||void 0===i||((e=i.$g$).$j$.value+=t,e.$j$.count+=1,e.$j$.max=Math.max(t,e.$j$.max))}function bs(e){if(Gs(e))return e.$h$.$J$}function ws(e,t){e.$U$.innerHTML=t,e.$U$.style.display="block",e.$F$&&clearTimeout(e.$F$),e.$F$=window.setTimeout((()=>{e.$U$.style.display="none"}),1e3)}function Ss(e,t,i){const n=t.label;let s=!1;t.onopen=()=>{var t;d.d("{93c7910}","{8e9ee5d}",n),null===(t=i.open)||void 0===t||t.call(i),i.errorCode&&Vs(e)},t.onclosing=()=>{d.d("{93c7910}","{d0c8ae7}",n),s=!0},t.onclose=()=>{var t;d.d("{93c7910}","{a3c9826}",n),null===(t=i.close)||void 0===t||t.call(i),i.errorCode&&Rs(e)},t.onerror=o=>{if(d.e("{93c7910}","{fcd64bb}",n),s&&i.errorCode)Rs(e)||Ps(e,15867907);else{var r=t.bufferedAmount;o=null==o?void 0:o.error,e.$W$||e.$j$.$emitDebugEvent$("ChannelError",n,null==o?void 0:o.name,null==o?void 0:o.message,null==r?void 0:r.toString()),d.e("{93c7910}","{db7ae96}",n,null==o?void 0:o.name,null==o?void 0:o.message),i.errorCode&&Ps(e,i.errorCode)}}}function ys(){d.d("{93c7910}","{440d709}",vt.$j$,performance.timeOrigin)}function ks(e){var t=1;for(let e=1;10>e;e++)t*=10;t=(t=""+Math.floor(Math.random()*t)).padEnd(10,"0"),e.name="peer-"+t,d.d("{93c7910}","{f2b789d}",e.name),e.$O$=e.$Ca$+"/sign_in?peer_id="+e.name+"&version=2",d.d("{93c7910}","{05b8afd}",e.$O$)}function Cs(e,t){var i,n;e.$C$||(e.$xa$=Date.now()-e.$ya$,void 0===t?(null===(n=e.$G$)||void 0===n||n.uninitialize(4001),e.$G$=void 0,vt.startWebSocket(e.$O$,e.maxReceivedAckId,e.$N$,e,!0),ut.$statsUploadEnabled$&&Ms(e)):function(e){var t,i,n,s,o,r,a,$,c;const l=e=>{var t,i;return(null!==(t=null==e?void 0:e.get("TCP"))&&void 0!==t?t:0)+(null!==(i=null==e?void 0:e.get("IPV6"))&&void 0!==i?i:0)};var u=(e,t)=>{let i=0;if(t){e=`${e} local candidates:`;for(const[n,s]of t)i+=s,e+=` ${t=n}: ${s}`;d.i("{93c7910}","{0b0c6f9}",e)}return i};const h=null===(t=e.$h$)||void 0===t?void 0:function(e){let t=new Vn;if(!e.$j$)return t;for(const i of e.$j$.values())"local-candidate"===i.type&&(e=Xn(i),t.set(e,t.get(e)+1));return t}(t);t=u("event",e.$T$);const p=u("stats",h);u=t-e.$ra$;let m="";const f=null===(i=e.$g$)||void 0===i?void 0:i.getReceivers().find((e=>"video"===e.track.kind&&e.track.enabled));(i=null===(r=null===(o=null===(s=null===(n=null==f?void 0:f.$transport$)||void 0===n?void 0:n.$iceTransport$)||void 0===s?void 0:s.getSelectedCandidatePair)||void 0===o?void 0:o.call(s))||void 0===r?void 0:r.local)&&(m=`category: ${Xn(i)}, type: ${i.type}`),io(e.$j$,"LocalCandidatesCategories",m,t,t-l(e.$T$),p,p-l(h)),n=null!==($=null===(a=e.$h$)||void 0===a?void 0:function(e){let t=new Set;if(!e.$j$)return t;for(const i of e.$j$.values())"local-candidate"===i.type&&"IPV4"===Xn(e=i)&&"UNKNOWN"!==(e=Qn(e))&&t.add(e);return t}(a))&&void 0!==$?$:new Set,io(e.$j$,"LocalCandidateRanges",`${null===(c=e.$g$)||void 0===c?void 0:c.iceGatheringState}`,u,null==n?void 0:n.size,e.$aa$.size,new Set([...n,...e.$aa$]).size)}(e),e.$C$=!0,0!==e.$A$&&(window.clearTimeout(e.$A$),e.$A$=0),t={sessionId:e.$session$.sessionId,subSessionId:e.$session$.subSessionId,streams:e.$o$,streamInfo:e.$session$.streamInfo,error:t,zoneName:e.$session$.zoneName,zoneAddress:e.$session$.zoneAddress,gpuType:e.$session$.gpuType,isResume:null!==(i=e.isResume)&&void 0!==i&&i},gr(e.$Z$,t),e.$$$.send())}function _s(e,t){var i;try{if("open"===(null===(i=e.$J$)||void 0===i?void 0:i.readyState)){let i=performance.now();e.$J$.send(JSON.stringify(t)),As(e,performance.now()-i)}else d.w("{93c7910}","{593db1b}")}catch(t){d.e("{93c7910}","{a585a6e}",t),e.$j$.$g$(t,"sendControlMessage exception","{93c7910}.ts",0,0,!0)}}function Es(e){e.$m$&&(e.$m$.uninitialize(),e.$m$=void 0)}function Ts(e){var t;null===(t=e.$h$)||void 0===t||t.stop()}function Is(e){var t;let i;switch(e.videoStreamProgress){case 0:case 2:break;case 3:i=3237093922;break;case 5:i=3237093923;break;case 7:i=3237093924;break;default:i=3237093925}if(null===(t=e.$h$)||void 0===t)var n=void 0;else e:{if(t.$j$){var s=n=0,o=0,r=0;for(const e of t.$j$.values())"candidate-pair"===e.type&&(n+=(t=e).requestsSent+t.consentRequestsSent,s+=t.responsesReceived,t.$nominated$&&o++,"succeeded"===t.state&&r++);if(d.i("{5cea617}","{47c0ce7}",n,s),0<n&&0===s){n=3237093926;break e}if(!o){n=3237093927;break e}if(!r){n=3237093928;break e}}n=void 0}return e.id?e.$qa$?e.$ba$?e.$M$?e.$ca$?e.$pa$?n?i=n:"connecting"===Ys(e.$B$)?i=3237093919:"connecting"===Ys(e.$K$)?i=3237093920:"connecting"===Ys(e.$J$)&&(i=3237093921):i=3237093903:i=3237093904:i=3237093905:i=3237093914:i=3237093913:i=3237093912,i}function Ps(e,t){var i;if(!e.$W$){if(e.$W$=!0,Es(e),Ts(e),e.$C$){let n={sessionId:e.$session$.sessionId,subSessionId:e.$session$.subSessionId,error:{code:t},zoneName:e.$session$.zoneName,zoneAddress:e.$session$.zoneAddress};e.$j$.$emitDebugEvent$("SignalingState",y(t),null===(i=e.$g$)||void 0===i?void 0:i.signalingState),d.i("{93c7910}","{89d3ea6}",e.$g$.signalingState),function(e,t){var i,n,s;mo(e.$m$),d.d("{9d1820c}","{a94b484}");let o=Ao(e.$C$,t.error.code);o&&(t.error.code=_t(t.error.code,e.$platformDetails$)),e.framesDecoded=null!==(n=null===(i=e.$h$)||void 0===i?void 0:Ws(i))&&void 0!==n?n:0,t.zoneAddress||(t.zoneAddress=e.$j$.serverAddress),Br(e,null===(s=t.error)||void 0===s?void 0:s.code).then((i=>{var n;t.error.code=i.errorCode,i=Sr(e,t,performance.now()-e.startTime,i.connectivity,o),e.$I$=null===(n=t.error)||void 0===n?void 0:n.code,io(e.$l$,"HotPlug","",0,e.$H$,0,0),e.$H$=0,Or(e,t,!1,i)}))}(e.$Z$,n)}else Cs(e,{code:t});d.e("{93c7910}","{573fb24}",y(t))}}function js(e){e.$G$=new as(e.$session$.sessionId,e.$session$.accessToken||"",{$wsHandler$:e,$logCallback$:{info:e.$Ga$.bind(e),exception:e.$Fa$.bind(e)}}),e.$G$.initialize(e.$O$,e.maxReceivedAckId,e.$N$)}function Rs(e){let t=!1;return window.chrome&&"closed"===e.$g$.signalingState&&(t=!0,Ps(e,15867908)),t}function Ds(e,t,i){e=e.$g$.getTransceivers().map((e=>e.receiver.track)),e=new MediaStream(e.filter((e=>t.tracks.find((t=>t.trackId===e.id))))),i.srcObject=e}function xs(e,t,i){d.w("{93c7910}","{4d3c418}",t,i),e.$j$.$g$(i,t,"{93c7910}.ts",0,0,!0)}function Ms(e){var t={stats:{from:e.id,to:e.$fa$}},i=vt;i.$h$=!1,t={startStats:{statsHeader:t}},i.$g$&&(d.d("{1f5ec29}","{6897d5e}"),i.$g$.postMessage(t)),e.$ea$=!0}function Ls(e,t){"connecting"===Ys(e.$J$)?e.$V$.push(t):_s(e,t)}function Os(e,t,i){var n;2===t&&(null===(n=e.$m$)||void 0===n||Li(n,!0)),d.d("{93c7910}","{5ba6173}",t,i),e.$D$.emit("StreamingEvent",{streamingWarnings:{code:t,secondsLeft:i}})}function Bs(e,t,i){t.candidate?(i||(i=Xn(t.candidate),e.$T$.set(i,e.$T$.get(i)+1),"IPV4"===i&&"UNKNOWN"!==(i=Qn(t.candidate))&&e.$aa$.add(i)),"tcp"===t.candidate.protocol?d.d("{93c7910}","{6f19d1e}"):(d.d("{93c7910}","{ac052fa}",t.candidate.port,t.candidate.protocol),Ns(e,e.$fa$,{sdpMLineIndex:t.candidate.sdpMLineIndex,sdpMid:t.candidate.sdpMid,candidate:t.candidate.candidate}),e.$pa$=!0)):d.d("{93c7910}","{a759d16}")}function Ns(e,t,i){const n=JSON.stringify(i);i={peer_msg:{from:e.id,to:t,msg:n},ackid:e.$N$?e.$ma$.$g$++:void 0},d.d("{93c7910}","{7ecb902}",t,n.length,JSON.stringify(i)),e.$G$?e.$G$.send(i):(e=vt).$g$&&e.$g$.postMessage({send:i})}function Fs(e,t){let i=0;e.$s$.$h$&&(i|=2),e.$s$.$l$&&(i|=1),e.$s$.$j$&&(i|=16),Ls(e,{windowState:{streamIndex:0,frameNumber:t,windowStateFlags:i}})}function Vs(e){0<e.$P$.length&&"connecting"!==Ys(e.$J$)&&"connecting"!==Ys(e.$K$)&&"connecting"!==Ys(e.$B$)&&function(e){let t=[];for(const i of e.$o$)for(const e of i.tracks)t.push(e.trackId);if(e.$P$.length!==t.length)return!1;for(const i of e.$P$)if(!t.some((e=>e===i)))return!1;return d.d("{93c7910}","{4fef10b}"),!0}(e)&&Cs(e)}function Us(e,t){return d.d("{93c7910}","{2dd62a2}"),(e=e.$session$.mediaConnectionInfo.find((e=>2===e.usage)))?((t=t.split(" "))[4]=e.ip,t[5]=""+e.port,t=t.join(" "),d.d("{93c7910}","{1fbcd88}",t),t):(d.d("{93c7910}","{aee7283}"),t)}function Gs(e){return!(!e.$h$||0==e.$h$.$l$)}function Hs(e){var t;null===(t=e.$h$)||void 0===t||0!=t.$l$&&(t.reset(),Wn(t,!1))}function zs(e){var t;null===(t=e.$h$)||void 0===t||0!=t.$l$||Un(t)}function Ws(e){return e.$h$?e.$h$.$s$:0}function Ks(e){return e.$h$?""===(e=e.$h$.$R$)?"PENDING":e:"UNKNOWN"}var Js=class{constructor(e,t,i,n,s,o,r,a,$,c,l,u,h,p,m,f,g){var v;let A;this.name="",this.id=0,this.$u$={video:[],$clientCapture$:0},this.$fa$=-1,this.$C$=this.$W$=!1,this.$A$=this.$F$=this.$l$=0,this.$ea$=!1,this.$v$=this.$la$=0,this.$M$=this.$ba$=this.$ca$=this.$pa$=this.$qa$=!1,this.$oa$=!0,this.stutterIndicator=this.perfIndicator=!1,this.$ga$=0,this.$P$=[],this.$o$=[],this.$O$="",this.$ha$=0,this.$N$=!1,this.$ma$=new class{constructor(){this.$g$=1}},this.$wa$=this.$ia$=this.$ja$=this.$ka$=0,this.$ya$=Date.now(),this.$ta$=this.$xa$=this.$va$=0,this.$da$=!1,this.keyboardLayout="",this.videoStreamProgress=this.maxReceivedAckId=0,this.$V$=[],this.$ua$="",this.$H$=this.$Ea$.bind(this),this.$ra$=0,this.$T$=new Vn,this.$sa$=this.$Da$.bind(this),this.$aa$=new Set,this.$platformDetails$=$,this.$videoElement$=t,this.$audioElement$=i,this.$na$=n,this.$D$=e,d.d("{93c7910}","{e1ca54d}",JSON.stringify(c)),this.$session$=c,this.accessToken=l,ut.maxBitrate?(A=ut.maxBitrate,d.d("{93c7910}","{55e5b30}",A)):null!=u&&u.maxBitrateKbps&&(A=null==u?void 0:u.maxBitrateKbps,d.d("{93c7910}","{965049f}",A));for(const e of c.streamInfo)null!=A?i=A:(i=At(e.width,e.height,e.fps),d.d("{93c7910}","{aff4184}",i)),i=Math.max(4e3,i),n=Math.max(4e3,Math.round(i/4)),this.$u$.video.push({$clientViewportWd$:e.width,$clientViewportHt$:e.height,$maxFps$:e.fps,$drcDfcEnabled$:null==u?void 0:u.drc,$maximumBitrateKbps$:i,$initialBitrateKbps$:n,$initialPeakBitrateKbps$:n,$mapRtpTimestampsToFrames$:!0,$minimumBitrateKbps$:4e3,sdrHdrMode:e.sdrHdrMode});this.$Ba$=async function(e,t){var i;let n=[];const s=null!==(i=ut.codecList)&&void 0!==i?i:ut.$ragnarokConfig$.codecList;if(s)for(const e of s)n.push(e);else e=async function(e,t){var i,n,s;const o=null!==(n=null!==(i=ut.enableAv1Support)&&void 0!==i?i:ut.$ragnarokConfig$.enableAv1Support)&&void 0!==n&&n;return i=null!==(s=ut.$ragnarokConfig$.enableAv1ByResolutionAndFps)&&void 0!==s?s:7,!(!o||4953600<=e.width*e.height&&!(4&i)||Tt(e.width,e.height)&&!(2&i)||!(120!==e.fps||1&i))&&(C(t)&&null!=window.lge_webrtc_av1_support?window.lge_webrtc_av1_support:!(null==(e=await wn())||!e.powerEfficient))}(e,t),t=async function(e){return C(e)&&null!=window.lge_webrtc_hevc_support?window.lge_webrtc_hevc_support:"Tizen"===e.os||(e=yn,!(null==(e=await(e.$u$?Promise.resolve(e.$u$):e.$h$?e.$h$:e.$o$()))||!e.powerEfficient))}(t),await e&&n.push("AV1"),await t&&n.push("H265"),n.push("H264");return n}(null!==(v=this.$session$.streamInfo[0])&&void 0!==v?v:{width:0,height:0,fps:0},this.$platformDetails$),Ot(),this.$j$=a,this.$za$=s,this.$Z$=e,this.$Aa$=o,this.$R$=r,this.$I$=h,this.textInputElement=p,this.appLaunchMode=c.appLaunchMode,this.clientAppVersion=m,this.isResume=f,this.$requestedRegion$=g,this.sendVideoTrack=null==u?void 0:u.sendVideoTrack,e=(e=this.$session$.signalConnectionInfo.protocol).replace("http","ws"),this.$Ca$=e+"://"+this.$session$.signalConnectionInfo.ip+":"+this.$session$.signalConnectionInfo.port,vt.initialize(this.$session$.sessionId,this.$j$,this.$ma$),this.$$$=new class{constructor(e,t,i,n){this.$m$=e,this.$videoElement$=t,this.$platformDetails$=i,this.$l$=n,this.$h$={top:-1,left:-1,bottom:-1,right:-1},this.$leftPadding$=this.$topPadding$=0,this.$j$=!1,this.$o$=0,ut.isInternalUser&&((e=document.createElement("div")).style.display="none",e.style.position="absolute",e.style.color="white",e.style.backgroundColor="rgb(105, 105, 105, 0.7)",e.style.padding="2px",e.style.bottom="0px",e.style.left="0px",e.style.margin="5px",this.$g$=e,t.insertAdjacentElement("afterend",this.$g$))}uninitialize(){this.$g$&&this.$g$.remove()}send(){var e,t,i;if(!(0>=this.$videoElement$.videoHeight||0>=this.$videoElement$.videoWidth)){var n=yt(),s=function(e,t){let{width:i,height:n}={width:screen.width,height:screen.height};var s=()=>{let e;switch(void 0!==window.orientation?e=window.orientation:screen.orientation&&(e=screen.orientation.angle),e){case 90:case-90:case 270:return!1;default:return!0}};w(e.$platformDetails$)&&!s()&&(s=i,i=n,n=s),s=(t=>{let i=t.offsetTop,n=t.offsetLeft;for(var s=t.offsetParent;s;)i+=s.offsetTop,n+=s.offsetLeft,s=s.offsetParent;s=t.clientHeight;let o=t.clientWidth;return"Android"===e.$platformDetails$.os&&(window.innerHeight>window.innerWidth&&t.clientHeight<t.clientWidth||window.innerHeight<window.innerWidth&&t.clientHeight>t.clientWidth)&&(d.w("{48f82fd}","{c9d343e}"),s=t.clientWidth,o=t.clientHeight),{top:i,left:n,bottom:Math.max(window.innerHeight-i-s,0),right:Math.max(window.innerWidth-n-o,0)}})(e.$videoElement$);const o=Math.max(n-window.innerHeight,0)/2,r=Math.max(i-window.innerWidth,0)/2;return{top:Math.max(t.top-o-s.top-e.$topPadding$,0)/(e.$videoElement$.clientHeight-2*e.$topPadding$),left:Math.max(t.left-r-s.left-e.$leftPadding$,0)/(e.$videoElement$.clientWidth-2*e.$leftPadding$),bottom:Math.max(t.bottom-o-s.bottom-e.$topPadding$,0)/(e.$videoElement$.clientHeight-2*e.$topPadding$),right:Math.max(t.right-r-s.right-e.$leftPadding$,0)/(e.$videoElement$.clientWidth-2*e.$leftPadding$)}}(this,n);if(!function(e,t){const i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;for(const n of i)if(e[n]!==t[n])return!1;return!0}(s,this.$h$)){var o=JSON.stringify(s,((e,t)=>t.toFixed?Number(t.toFixed(2)):t));d.d("{48f82fd}","{054b8b0}",JSON.stringify(n),o),null!==(e=ut.$ragnarokConfig$.sendInsetValueUpdateEvents)&&void 0!==e&&e&&2>this.$o$++&&(n=(e=(e,t=1)=>{for(const i of Object.keys(e)){const n=Math.round(e[i]*t);e[i]=isNaN(n)?-1:n}return e})(Object.assign({},n)),e=e(Object.assign({},s),1e3),null===(t=this.$l$)||void 0===t||io(t,"InsetValueUpdate","Original",n.top,n.left,n.bottom,n.right),null===(i=this.$l$)||void 0===i||io(i,"InsetValueUpdate","Normalized",e.top,e.left,e.bottom,e.right)),this.$h$=Object.assign({},s);for(const e of Object.keys(s))s[e]=isNaN(s[e])?0:s[e];t={messageType:"SAFE_ZONE",messageRecipient:"NvGridSvc:NGS",data:JSON.stringify({safeZoneData:{type:"InsetValueUpdate",rect:s}})},this.$m$.sendCustomMessage(t),ut.isInternalUser&&this.$g$&&(this.$g$.innerText="Safe Zone: \nTop: "+(100*Math.max(this.$h$.top,0)).toFixed()+"%\nRight: "+(100*Math.max(this.$h$.right,0)).toFixed()+"%\nBottom: "+(100*Math.max(this.$h$.bottom,0)).toFixed()+"%\nLeft: "+(100*Math.max(this.$h$.left,0)).toFixed()+"%")}}}}(this,t,this.$platformDetails$,this.$j$),this.$s$=new class{constructor(e){var t,i,n,s;this.$g$=new Map,this.$j$=!1,this.$B$="PHONE"===e.deviceType||"TABLET"===e.deviceType,this.$h$=this.$l$=document.hasFocus();const o=null!==(i=null===(t=null==(e=window.zoneless)?void 0:e.windowAddEventListener)||void 0===t?void 0:t.bind(window))&&void 0!==i?i:window.addEventListener.bind(window),r=null!==(s=null===(n=null==e?void 0:e.documentAddEventListener)||void 0===n?void 0:n.bind(document))&&void 0!==s?s:document.addEventListener.bind(document);this.$s$=this.$D$.bind(this),this.$o$=this.$C$.bind(this),this.$u$=this.$m$.bind(this),this.$v$=this.$F$.bind(this),this.$A$=this.$G$.bind(this),o("focus",this.$s$),o("blur",this.$o$),["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","msfullscreenchange"].forEach((e=>r(e,this.$u$))),r("mouseenter",this.$v$),r("mouseleave",this.$A$),this.$g$.set(0,[]),this.$g$.set(2,[]),this.$g$.set(1,[]),this.$m$()}uninitialize(){var e,t,i,n;const s=window.zoneless,o=null!==(t=null===(e=null==s?void 0:s.windowRemoveEventListener)||void 0===e?void 0:e.bind(window))&&void 0!==t?t:window.removeEventListener.bind(window),r=null!==(n=null===(i=null==s?void 0:s.documentRemoveEventListener)||void 0===i?void 0:i.bind(document))&&void 0!==n?n:document.removeEventListener.bind(document);o("focus",this.$s$),o("blur",this.$o$),["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","msfullscreenchange"].forEach((e=>r(e,this.$u$))),r("mouseenter",this.$v$),r("mouseleave",this.$A$);for(const e of this.$g$.values())e.splice(0)}$D$(){hs(this,!0)}$C$(){hs(this,!1)}$m$(){var e=window.document;if(e=!!(document.fullscreen||1==e.webkitIsFullScreen||e.mozFullScreen||e.msFullscreenElement),this.$j$!==e){this.$j$=e;for(const t of this.$g$.get(2))t(e)}}$F$(){ps(this,!0)}$G$(){ps(this,!1)}}($),(t=document.createElement("div")).style.position="absolute",t.style.zIndex="300",t.style.left="0",t.style.top="0",t.style.width="100%",t.style.display="none",t.style.fontSize="3em",t.style.color="white",t.style.backgroundColor="gray",t.style.textAlign="center",this.$videoElement$.insertAdjacentElement("afterend",t),this.$U$=t}start(){!function(e){ks(e);let t=1e4;ut.$ragnarokConfig$.signInTimeout&&0!==ut.$ragnarokConfig$.signInTimeout&&(t=ut.$ragnarokConfig$.signInTimeout,d.i("{93c7910}","{4f2f101}",t)),e.$v$=window.setTimeout((()=>e.signInTimeout()),t),e.$wa$=Date.now(),js(e)}(this),vt.$j$=performance.now(),ys()}stop(e){var t,i,n;io(this.$j$,"StreamTimersAndReconnects",y(e),0,this.$va$,this.$xa$,this.$ta$);const s=t=>{d.i("{93c7910}","{a848987}",t),io(this.$j$,"PeerAPIDurationsAndMic",y(e),this.$ia$,this.$ka$,this.$ja$,t)};ro().then((e=>{s(e)})),Cs(this,{code:e,description:"Session stopped before stream connected"}),this.$F$&&(clearTimeout(this.$F$),this.$F$=0),this.$U$.remove(),this.$W$=!0;try{_s(this,{exitMessage:{code:rt(e)}})}catch(e){d.e("{93c7910}","{d337883}",e)}Es(this),this.$B$&&this.$B$.close(),Ts(this),null===(t=this.$g$)||void 0===t||t.removeEventListener("icecandidate",this.$sa$),this.$g$&&this.$g$.close(),function(e){var t;if(null===(t=e.$S$)||void 0===t);else{for(const e of t.streams){var i=(new Date).toISOString();i=`ragnarok-${e.$namePrefix$}-${i}.${e.$extension$}`,xt([new DataView(e.data.buffer,0,e.size)],i,"text/plain")&&d.i("{d7392d2}","{4b3378a}",i)}t.streams=[]}e.$S$=void 0}(this),0!==this.$A$&&(window.clearTimeout(this.$A$),this.$A$=0),0!==this.$v$&&(window.clearTimeout(this.$v$),this.$v$=0),mt(),null===(i=this.$G$)||void 0===i||i.uninitialize(),vt.stopWebSocket(),ys(),vt.$o$=void 0,this.$M$&&this.$oa$&&(d.e("{93c7910}","{283a180}"),this.$j$.$emitDebugEvent$("Audio track muted")),this.$ba$=this.$M$=!1,0<this.$la$&&io(this.$j$,"WebSocketClose","",0,this.$la$,0,0),null===(n=this.$I$)||void 0===n||n.uninitialize(),this.$$$.uninitialize(),us(this.$s$,0,this.$H$),us(this.$s$,1,this.$H$),us(this.$s$,2,this.$H$),this.$s$.uninitialize()}signInTimeout(){this.$v$=0,d.i("{93c7910}","{6d6b337}"),Cs(this,{code:3237093907})}$Ga$(e){d.i("{8ba4138}","{0b0c6f9}",e)}$Fa$(e){this.$j$.$g$(void 0,e,"{8ba4138}.ts",0,0,!0),d.e("{8ba4138}","{0b0c6f9}",e)}$Da$(e){d.d("{93c7910}","{4742d5e}"),e.candidate&&this.$ra$++,!window.chrome&&this.$g$&&this.$g$.canTrickleIceCandidates&&this.$g$.onicecandidate&&Bs(this,e,!0)}toggleOnScreenStats(e=!1){Gs(this)?this.$h$.toggleOnScreenStats(e):ws(this,"Stats is OFF. Please enable by ctrl+alt+F5/F6")}toggleUserInput(e,t){this.$m$?this.$m$.toggleUserInput(e,t):d.e("{93c7910}","{5a0e299}",e)}getVirtualGamepadHandler(){var e;return null===(e=this.$m$)||void 0===e?void 0:e.getVirtualGamepadHandler()}toggleStutterIndicator(){this.stutterIndicator=!this.stutterIndicator,Ls(this,{stutterIndicator:{on:this.stutterIndicator}})}sendTextInput(e){var t;null===(t=this.$m$)||void 0===t||t.sendTextInput(e)}setVirtualKeyboardState(e){var t;null===(t=this.$m$)||void 0===t||t.setVirtualKeyboardState(e)}setVideoTransforms(e,t,i){var n;if(null===(n=this.$m$)||void 0===n);else{const s=window.visualViewport;s&&(n.$g$.$viewportHeight$=s.height),Ni(n,e,t,i)}}sendCustomMessage(e){Ls(this,e={customMessage:JSON.stringify(e)})}setStreamingMaxBitrate(e,t){Ls(this,{setMaxBitrate:{streamIndex:e,maxBitrate:t}}),d.d("{93c7910}","{6bbc1a2}",t)}setDrcDfcState(e,t){Ls(this,{setDrcState:{streamIndex:e,state:t}}),Ls(this,{setDfcState:{streamIndex:e,state:t}}),d.d("{93c7910}","{0ed76f3}",t)}sendKeyEvent(e){var t;null===(t=this.$m$)||void 0===t||t.sendKeyEvent(e)}setKeyboardLayout(e){this.keyboardLayout=e,this.$m$?(this.sendCustomMessage({messageType:"kbLayout",messageRecipient:"KBLayoutChange",data:e}),this.$m$.setKeyboardLayout(e)):this.$da$=!0}$Ea$(){Gs(this)?Fs(this,this.$h$.$s$):d.w("{93c7910}","{76bcede}")}};function qs(){var e,t;return null===(t=null!==(e=ut.combineStreams)&&void 0!==e?e:ut.$ragnarokConfig$.combineStreams)||void 0===t||t}function Ys(e){var t;return null!==(t=null==e?void 0:e.readyState)&&void 0!==t?t:"connecting"}var Xs={clientName:"Ragnarok",clientId:"62677554106929725",eventSchemaVer:"3.0"},Qs=class extends De{constructor(e){super(e),this.name="Streamer_Start",this.gdprLevel="functional"}},Zs=class extends De{constructor(e){super(e),this.name="Streamer_Exit",this.gdprLevel="functional"}},eo=class extends De{constructor(e){super(e),this.name="Streamer_InputDevice",this.gdprLevel="functional"}},to=new class{constructor(){this.$j$=new Map([["Ethernet","ETHERNET"],["5GHz_WiFi","WIFI_5_0"],["2.4GHz_WiFi","WIFI_2_4"],["Others","OTHER"],["disconnected","UNKNOWN"]]),this.$g$="UNKNOWN",this.$h$=[],window.addEventListener("GFNNetworkInfo",(e=>{d.d("{aac1655}","{2925c9d}",e.detail.state),e=e.detail.state;const t=this.$j$.get(e);if(t){this.$g$=t;for(const e of this.$h$)e(this.$g$)}else d.d("{aac1655}","{ed2fb91}",e)}))}};function io(e,t,i,n,s,o,r){no(e,{name:(t=new Oe({metricName:t,moduleName:"RAGNAROK",valueInt1:s,valueInt2:o,valueInt3:r,valueString:i,valueDouble:n,networkType:to.$g$,cmsId:String(e.cmsId),sessionId:e.sessionId,subSessionId:e.subSessionId})).name,gdprLevel:t.gdprLevel,ts:t.ts,parameters:t.parameters,clientConfig:Xs})}function no(e,t){e.$o$.hasListener("TelemetryEvent")?e.$o$.emit("TelemetryEvent",t):ir(e.$h$,t)}function so(e,t){let i=!1;var n;e.clientShutDownCallback&&(i=e.clientShutDownCallback(t),d.d("{9838627}","{caf81d9}",i)),i||(d.d("{9838627}","{e939db1}"),e=e.$h$,d.d("{f7c1592}","{01dcfe5}",null===(n=t.parameters)||void 0===n?void 0:n.sessionId),dr(e,t),lr(ar(e,e.$h$.eventPayload)))}function oo(e,t,i,n,s,o,r,a,$){50<=e.$m$||(e.$m$++,no(e,{name:(t=new eo({deviceName:t,deviceType:"GAMEPAD",vendorId:i,productId:n,deviceIndex:s,reportIndex:r?0:s,hapticsSupported:jt(o),hapticsFeedbackCount:0,state:a,eventMapReceived:$,eventMapProcessed:$,sessionId:e.sessionId,subSessionId:e.subSessionId,cmsId:String(e.cmsId)})).name,gdprLevel:t.gdprLevel,ts:t.ts,parameters:t.parameters,clientConfig:Xs}))}function ro(){return!1===ut.$micEnabled$?Promise.resolve(0):window.navigator.permissions?window.navigator.permissions.query({name:"microphone"}).then((e=>{let t=2;return"granted"==(e=e.state)?t=5:"prompt"==e&&(t=1),t})).catch((()=>0)):Promise.resolve(0)}function ao(e,t,i=!0){e.$h$=t,3===e.$h$&&(e.$H$=!0),e.$B$&&i&&e.$B$.emit("MicCapture",{state:e.$h$})}function $o(e){if(e.$D$)if(fo){e.$micEnabled$=!1,e.paused=!0;var t=e.$h$;if(navigator.mediaDevices.ondevicechange=()=>{},e.$s$){d.d("{223689a}","{6faf5bb}");let n=po();var i=e.$s$.getSenders()[0];i?i.replaceTrack(n.getTracks()[0]).then((()=>{d.d("{223689a}","{797fa55}"),ao(e,5,!1),3===t&&(e.$A$=!0)})).catch((t=>{d.e("{223689a}","{79f26cc}",t),ao(e,7,!1)})).finally((()=>{let t=e.$g$;e.$g$=null,t&&t.getTracks().forEach((e=>{e.stop()})),ao(e,e.$h$),w(e.$platformDetails$)&&!B(e.$platformDetails$,!1,15,4)&&e.$o$()})):(d.e("{223689a}","{f7f0250}"),e.$g$=null)}else d.e("{223689a}","{9e75fa2}"),ao(e,0)}else ao(e,6)}function co(e,t){var i;e.$v$=!0,e.$l$.set(t,(null!==(i=e.$l$.get(t))&&void 0!==i?i:0)+1),d.d("{223689a}","{30f8637}",t)}async function lo(e,t){return e.$m$=!0,navigator.mediaDevices.getUserMedia({audio:t}).then((t=>{if(d.d("{223689a}","{b204737}"),ao(e,5,!1),e.$m$=!1,e.$g$=t,w(e.$platformDetails$)&&(t.getTracks()[0].onended=()=>{e.$J$=performance.now(),d.i("{223689a}","{6b60d82}"),$o(e)}),e.$g$.oninactive=()=>{d.d("{223689a}","{eee54f1}"),e.$C$.clear(),e.$g$=null},e.paused)d.d("{223689a}","{21e76e1}"),e.$g$=null,ao(e,7);else{var i=e.$s$.getSenders()[0];i?i.replaceTrack(t.getTracks()[0]).then((()=>{if(d.i("{223689a}","{6c92139}"),w(e.$platformDetails$)&&!B(e.$platformDetails$,!1,15,4)&&0==e.$videoElement$.muted){let t=null;e.$audioElement$.srcObject?t=e.$audioElement$.play():e.$videoElement$.srcObject&&(t=e.$videoElement$.play(),d.i("{223689a}","{ef4dea7}")),t?t.then((()=>{d.d("{223689a}","{5593cbe}"),e.$o$()})).catch((t=>{e.$o$();try{e.$G$.$emitDebugEvent$("WAR: Play Error",null==t?void 0:t.name,null==t?void 0:t.message),d.e("{223689a}","{69aae72}",null==t?void 0:t.name,null==t?void 0:t.message)}catch(e){}})):d.e("{223689a}","{b6a6508}")}ao(e,3),e.$A$=!1,B(e.$platformDetails$,!1,15,4)&&(e.$v$=!1,e.$F$=!1)})).catch((t=>{d.e("{223689a}","{5c42246}",t),e.$g$=null,ao(e,7)})):(d.e("{223689a}","{f7f0250}"),e.$g$=null)}})).catch((i=>{var n,s;w(e.$platformDetails$)&&!B(e.$platformDetails$,!1,15,4)&&e.$o$(),e.$m$=!1,i instanceof DOMException&&"NotAllowedError"===i.name?(d.e("{223689a}","{3f9bd66}"),ao(e,2),e.$F$&&!e.$v$&&co(e,"permissionDenied")):i instanceof DOMException&&"NotFoundError"===i.name?(d.e("{223689a}","{7f04869}"),ao(e,4)):(i instanceof DOMException&&"NotReadableError"===i.name?(e.$C$.add(null!==(n=t.deviceId)&&void 0!==n?n:"default"),d.e("{223689a}","{af7e08c}",null!==(s=t.deviceId)&&void 0!==s?s:"default",i.name,i.message),navigator.mediaDevices.enumerateDevices().then((i=>{for(const n of i)if("audioinput"===n.kind&&"default"!==n.deviceId&&!e.$C$.has(n.deviceId)){d.d("{223689a}","{655d8b0}",n.deviceId,n.label),t.deviceId=n.deviceId,lo(e,t);break}})).catch((e=>{d.e("{223689a}","{930e826}",e.name,e.message)}))):d.e("{223689a}","{c361fc5}",i.name,i.message),ao(e,7))}))}async function uo(e){if(e.$D$)if(fo){if(e.$micEnabled$=!0,null==e.$g$&&!e.$m$){e.paused=!1,ao(e,1,!1);var t={sampleRate:48e3};_(e.$platformDetails$)&&(t.googAutoGainControl2=!1),navigator.mediaDevices.ondevicechange=()=>{d.i("{223689a}","{50d0169}",!!e.$g$,e.$m$),null!=e.$g$||e.$m$||(d.d("{223689a}","{c849290}"),uo(e))},await lo(e,t),e.$u$||ho(e)}}else d.e("{223689a}","{999b07b}"),ao(e,6)}function ho(e){return navigator.mediaDevices.enumerateDevices().then((t=>{let i=0;d.d("{223689a}","{fa1ec18}",JSON.stringify(t));for(const e of t)"audioinput"==e.kind&&i++;switch(i){case 0:e.$u$="No Audio Input",e.$j$.$noAudioInput$++;break;case 1:e.$u$="Built-in Microphone",e.$j$.$builtInMic$++;break;default:e.$u$="Headset Microphone",e.$j$.$headsetMic$++}d.d("{223689a}","{0d14ab6}",e.$u$)})).catch((()=>{d.e("{223689a}","{21131d5}")}))}function po(){let e=Mt(48e3);if(e){let t=e.createMediaStreamDestination().stream.getAudioTracks()[0];return e.close(),t.enabled=!0,new MediaStream([t])}throw Error("Mic stream is not supported")}function mo(e){if(!1!==ut.$micEnabled$){if(null!=e.$g$){let t=e.$g$;e.$C$.clear(),e.$g$=null,navigator.mediaDevices&&(navigator.mediaDevices.ondevicechange=()=>{}),t.getTracks().forEach((e=>{e.stop()}))}e.$micEnabled$=!1,ao(e,5),io(e.$G$,"AudioInputType",e.$H$?"started":"not started",0,e.$j$.$noAudioInput$,e.$j$.$builtInMic$,e.$j$.$headsetMic$),B(e.$platformDetails$,!1,15,4)&&io(e.$G$,"LowAudioVolume","",0,e.$l$.get("permissionDenied"),e.$l$.get("visibilityChange"),e.$l$.get("deviceChange")),e.$s$=null,e.$B$=null,e.$videoElement$=null,e.$audioElement$=null,e.$D$=!1,e.$j$={$noAudioInput$:0,$builtInMic$:0,$headsetMic$:0};for(const[t]of e.$l$)e.$l$.set(t,0);e.$v$=!1,e.$A$=!1,e.$F$=!1,e.$H$=!1}}var fo=null!=navigator.mediaDevices&&(window.AudioContext||window.webkitAudioContext||!1);function go(e){d.i("{0f7a7d0}","{206f492}"),e.$m$&&(window.clearInterval(e.$m$),e.$m$=0)}function vo(e,t){if(e.$o$!==e.subSessionId){var i=e.$s$,n=y(e.$j$);no(i,{name:(t=new Be({eventSequence:t,sleepTime:e.sleepTime,error:n,timeToSleep:e.$g$-e.$l$,moduleName:"RAGNAROK",cmsId:String(i.cmsId),sessionId:e.sessionId,subSessionId:e.subSessionId})).name,gdprLevel:t.gdprLevel,ts:t.ts,parameters:t.parameters,clientConfig:Xs}),e.$o$=e.subSessionId}go(e)}function Ao(e,t){if(15868704===t||15859712===t)return go(e),!1;let i=(new Date).getTime();return e.$j$=t,e.$l$=i,d.i("{0f7a7d0}","{425293a}",String(i-e.$g$),e.$h$),1e4<i-e.$g$-1e4?(e.$h$=i,e.sleepTime=e.$h$-e.$g$-1e4,vo(e,"pse")):0!==e.$h$&&2e4>i-e.$h$?vo(e,"pspe"):15867909!==t&&15867908!==t||(e.$h$=i,vo(e,"other")),0!==e.$h$}function bo(e,t){let i=document.getElementById(e.$gamepadTesterElementId$);i?(i.remove(),e.$gamepads$=[],e.visible=!1):(t.insertAdjacentElement("afterend",wo(e)),e.start())}function wo(e){let t=document.createElement("div");return t.id=e.$gamepadTesterElementId$,t.className="genericdiv",t.style.display="block",e.visible=!0,(e=document.createElement("p")).style.color="white",e.style.position="relative",e.innerHTML="Connected GamePads:",t.appendChild(e),(e=document.createElement("style")).appendChild(document.createTextNode(".gamepad:nth-child(even) { float:left; clear: left; }")),e.appendChild(document.createTextNode(".gamepad:nth-child(odd) { float:right; clear: right; }")),document.head.appendChild(e),t}var So=class{constructor(e){this.$g$=e}enable(){this.$g$.$v_enabled$=!0}disable(){this.$g$.$v_enabled$=!1}updateInput(e,t,i){this.$g$.$v_enabled$&&(ct($t()),this.$g$.$v_buttons$=e,this.$g$.$v_trigger$=t,this.$g$.$v_axes$=i,this.$g$.$v_updated$=!0)}};class yo{constructor(e){this.buttons=e.$getButtonMapping$(e.$device$),this.axes=e.$getAxesMapping$(e.$device$),this.$triggers$=e.$getTriggerMapping$(e.$device$),this.timestamp=performance.now()}}const ko={startDelay:0,duration:0,weakMagnitude:0,strongMagnitude:0};function Co(e,t){-1<(t=e.$l$.indexOf(t))&&e.$l$.splice(t,1)}function _o(e){var t,i;e.$v$=!0,e.allowHaptics=null===(i=null!==(t=ut.allowHaptics)&&void 0!==t?t:ut.$ragnarokConfig$.allowHaptics)||void 0===i||i,Ho(e),ut.$gamepadEnabled$&&(e.windowAddEventListener("gamepadconnected",e.$U$),e.windowAddEventListener("gamepaddisconnected",e.$V$),jo(e),e.$u$&&e.$m$.start())}function Eo(e,t,i){var n,s;0==e.$j$&&(e.gamepadPollInterval=null!==(s=null!==(n=ut.gamepadPollInterval)&&void 0!==n?n:ut.$ragnarokConfig$.gamepadPollInterval)&&void 0!==s?s:4,jo(e)),e.$j$|=1<<t,t=1<<t+8,e.$j$=i?e.$j$|t:e.$j$&~t}function To(e){const t=e.buttons,i=e.$triggers$;return"A:"+(4096&t?"1":"0")+"_B:"+(8192&t?"1":"0")+"_X:"+(16384&t?"1":"0")+"_Y:"+(32768&t?"1":"0")+"_LB:"+(256&t?"1":"0")+"_LSB:"+(64&t?"1":"0")+"_RB:"+(512&t?"1":"0")+"_RSB:"+(128&t?"1":"0")+"_LT:"+(255&i?"1":"0")+"_RT:"+(65280&i?"1":"0")+"_DU:"+(1&t?"1":"0")+"_DD:"+(2&t?"1":"0")+"_DL:"+(4&t?"1":"0")+"_DR:"+(8&t?"1":"0")+"_ST:"+(16&t?"1":"0")+"_BA:"+(32&t?"1":"0")+"_LS:"+(2<=(e=e.axes).length&&(2===e[0]||2===e[1])?"1":"0")+"_RS:"+(4!==e.length||2!==e[2]&&2!==e[3]?"0":"1")}function Io(e){var t;e.$s$&&(null===(t=e.$I$)||void 0===t||oo(t,e.$s$.$gamepadName$,"0","0",0,!1,!0,e.$s$.state,To(e.$s$)),e.$s$=void 0)}function Po(e,t){if(t===e.$g$.$v_index$){let i=!!e.$h$[t];if(e.$g$.$v_connected$||i)return!1}return e.$j$&=~(1<<t),e.$j$&=~(1<<t+8),0==e.$j$&&(e.gamepadPollInterval=100,jo(e)),!0}function jo(e){0!=e.$C$&&(clearInterval(e.$C$),e.$C$=0),e.$C$=e.$v$&&!ut.$gamepadRaf$?window.setInterval(e.$ia$,e.gamepadPollInterval):0}function Ro(e,t){return!!("standard"==t.mapping||e.$P$||e.$O$||Bo(e,t)||No(t)||Fo(e,t))}function Do(e,t){for(let i of e.$h$){if(!i)continue;let n=i.$device$;Ro(e,n)&&(t.$gamepadStateUpdateHandler$(0,n.index,0,0,[0,0,0,0],performance.now(),e.$j$,n.id),t.$finalizeGamepadData$(1))}}function xo(e,t){const i=e.$u$;t!=i&&(i?(e.$m$&&(e.$m$.stop(),e.$m$.reset(),Co(e,e.$m$),e.$u$=!1),e.$o$&&e.$l$.push(e.$o$)):(e.$o$&&(Co(e,e.$o$),Do(e,e.$o$)),e.$m$&&(e.$l$.push(e.$m$),e.$v$&&e.$m$.start(),e.$u$=!0)))}function Mo(e,t,i=!1){return e.$J$||(t|=2),i&&(t|=1),t}function Lo(e,t,i){return{$gamepadName$:i,state:e.$h$[t.index]?e.$h$[t.index].$telemetryData$.state:Mo(e,0),buttons:e.$h$[t.index]?e.$h$[t.index].$telemetryData$.buttons:0,$triggers$:e.$h$[t.index]?e.$h$[t.index].$telemetryData$.$triggers$:0,axes:e.$h$[t.index]?e.$h$[t.index].$telemetryData$.axes:[]}}function Oo(e,t){return{$device$:t,$standard$:!0,$getButtonMapping$:e.$M$,$getTriggerMapping$:e.$N$,$getAxesMapping$:e.$L$,$telemetryData$:Lo(e,t,"Standard Gamepad")}}function Bo(e,t){return!e.$aa$&&"standard"!=t.mapping&&t.id.includes("Vendor: 054c")&&t.id.includes("Product: 0ce6")}function No(e){return"standard"!=e.mapping&&e.id.includes("Vendor: 045e")&&e.id.includes("Product: 0b13")}function Fo(e,t){return e.$H$&&"standard"!=t.mapping&&t.id.includes("Vendor: 045e")&&t.id.includes("Product: 0b12")}function Vo(e,t,i){if(Ro(e,t)){var n=(r=t,(o=e).$P$?Oo(o,r):o.$O$?{$device$:r,$standard$:!0,$getButtonMapping$:o.$ma$,$getTriggerMapping$:o.$N$,$getAxesMapping$:o.$la$,$telemetryData$:Lo(o,r,"Standard Gamepad")}:o.$ba$?null:"standard"!=r.mapping||!r.id.includes("Vendor: 0955")||o.$da$||o.$ca$?r.id.includes("Vendor: 045e")&&(r.id.includes("Product: 0b13")||r.id.includes("Product: 0b20")||r.id.includes("Product: 0b05")||r.id.includes("Product: 02e0")||r.id.includes("Product: 02fd"))?{$device$:r,$standard$:!0,$getButtonMapping$:o.$M$,$getTriggerMapping$:o.$N$,$getAxesMapping$:o.$L$,$telemetryData$:Lo(o,r,"Standard Gamepad"),$simplifiedHaptics$:!0}:"standard"==r.mapping?Oo(o,r):Bo(o,r)?{$device$:r,$standard$:!1,$getButtonMapping$:o.$ka$.bind(o),$getTriggerMapping$:o.$K$.bind(o,3,4),$getAxesMapping$:o.$Z$,$telemetryData$:Lo(o,r,"Dual Sense Gamepad")}:No(r)?{$device$:r,$standard$:!1,$getButtonMapping$:o.$oa$.bind(o),$getTriggerMapping$:o.$K$.bind(o,3,4),$getAxesMapping$:o.$Z$,$telemetryData$:Lo(o,r,"Xbox Series Gamepad")}:Fo(o,r)?{$device$:r,$standard$:!1,$getButtonMapping$:o.$pa$.bind(o),$getTriggerMapping$:o.$K$.bind(o,2,5),$getAxesMapping$:o.$ja$,$telemetryData$:Lo(o,r,"Xbox Series Wired Gamepad")}:(d.e("{515a922}","{be4bfd9}",r),null):{$device$:r,$standard$:!0,$getButtonMapping$:o.$M$,$getTriggerMapping$:o.$na$,$getAxesMapping$:o.$L$,$telemetryData$:Lo(o,r,"Nvidia Shield Gamepad")});if(n){e.hapticsSupported=e.hapticsSupported||Go(n.$device$),Ho(e);const o=e.$j$;var s=!!e.$h$[i];return e.$h$[i]=n,void 0===e.$A$[i]&&(e.$A$[i]=0),Eo(e,i,t=t.id.includes("Xbox")||t.id.includes("xinput")),(e=o!==e.$j$)&&d.i("{515a922}","{96051ae}",s?"Changing":"Adding",i,t,n.$device$.id),e}for(s of e.$l$)s.$connectUnsupportedGamepad$(t);return Uo(e,i)}var o,r;for(n of e.$l$)n.$connectUnsupportedGamepad$(t);return Uo(e,i)}function Uo(e,t,i=!1,n){var s,o;let r=e.$h$[t];if(r){d.i("{515a922}","{1b26b8a}",t,r.$device$.id);const a=e.$B$[t];if(a){const t=performance.now()-a.timestamp;3e3<=t&&a.axes.some((e=>.5<Math.abs(e)))&&(d.w("{515a922}","{fde5612}",t,a.axes.join()),null===(s=e.$I$)||void 0===s||s.$emitDebugEvent$("GamepadStuck",r.$device$.id,t.toString(),a.axes.join()))}if(i){const[t,i]=function(e){let t=["-1","-1"];return(e=/Vendor:[ ]+([\w\d]+).+Product:[ ]+([\w\d]+)/.exec(e))&&3<=e.length&&(t=[e[1],e[2]]),t}(r.$device$.id);null===(o=e.$I$)||void 0===o||oo(o,r.$telemetryData$.$gamepadName$,t,i,r.$device$.index,!!r.$device$.$g$&&0<r.$device$.$g$.length,null!=n?n:function(e,t){let i=!1;for(const n of e.$h$)if(n){t===n.$device$.index&&(i=!0);break}return i}(e,r.$device$.index),r.$telemetryData$.state,To(r.$telemetryData$))}return delete e.$h$[t],delete e.$A$[t],delete e.$B$[t],e.hapticsSupported=function(e){let t=!1;for(let i of e.$h$)i&&(t=t||Go(i.$device$));return t}(e),Ho(e),Po(e,t)}return!1}function Go(e){var t;return"dual-rumble"==(null===(t=e.vibrationActuator)||void 0===t?void 0:t.type)}function Ho(e){var t,i;e.$D$=e.$v$&&e.hapticsSupported;var n,s=e.$D$;if(e.$$$!=s&&(e.$$$=s,e.allowHaptics))for(const t of e.$l$)null===(n=t.$sendGamepadHapticsControl$)||void 0===n||n.call(t,s);if(!e.$D$){s=navigator.getGamepads();for(let n of s)n&&(e.$F$[n.index]=0,e.$G$[n.index]=0,null===(i=null===(t=n.vibrationActuator)||void 0===t?void 0:t.playEffect)||void 0===i||i.call(t,"dual-rumble",ko))}}function zo(e){let t=!1;e.$g$.$v_enabled$&&!e.$g$.$v_connected$?e.$g$.$v_connected$?t=!1:(d.i("{515a922}","{132d93a}",e.$g$.$v_index$),e.$g$.$v_connected$=!0,e.$s$={$gamepadName$:"Nvidia Virtual Gamepad",state:0,buttons:0,$triggers$:0,axes:[]},Eo(e,e.$g$.$v_index$,!1),t=!0):!e.$g$.$v_enabled$&&e.$g$.$v_connected$&&(e.$g$.$v_connected$?(d.i("{515a922}","{98ac7c2}",e.$g$.$v_index$),e.$g$.$v_connected$=!1,Io(e),t=Po(e,e.$g$.$v_index$)):t=!1);let i=navigator.getGamepads();for(var n=0;n<i.length;n++)if(r=i[n]){var s=void 0,o=void 0;if(null!=r.id&&r.id==(null===(s=null===(o=e.$h$[n])||void 0===o?void 0:o.$device$)||void 0===s?void 0:s.id)){var r=r;(s=e).$h$[n].$device$=r,s.hapticsSupported=s.hapticsSupported||Go(r),Ho(s)}else Vo(e,r,n)&&(t=!0)}else Uo(e,n,!0)&&(t=!0);t&&e.$gamepadBitmapUpdateHandler$(),e.$J$=!0}function Wo(e){switch(Number.parseFloat((null!=e?e:0).toFixed(5))){case.71429:return 4;case-.42857:return 8;case-1:return 1;case.14286:return 2;case 1.28571:return 0;case 1:return 5;case-.71429:return 9;case.42857:return 6;case-.14286:return 10;default:return 0}}function Ko(e,t){return(0>t?1:0)|(0<t?2:0)|(0>e?4:0)|(0<e?8:0)}function Jo(e,t,i,n){e.buttons|=t,e.$triggers$|=i,0===e.axes.length?e.axes=[n[0],n[1],n[2],n[3]]:(e.axes[0]=2==e.axes[0]||e.axes[0]!==n[0]?2:e.axes[0],e.axes[1]=2==e.axes[1]||e.axes[1]!==n[1]?2:e.axes[1],e.axes[2]=2==e.axes[2]||e.axes[2]!==n[2]?2:e.axes[2],e.axes[3]=2==e.axes[3]||e.axes[3]!==n[3]?2:e.axes[3])}function qo(e){if(d.i("{4c846ba}","{b11cb24}"),e.$l$){try{e.$h$=new MediaRecorder(e.$l$)}catch(e){return void d.e("{4c846ba}","{0d1420e}",e)}e.$h$&&(e.$h$.onstart=()=>{},e.$h$.onstop=()=>{d.i("{4c846ba}","{7a944b4}")},e.$h$.ondataavailable=t=>{t.data&&0<t.data.size&&(e.$s$.push(t.data),e.$u$.push(e.$s$),++e.$m$,e.$s$=[])},d.i("{4c846ba}","{ffb713f}",e.$h$)),e.$o$=!1}else d.e("{4c846ba}","{74475ae}")}function Yo(e){var t;null===(t=e.$h$)||void 0===t||t.stop(),e.$h$=void 0,0!==e.$j$&&(window.clearTimeout(e.$j$),e.$j$=0)}function Xo(e){let t;if(1==e.$g$)t=18e5;else{if(2!=e.$g$)return;t=3e3}e.$h$&&!e.$o$&&(e.$h$.start(),e.$o$=!0,e.$j$=window.setTimeout((()=>{d.i("{4c846ba}","{2282d21}"),Yo(e)}),t),d.i("{4c846ba}","{4f438e3}"))}function Qo(e,t){e.$h$=!1,e.$j$=!1,e.$g$=t,e.$g$.onversionchange=()=>{d.w("{10dc2cc}","{65276d8}"),e.close(),e.$g$=void 0},e.$g$.onclose=()=>{d.w("{10dc2cc}","{342f7f8}"),e.$h$=!0,e.$j$=!0}}function Zo(e){return e.$l$?e.$g$?e.$h$?N(2,"Db is closing, unexpectedly: "+e.$j$+", visibility state hidden: "+("hidden"===document.visibilityState)):void 0:N(1,"Db not yet open"):N(17,"Indexdb object not found")}function er(e,t){const i=Zo(e);return i?Promise.reject(i):new Promise(((i,n)=>{try{const s=e.$g$.transaction(t,"readwrite"),o=s.objectStore(t);s.oncomplete=()=>{d.i("{10dc2cc}","{30f23d1}")};const r=o.clear();r.onsuccess=()=>{i()},r.onerror=()=>{n(N(80,"clear method failed)",s.error))}}catch(e){n(N(81,"Unexpected Exception happened in clear",e))}}))}function tr(e,t){const i=Zo(e);return i?Promise.reject(i):new Promise(((i,n)=>{try{const s=e.$g$.transaction(t,"readonly"),o=s.objectStore(t);s.oncomplete=()=>{d.i("{10dc2cc}","{59d1f78}")};const r=o.getAll();r.onsuccess=()=>{i(r.result)},r.onerror=()=>{n(N(96,"getAll method failed",s.error))}}catch(e){n(N(97,"Unexpected Exception in getAll",e))}}))}function ir(e,t){if(e.$g$.commonData){var i=t.gdprLevel;let l=!1;e.$g$.commonData&&("functional"!==i||"Full"!==e.$g$.commonData.deviceGdprFuncOptIn&&"Temp"!==e.$g$.commonData.deviceGdprFuncOptIn?("technical"===i&&"Full"===e.$g$.commonData.gdprTechOptIn||"behavioral"===i&&"Full"===e.$g$.commonData.gdprBehOptIn)&&(l=!0):l=!0),l&&(window.navigator.onLine?null!==(r=(o=ar(e,t)).config)&&void 0!==r&&r.server&&null!==(a=o.config)&&void 0!==a&&a.version&&(r={method:"POST",headers:{"Content-Type":"application/json","X-Event-Protocol":null!==(c=null===($=o.commonData)||void 0===$?void 0:$.eventProtocol)&&void 0!==c?c:"1.4"},body:JSON.stringify(o.commonData),$retryCount$:3,timeout:2e3},d.i("{f7c1592}","{4d9b16c}",ut.$allowSendingTelemetry$,r.body),ut.$allowSendingTelemetry$&&j(cr(o.config),r).then((()=>{})).catch((()=>{}))):(n=e,hr(s={userId:e.$g$.commonData.userId,sessionId:e.$g$.commonData.sessionId,name:t.name,eventPayload:t})&&n.$l$.then((()=>n.$j$.set("telemetry-events",s))).then((()=>{d.i("{f7c1592}","{f03d70b}")})).catch((e=>{const t=!n.$v$;n.$v$=!0,ur(n,e,"cacheTelemetryEventInDb",t)}))))}else e.$u$.push(t);var n,s,o,r,a,$,c}function nr(e){var t,i,n;return null!==(n=null===(i=null===(t=e.$g$)||void 0===t?void 0:t.telemetryEventIds)||void 0===i?void 0:i.streamingProfileGuid)&&void 0!==n?n:""}function sr(e){var t,i,n;return null!==(n=null===(i=null===(t=e.$g$)||void 0===t?void 0:t.telemetryEventIds)||void 0===i?void 0:i.systemInfoGuid)&&void 0!==n?n:""}function or(e,t){var i,n,s,o;let r=null!==(i=t.exitErrorCode)&&void 0!==i?i:"";return t.sleep?r="SleepExit":null!==(n=t.connectivity)&&void 0!==n&&n.startsWith("online")&&(r=null!==(s=t.connectivity)&&void 0!==s?s:""),{name:(i=new Zs({zoneAddress:t.zoneAddress,networkSessionId:null!==(o=t.networkTestSessionId)&&void 0!==o?o:"",sessionId:t.sessionId,subSessionId:t.subSessionId,resumeType:t.isResume?"MANUAL":"NONE",overrideConfigType:ut.$remoteOverrideInfo$.type,overrideConfigVersion:ut.$remoteOverrideInfo$.version,exitReason:r,result:t.exitErrorCode,frameCount:t.frameCount,codec:It(t.codec),ipVersion:"UNKNOWN",streamDuration:Math.round(t.streamDuration),networkType:to.$g$,streamingProfileGuid:nr(e),systemInfoGuid:sr(e),cmsId:String(e.$B$)})).name,gdprLevel:i.gdprLevel,parameters:i.parameters,ts:i.ts,clientConfig:Xs}}function rr(e){var t;d.d("{f7c1592}","{badefed}",!0),(t=e).$l$.then((()=>er(t.$j$,"exit-events"))).then((()=>{d.i("{f7c1592}","{1b8f127}")})).catch((e=>{ur(t,e,"clearExitEventStoreInDb",!t.$o$),t.$o$||(t.$o$=!0)})),e.$h$.eventPayload=void 0}function ar(e,t){let i={};if(!e.$g$.commonData)return i;const n={name:t.name,ts:t.ts,parameters:t.parameters,experiments:e.$g$.experiments};return $r(i,e.$g$),(e=i.commonData).clientId=t.clientConfig.clientId,e.eventSchemaVer=t.clientConfig.eventSchemaVer,e.sentTs=(new Date).toISOString(),e.events=[n],i}function $r(e,t){e.commonData=t.commonData?Object.assign({},t.commonData):void 0,e.experiments=[],e.config=t.config,e.telemetryEventIds=t.telemetryEventIds}function cr(e){return e.server+"/"+e.version+"/events/json"}function dr(e,t){var i,n,s;e.$h$.userId=null!==(n=null===(i=e.$g$.commonData)||void 0===i?void 0:i.userId)&&void 0!==n?n:"",e.$h$.sessionId=null!==(s=t.parameters.sessionId)&&void 0!==s?s:"",e.$h$.name=t.name,e.$h$.eventPayload=t}function lr(e){var t,i;if(null!==(t=e.config)&&void 0!==t&&t.server&&null!==(i=e.config)&&void 0!==i&&i.version&&e.experiments){e.commonData&&(e.commonData.sentTs=(new Date).toISOString()),t=JSON.stringify(e.commonData),i=new Blob([t],{type:"text/plain"});let n=!1;ut.$allowSendingTelemetry$&&(n=navigator.sendBeacon(cr(e.config),i)),d.i("{f7c1592}","{f797b28}",n,ut.$allowSendingTelemetry$,t)}}function ur(e,t,i,n){var s,o,r,a;d.e("{f7c1592}","{146ec91}",i,y(t.code),t.description),n&&(n=null!==(r=null!==(o=null===(s=t.error)||void 0===s?void 0:s.message)&&void 0!==o?o:t.description)&&void 0!==r?r:`Exception in ${i}`,e.$A$?e.$A$(t.error,n,"telemetryeventprocessor.ts",t.code,0,!0,null===(a=t.error)||void 0===a?void 0:a.name):d.w("{f7c1592}","{12e0846}"))}function hr(e){return!!e.userId&&!!e.sessionId&&!!e.name}function pr(e){return hr(e.$h$)?e.$l$.then((()=>e.$j$.set("exit-events",e.$h$))).then((()=>{d.i("{f7c1592}","{5d026f8}")})).catch((t=>{ur(e,t,"cacheExitEventInDb",!e.$m$),e.$m$||(e.$m$=!0)})):Promise.resolve()}function mr(e){window.navigator.onLine&&e.$l$.then((()=>tr(e.$j$,"telemetry-events"))).then((t=>{if(d.i("{f7c1592}","{d4e574c}",t.length),0<t.length){(i=e).$l$.then((()=>er(i.$j$,"telemetry-events"))).then((()=>{d.i("{f7c1592}","{8f62936}")})).catch((e=>{ur(i,e,"clearEventStoreInDb",!i.$s$),i.$s$||(i.$s$=!0)}));for(const i of t)i.eventPayload&&ir(e,i.eventPayload)}var i})).catch((e=>{d.e("{f7c1592}","{aaaa3de}",e.code,e.description)}))}var fr=class extends nt{constructor(){super(),this.$A$=!1}initialize(e){super.initialize(e),this.protocol="http://"}};function gr(e,t,i){var n,s,o,r,a,$,c,d,l,u,h,p,m,f,g,v,A;if(t.error){const s=Ao(e.$C$,t.error.code);s&&(t.error.code=_t(t.error.code,e.$platformDetails$)),Br(e,null===(n=t.error)||void 0===n?void 0:n.code).then((n=>{var o,r,a;e.framesDecoded=null!==(r=null===(o=e.$h$)||void 0===o?void 0:Ws(o))&&void 0!==r?r:0,t.zoneAddress||(t.zoneAddress=e.$j$.serverAddress),t.error&&(t.error.code=n.errorCode),o=void 0,i||(o=Sr(e,t,0,n.connectivity,s),e.$I$=null===(a=t.error)||void 0===a?void 0:a.code),Or(e,t,!0,o)}))}else d=e.$l$,l=t.sessionId,u=t.subSessionId,h=e.isResume,p=t.zoneAddress||e.$j$.serverAddress,m=Math.round(performance.now()-e.startTime),f=y(15859712),g=null!==(o=null===(s=e.$h$)||void 0===s?void 0:Ks(s))&&void 0!==o?o:"UNKNOWN",v=e.$s$?String(null===(r=e.$s$)||void 0===r?void 0:r.$sessionParams$.appId):"",A=null!==($=null===(a=e.$s$)||void 0===a?void 0:a.$sessionParams$.networkSessionId)&&void 0!==$?$:"",no(d,{name:(l=new Qs({zoneAddress:p,networkSessionId:A,sessionId:l,subSessionId:u,resumeType:h?"MANUAL":"NONE",overrideConfigType:ut.$remoteOverrideInfo$.type,overrideConfigVersion:ut.$remoteOverrideInfo$.version,result:f,codec:It(g),ipVersion:"UNKNOWN",launchDuration:Math.round(m),networkType:to.$g$,streamingProfileGuid:nr(d.$h$),systemInfoGuid:sr(d.$h$),cmsId:v})).name,gdprLevel:l.gdprLevel,parameters:l.parameters,ts:l.ts,clientConfig:Xs}),e.startTime=performance.now(),e.isResume&&e.$micEnabled$&&e.setMicRecordingEnabled(!0),Lr(e,t),e.$M$&&(null===(c=e.$h$)||void 0===c||c.toggleUserInput(!0,e.$aa$)),C(e.$platformDetails$)&&document.addEventListener("SystemIdle",e.$V$)}function vr(e){if(e.$g$){const i=e.$g$.getSessionId(),n=e.$g$.getSubSessionId();d.d("{9d1820c}","{2fd42df}",i,n);var t=e.$l$;t.subSessionId=n,t.$j$.clear(),t.$l$=0,e.$C$.subSessionId=n,(t=e.$l$).sessionId=i,t.$m$=0,e.$C$.sessionId=i,(e=e.$o$).$m$=!1,e.$o$=!1,e.$v$=!1,e.$s$=!1}}function Ar(e,t){var i,n,s,o,r,a,$,c,d,l;e.$B$&&(e.$B$=!1,e.framesDecoded=null!==(n=null===(i=e.$h$)||void 0===i?void 0:Ws(i))&&void 0!==n?n:0,i={sessionId:null!==(o=null===(s=e.$g$)||void 0===s?void 0:s.getSessionId())&&void 0!==o?o:"",subSessionId:null!==(a=null===(r=e.$g$)||void 0===r?void 0:r.getSubSessionId())&&void 0!==a?a:"",zoneName:null!==(c=null===($=e.$g$)||void 0===$?void 0:$.getZoneName())&&void 0!==c?c:"",zoneAddress:(null===(d=e.$g$)||void 0===d?void 0:d.getZoneAddress())||e.$j$.serverAddress,error:{code:t}},s=Sr(e,i,performance.now()-e.startTime),mo(e.$m$),(!e.$h$||(null===(l=e.$h$)||void 0===l?0:l.$C$))&&wr(e,s),Dr(e,t),e.cancelSessionSetup())}function br(e){0!==e.$A$&&(window.clearTimeout(e.$A$),e.$A$=0)}function wr(e,t){br(e),so(e=e.$l$,t=or(e.$h$,t)),rr(e.$h$)}function Sr(e,t,i,n,s){var o,r,a,$;return{exitErrorCode:t.error?y(t.error.code):y(15859712),sessionId:t.sessionId,subSessionId:t.subSessionId,zoneAddress:t.zoneAddress,streamDuration:i,frameCount:e.framesDecoded,codec:null!==(r=null===(o=e.$h$)||void 0===o?void 0:Ks(o))&&void 0!==r?r:"UNKNOWN",isResume:e.isResume,connectivity:null!=n?n:"undefined",sleep:null!=s&&s,networkTestSessionId:null!==($=null===(a=e.$s$)||void 0===a?void 0:a.$sessionParams$.networkSessionId)&&void 0!==$?$:""}}function yr(e){var t;Tr(e,y(null!==(t=e.$I$)&&void 0!==t?t:15867911));const i=e.$A$;pr(e.$o$).then((()=>{var t;i===e.$A$&&(br(t=e),t.$A$=window.setTimeout((()=>yr(t)),12e4))})).catch((()=>{d.e("{9d1820c}","{204a7ac}")}))}function kr(e){return{code:3237093380,description:e+" called before initialize"}}function Cr(e,t){var i,n,s,o,r,a,$,c,l,u,h;gr(e,{sessionId:null!==(n=null===(i=e.$g$)||void 0===i?void 0:i.getSessionId())&&void 0!==n?n:"",subSessionId:null!==(o=null===(s=e.$g$)||void 0===s?void 0:s.getSubSessionId())&&void 0!==o?o:"",error:{code:3237089284,description:"Quitting due to exception"},streamInfo:null===(r=e.$v$)||void 0===r?void 0:r.streamInfo,zoneName:null!==($=null===(a=e.$g$)||void 0===a?void 0:a.getZoneName())&&void 0!==$?$:"",zoneAddress:null!==(l=null===(c=e.$g$)||void 0===c?void 0:c.getZoneAddress())&&void 0!==l?l:"",gpuType:null!==(h=null===(u=e.$g$)||void 0===u?void 0:u.getGpuType())&&void 0!==h?h:"",isResume:e.isResume},!0),d.e("{9d1820c}","{90f98fb}",t),e.$l$.$g$(t,"Exception happened in session call","{9d1820c}.ts",0,0,!0)}function _r(e,t){gr(e,{sessionId:"",subSessionId:M(),error:t,zoneName:"",zoneAddress:"",gpuType:"",isResume:e.isResume},!0)}function Er(e,t,i,n){var s,o,r,a;if(e.$v$=void 0,e.$O$=!1,e.$g$){i.$sessionParams$.remoteControllersBitmap=(zo(a=e.$D$),a.$j$);try{o=e.$l$,r=i.$sessionParams$.appId,i.$sessionParams$.shortName,o.cmsId=r,o.$h$.$B$=r,e.startTime=performance.now(),go(s=e.$C$),s.$g$=(new Date).getTime(),s.$j$=0,s.$l$=0,s.$h$=0,s.sleepTime=0,d.i("{0f7a7d0}","{d5ff5ba}"),s.$m$=window.setInterval((()=>{try{let e=(new Date).getTime();1e4<e-s.$g$-1e4&&(s.$h$=e,s.sleepTime=s.$h$-s.$g$-1e4),1e4<e-s.$g$-1e4&&0!=s.$j$?vo(s,0<s.$g$-s.$l$?"epsp":"esp"):36e5<e-s.$g$&&go(s),s.$g$=e}catch(e){}}),1e4),d.d("{9d1820c}","{892168d}",d.sanitize(JSON.stringify(i.$sessionParams$)));const a=e.$g$;a.putOrPostSession(i.$sessionParams$,t,n).then((t=>(vr(e),d.d("{9d1820c}","{92a2573}",null==t?void 0:t.sessionId,null==t?void 0:t.subSessionId),"ready_for_connection"===(null==t?void 0:t.state)?(d.d("{9d1820c}","{2042e0a}"),e.$v$=t,new Promise((e=>{e(t)}))):a.getSession(t.sessionId,!0)))).then((t=>{e.$v$=t,d.d("{9d1820c}","{315afdc}",null==t?void 0:t.sessionId),function(e,t){var i,n,s,o;let r={sessionId:null!==(n=null===(i=e.$g$)||void 0===i?void 0:i.getSessionId())&&void 0!==n?n:"",subSessionId:null!==(o=null===(s=e.$g$)||void 0===s?void 0:s.getSubSessionId())&&void 0!==o?o:"",queuePosition:0,eta:0,state:"StartingStreamer"};e.emit("ProgressUpdate",r),i=S(e.$j$.serverAddress)?"":e.$j$.serverAddress.split(".")[0];const{$videoElement$:a,$audioElement$:$}=t.$validatedStreamParams$[0];if(B(e.$platformDetails$,!1,15)){a.ragnarokOldPlay||(a.ragnarokOldPlay=a.play);const t=ut.$allowSourceReset$&&B(e.$platformDetails$,!0,15,1);a.play=()=>{if(ut.$allowAudioReset$&&(d.i("{9d1820c}","{4a5b360}"),Mr(e),function(e){if(ut.$allowAudioReset$)if(window.ios15AudioContext)d.i("{9d1820c}","{e2aba64}");else{var t=new(window.AudioContext||window.webkitAudioContext)({latencyHint:"interactive",sampleRate:48e3});t.onstatechange=()=>{"suspended"===t.state&&(t.resume(),e.$m$.$o$(),d.i("{9d1820c}","{faee684}"))},window.ios15AudioContext=t,window.ios15AudioStream=t.createMediaStreamDestination(),navigator.mediaDevices&&e.$F$&&navigator.mediaDevices.addEventListener("devicechange",e.$F$),d.i("{9d1820c}","{b5f7b9b}")}}(e),e.$m$.$o$()),t){d.i("{9d1820c}","{8f5cd77}");const e=a.srcObject;a.srcObject=null,a.srcObject=e}return a.ragnarokOldPlay.apply(a)}}var c,l,u;ut.$allowAutoplayChange$&&(B(e.$platformDetails$,!0,15,0)||B(e.$platformDetails$,!0,15,1))&&(a.hasAttribute("data-shouldautoplay")?a.setAttribute("autoplay",""):(a.setAttribute("data-shouldautoplay",""),a.removeAttribute("autoplay"))),e.$h$=new Js(e,a,$,e.$m$,e.$S$,e.$R$,e.$D$,e.$l$,e.$platformDetails$,e.$v$,t.$sessionParams$.accessToken||"",t.$sessionParams$.streamParams[0],e.$P$,e.$j$.textInputElement,e.$j$.clientAppVersion,e.isResume,i),e.$h$.start(),t.$sessionParams$.keyboardLayout&&e.$h$.setKeyboardLayout(t.$sessionParams$.keyboardLayout),(c=e.$l$,c.clientShutDownCallback?(d.d("{9838627}","{c7dcc4e}"),(l=c.$h$,l.$l$.then((()=>tr(l.$j$,"exit-events"))).then((e=>{d.i("{f7c1592}","{d938300}",e.length);let t=[];if(0<e.length)for(const i of e)i.eventPayload&&t.push(i.eventPayload);return t})).catch((e=>(ur(l,e,"getCachedExitEvents",!0),Promise.reject())))).then((e=>{for(const t of e)so(c,t);rr(c.$h$)})).catch((()=>{d.d("{9838627}","{41cf828}")}))):(d.d("{9838627}","{77df598}"),(u=c.$h$).$l$.then((()=>tr(u.$j$,"exit-events"))).then((e=>{if(d.i("{f7c1592}","{ca568ff}",e.length),0<e.length){for(const t of e)t.eventPayload&&lr(ar(u,t.eventPayload));rr(u)}})).catch((e=>{ur(u,e,"sendCachedExitEvent",!0)})))).then((()=>{yr(e)})).catch((()=>{d.e("{9d1820c}","{c761bfd}")}))}(e,i)})).catch((t=>{var i,n,s,o,r,$;if(vr(e),t.code){15867905!=t.code&&15867906!=t.code||!a.getSessionId()||e.$O$&&e.isResume||e.sendDeleteRequest(a.getSessionId(),a),d.e("{9d1820c}","{09efe49}",y(t.code));let c={sessionId:null!==(i=a.getSessionId())&&void 0!==i?i:"",subSessionId:null!==(n=a.getSubSessionId())&&void 0!==n?n:"",error:t,sessionList:t.sessionList,streamInfo:null===(s=e.$v$)||void 0===s?void 0:s.streamInfo,zoneName:null!==(o=a.getZoneName())&&void 0!==o?o:"",zoneAddress:null!==(r=a.getZoneAddress())&&void 0!==r?r:"",gpuType:null!==($=a.getGpuType())&&void 0!==$?$:"",isResume:e.isResume};gr(e,c,!0)}else Cr(e,t)}))}catch(t){Cr(e,t)}}else e.emit("SessionStartResult",{sessionId:"",subSessionId:"",zoneName:"",zoneAddress:"",gpuType:"",isResume:e.isResume,error:kr(e.isResume?"Resume":"Start")})}function Tr(e,t){var i,n,s,o,r,a,$,c,d,l=e.$o$,u=null!==(n=null===(i=e.$g$)||void 0===i?void 0:i.getSessionId())&&void 0!==n?n:"";i=null!==(o=null===(s=e.$g$)||void 0===s?void 0:s.getSubSessionId())&&void 0!==o?o:"",s=(null===(r=e.$g$)||void 0===r?void 0:r.getZoneAddress())||e.$j$.serverAddress,r=null!==($=null===(a=e.$h$)||void 0===a?void 0:Ws(a))&&void 0!==$?$:0,a=null!==(d=null===(c=e.$h$)||void 0===c?void 0:Ks(c))&&void 0!==d?d:"UNKNOWN",dr(l,e=or(l,{exitErrorCode:t,sessionId:u,subSessionId:i,zoneAddress:s,streamDuration:performance.now()-e.startTime,frameCount:r,codec:a,isResume:e.isResume,connectivity:"",sleep:!1,networkTestSessionId:""}))}function Ir(e){e.$K$&&(window.clearTimeout(e.$K$),e.$K$=0)}function Pr(e){window.removeEventListener("pagehide",e.$W$),window.removeEventListener("online",e.$T$),document.removeEventListener("visibilitychange",e.$$$),navigator.mediaDevices&&navigator.mediaDevices.removeEventListener("devicechange",e.$L$),C(e.$platformDetails$)&&(document.removeEventListener("SystemIdle",e.$V$),Ir(e))}function jr(e,t){e.$I$=void 0,mr(e.$o$),e.$B$=!0,window.addEventListener("pagehide",e.$W$),window.addEventListener("online",e.$T$),document.addEventListener("visibilitychange",e.$$$),navigator.mediaDevices&&navigator.mediaDevices.addEventListener("devicechange",e.$L$),e.isResume=t,e.$G$&&e.$l$.$emitDebugEvent$("SessionSetupInProgressError",e.isResume?"resume":"start"),e.$G$=!0}function Rr(e,t){var i,n,s;if((t={$sessionParams$:Object.assign({},t),$validatedStreamParams$:[]}).$sessionParams$.streamParams)for(const i of t.$sessionParams$.streamParams){const n=document.getElementById(i.videoTagId);if(null==n||!(n instanceof HTMLVideoElement))return void _r(e,{code:3237094400,description:"Didn't find video element for videoTagId: "+i.videoTagId});const s=document.getElementById(i.audioTagId);if(null==s||!(s instanceof HTMLAudioElement))return void _r(e,{code:3237094401,description:"Didn't find audio element for audioTagId: "+i.audioTagId});t.$validatedStreamParams$.push({$videoElement$:n,$audioElement$:s})}if(t.$sessionParams$.keyboardLayout=null!==(i=t.$sessionParams$.keyboardLayout)&&void 0!==i?i:T(e.$platformDetails$)?"m-us":"en_US",void 0!==t.$sessionParams$.appLaunchMode&&0!==t.$sessionParams$.appLaunchMode||(t.$sessionParams$.appLaunchMode=R()||x(e.$platformDetails$)||"Xbox"===e.$platformDetails$.os?1:0),ut.$sessionMetaData$)if(t.$sessionParams$.metaData)for(const e in ut.$sessionMetaData$)t.$sessionParams$.metaData[e]=ut.$sessionMetaData$[e];else t.$sessionParams$.metaData=ut.$sessionMetaData$;void 0!==ut.appLaunchMode&&(t.$sessionParams$.appLaunchMode=ut.appLaunchMode,d.d("{9d1820c}","{c4969b1}",ut.appLaunchMode));const o=!!ut.$resWidth$&&!!ut.$resHeight$,r=!!ut.fps;return(o||r)&&(null===(n=t.$sessionParams$.streamParams)||void 0===n||n.forEach((e=>{o&&(e.width=ut.$resWidth$,e.height=ut.$resHeight$),r&&(e.fps=ut.fps)})),null===(s=t.$sessionParams$.monitorSettings)||void 0===s||s.forEach((e=>{o&&(e.widthInPixels=ut.$resWidth$,e.heightInPixels=ut.$resHeight$),r&&(e.framesPerSecond=ut.fps)})),o&&d.i("{9d1820c}","{92a6b38}",ut.$resWidth$,ut.$resHeight$),r&&d.d("{9d1820c}","{6618bcd}",ut.fps)),e.$s$=t,e.$s$}function Dr(e,t){e.$h$&&(e.$h$.stop(t),e.$h$=void 0)}function xr(e,t,i){var n,s;t={sessionId:t,subSessionId:null!==(s=null===(n=e.$g$)||void 0===n?void 0:n.getSubSessionId())&&void 0!==s?s:"",framesDecoded:e.framesDecoded,error:i},Mr(e),w(e.$platformDetails$)&&e.$micEnabled$&&(d.d("{9d1820c}","{b9b1288}"),e.setMicRecordingEnabled(!1)),e.emit("SessionStopResult",t)}function Mr(e){ut.$allowAudioReset$&&(window.ios15AudioContext&&(window.ios15AudioContext.close(),window.ios15AudioContext=void 0,d.i("{9d1820c}","{0ac2a42}")),window.ios15AudioStream=void 0,navigator.mediaDevices&&e.$F$&&navigator.mediaDevices.removeEventListener("devicechange",e.$F$))}function Lr(e,t){e.$G$=!1,t.error&&(e.$B$=!1,Pr(e)),e.emit("SessionStartResult",t)}function Or(e,t,i,n){var s,o,r,a;Mr(e),n&&(null!==(s=n.connectivity)&&void 0!==s&&s.startsWith("offline")||null!==(o=n.connectivity)&&void 0!==o&&o.startsWith("timeout")?(br(e),Tr(e,y(null!==(a=null===(r=t.error)||void 0===r?void 0:r.code)&&void 0!==a?a:15867911)),pr(e.$o$).catch((()=>{d.e("{9d1820c}","{0c2de99}")}))):wr(e,n)),Dr(e,t.error?t.error.code:15859712),i?Lr(e,t):(t.error&&(i=function(e,t){let i=!1;switch(e){case 3237093896:case 3237093897:case 3237093898:case 3237093906:case 3237093899:case 3237093901:case 15868418:case 3237094159:i=!0;break;case 15867908:w(t)&&(i=!0)}return i}(t.error.code,e.$platformDetails$),t.isResumable=i,d.i("{9d1820c}","{723f7be}",i)),e.$B$=!1,e.$G$=!1,Pr(e),e.emit("StreamStopped",t))}function Br(e,t){let i={errorCode:null!=t?t:15859712,connectivity:"online"};if(t&&(!((3237093888^t)>>8)||3237089282===t)){let n=1500;ut.$ragnarokConfig$.connectivityCheckTimeout&&0!==ut.$ragnarokConfig$.connectivityCheckTimeout&&(n=ut.$ragnarokConfig$.connectivityCheckTimeout,d.i("{9d1820c}","{f9909d8}",n)),e=("http:"===window.location.protocol?"http://":"https://")+e.$j$.serverAddress,d.i("{9d1820c}","{df38106}",e);const s=performance.now();return function(e,t=500){const i=new AbortController;return window.setTimeout((()=>{i.abort()}),t),fetch(e,{method:"OPTIONS",signal:i.signal}).then((e=>e)).catch((e=>{throw e}))}(e,n).then((e=>(i.connectivity=200<=e.status&&300>e.status||403==e.status?"online("+String(25*Math.ceil((performance.now()-s)/25))+")":"offline_wrong_status("+String(e.status)+")",i))).catch((e=>{if("AbortError"===e.name)i.connectivity="timeout";else{if(i.connectivity="offline("+e.name+":"+e.message+")",e=t,ut.$ragnarokConfig$.offlineErrorsStreaming&&ut.$ragnarokConfig$.offlineErrorsStreaming.includes(y(t)))e=15868418;else if(ut.$ragnarokConfig$.offlineErrorsSessionSetup&&ut.$ragnarokConfig$.offlineErrorsSessionSetup.includes(y(t)))e=15868417;else switch(t){case 3237093906:case 3237093899:e=15868418;break;case 3237089282:e=15868417}e!==t&&d.i("{d988e7f}","{b84d4c8}",y(t),y(e)),i.errorCode=e}return i}))}return Promise.resolve(i)}performance.mark("GfnRBegin"),window.Ragnarok=window.Ragnarok||{},window.Ragnarok.GridApp=class extends Se{constructor(e){super(),this.$platformDetails$=e,this.$micEnabled$=this.$M$=!1,this.$R$=new class{constructor(){this.$gamepadTesterElementId$="gamepadTester",this.visible=!1,this.$gamepads$=[],this.$unsupportedGamepads$=[],ut.$gamepadTesterEnabled$&&(document.body.appendChild(wo(this)),this.start())}$gamepadBitmapUpdateHandler$(e){for(let t=0;4>t;t++)!(e&1<<t)&&(this.$gamepads$[t]=null)}$gamepadStateUpdateHandler$(e,t,i,n,s,o,r,a){this.$gamepads$[t]={index:t,buttons:i,$trigger$:n,axes:s,name:a}}$connectUnsupportedGamepad$(e){3>=e.index&&(this.$unsupportedGamepads$[e.index]={index:e.index,buttons:-1,$trigger$:-1,axes:[-1],name:e.id})}start(){let e,t=document.getElementById(this.$gamepadTesterElementId$);if(null==t)d.e("{e13a879}","{0c955af}");else{var i=.49*window.innerWidth,n=.4*window.innerHeight,s=.3*i,o=.7*i,r=.8*n,a=.8*n,$=.07*i,c=e=>{e.style.position="absolute",e.style.width="2%",e.style.height="3.5%",e.style.backgroundColor="red",e.style.borderRadius="50%",e.style.transform="translate(-50%, -50%)"},l=e=>{let i=(n=e)?{left:{$X$:n.axes[0],$Y$:n.axes[1]},right:{$X$:n.axes[2],$Y$:n.axes[3]}}:null;var n;if(null===t.querySelector(`.gamepad${e.index}`).querySelector(".leftStick")){var d=document.createElement("div");d.className="gamepadJoystickPointer leftStick",c(d),d.style.left=`${s+i.left.$X$*$}px`,d.style.top=`${r+i.left.$Y$*$}px`,t.querySelector(`.gamepad${e.index}`).querySelector(".gamepadContainer").appendChild(d)}else(d=t.querySelector(`.gamepad${e.index}`).querySelector(".leftStick")).style.opacity="1",d.style.left=`${s+$*i.left.$X$}px`,d.style.top=`${r+i.left.$Y$*$}px`;null===t.querySelector(`.gamepad${e.index}`).querySelector(".rightStick")?((d=document.createElement("div")).className="gamepadJoystickPointer rightStick",c(d),d.style.left=`${o+i.right.$X$*$}px`,d.style.top=`${a+i.right.$Y$*$}px`,t.querySelector(`.gamepad${e.index}`).querySelector(".gamepadContainer").appendChild(d)):((e=t.querySelector(`.gamepad${e.index}`).querySelector(".rightStick")).style.opacity="1",e.style.left=(o+i.right.$X$*$).toString()+"px",e.style.top=(a+i.right.$Y$*$).toString()+"px")},u=(e,t,i)=>{var n=e.getContext("2d");switch(n.beginPath(),n.fillStyle=i?"green":"grey",t){case 0:n.moveTo(.14*e.width,.48*e.height),n.lineTo(.19*e.width,.48*e.height),n.lineTo(.165*e.width,.54*e.height),n.lineTo(.14*e.width,.48*e.height);break;case 1:n.moveTo(.14*e.width,.66*e.height),n.lineTo(.19*e.width,.66*e.height),n.lineTo(.165*e.width,.61*e.height),n.lineTo(.14*e.width,.66*e.height);break;case 2:n.moveTo(.09*e.width,.55*e.height),n.lineTo(.09*e.width,.61*e.height),n.lineTo(.135*e.width,.57*e.height),n.lineTo(.09*e.width,.55*e.height);break;case 3:n.moveTo(.24*e.width,.55*e.height),n.lineTo(.24*e.width,.61*e.height),n.lineTo(.195*e.width,.57*e.height),n.lineTo(.24*e.width,.55*e.height);break;case 4:n.arc(.7*e.width,.4*e.height,.02*e.width,0,2*Math.PI);break;case 5:n.arc(.3*e.width,.4*e.height,.02*e.width,0,2*Math.PI);break;case 6:n.arc(.3*e.width,.8*e.height,.07*e.width,0,2*Math.PI);break;case 7:n.arc(.7*e.width,.8*e.height,.07*e.width,0,2*Math.PI);break;case 8:n.rect(.13*e.width,.23*e.height,.07*e.width,.05*e.height);break;case 9:n.rect(.815*e.width,.23*e.height,.07*e.width,.05*e.height);break;case 12:n.arc(.85*e.width,.65*e.height,.02*e.width,0,2*Math.PI);break;case 13:n.arc(.9*e.width,.55*e.height,.02*e.width,0,2*Math.PI);break;case 14:n.arc(.8*e.width,.55*e.height,.02*e.width,0,2*Math.PI);break;case 15:n.arc(.85*e.width,.45*e.height,.02*e.width,0,2*Math.PI);break;case-1:n.rect(.155*e.width,.07*e.height,.02*e.width,.12*e.height);break;case-2:n.rect(.84*e.width,.07*e.height,.02*e.width,.12*e.height)}n.closePath(),n.fill()},h=e=>{if(null===t.querySelector(`.gamepad${e.index}`)){let o=document.createElement("div");o.className=`gamepad gamepad${e.index}`;var s=document.createElement("p");s.className="active",s.style.margin="0px";let r=document.createElement("span");r.className="gamepadPlayerNumber",r.style.color="white",r.style.position="relative",r.innerHTML=`P${e.index+1}|${e.name}`,r.style.fontSize="1.5vw",s.appendChild(r),o.appendChild(s),(e=document.createElement("div")).className="gamepadContainer",e.style.position="relative",e.style.width=`${i+2}px`,e.style.height=`${n}px`,(s=document.createElement("canvas")).className="canvas",s.style.width=`${i}px`,s.style.height=`${n}px`,s.style.border="1px solid white",e.appendChild(s),o.appendChild(e),t.appendChild(o)}},p=()=>{if(this.visible){for(let e=0;e<this.$gamepads$.length;e++){var i=this.$gamepads$[e];if(i){t.querySelector(`.gamepad${i.index}`)||h(i),l(i);var n=t.querySelector(`.gamepad${i.index}`).querySelector("canvas");for(let e=0;16>e;e++)i.buttons&1<<e?u(n,e,!0):u(n,e,!1);255&i.$trigger$?u(n,-1,!0):u(n,-1,!1),65280&i.$trigger$?u(n,-2,!0):u(n,-2,!1)}else this.$unsupportedGamepads$[e]?t.querySelector(`.gamepad${e}`)||(h(this.$unsupportedGamepads$[e]),(n=(i=t.querySelector(`.gamepad${e}`).querySelector("canvas")).getContext("2d")).font="20px Arial",n.fillStyle="white",n.textAlign="center",n.fillText("Unsupported Gamepad",i.width/2,i.height/2)):(i=t.querySelector(`.gamepad${e}`))&&t.removeChild(i)}e=window.requestAnimationFrame(p)}else window.cancelAnimationFrame(e)};p()}}$finalizeGamepadData$(){}$virtualGamepadUpdateHandler$(){}},this.$G$=!1,this.$F$=this.$L$=void 0,this.$U$=!1,this.$H$=this.$Z$=this.$K$=this.$A$=0,this.$O$=this.$B$=!1,d.addListener("Log",this.$N$.bind(this)),this.$j$={clientIdentification:"GFN-PC",clientVersion:"26.0",deviceHashId:"",serverAddress:""},this.startTime=performance.now(),this.$W$=this.$la$.bind(this),this.$T$=this.$ia$.bind(this),this.$$$=this.$ma$.bind(this),this.$ka$=this.$ja$.bind(this),this.framesDecoded=0,this.$o$=new class{constructor(){this.$h$={userId:"",sessionId:"",eventPayload:void 0,name:""},this.$g$={},this.$s$=this.$v$=this.$o$=this.$m$=!1,this.$B$="",this.$u$=[],this.$j$=new class{constructor(){this.$l$=window.indexedDB,this.version=2,this.$j$=this.$h$=!1,this.name="ragnarok",this.$m$=[{$storeName$:"exit-events",$storeOptions$:{keyPath:["userId","sessionId","name"]},$storeIndexName$:"exit-event-index"},{$storeName$:"telemetry-events",$storeOptions$:{keyPath:["userId","sessionId","name","eventPayload.ts"]},$storeIndexName$:"telemetry-event-index"}]}open(){return new Promise(((e,t)=>{try{if(this.$l$){let i=this.$l$.open(this.name,this.version);i.onerror=()=>{t(N(18,`${this.name} db opening failed`,i.error))},i.onsuccess=()=>{Qo(this,i.result),e()},i.onupgradeneeded=e=>{d.i("{10dc2cc}","{1f70767}",e.oldVersion,e.newVersion),Qo(this,i.result);const t=e=>{var t;const i=null===(t=this.$g$)||void 0===t?void 0:t.createObjectStore(e.$storeName$,e.$storeOptions$);e.$storeOptions$.keyPath&&(null==i||i.createIndex(e.$storeIndexName$,e.$storeOptions$.keyPath,{unique:!0}))};switch(e.oldVersion){case 0:t(this.$m$[0]);case 1:t(this.$m$[1])}},i.onblocked=()=>{t(N(19,`${this.name} db blocked during opening`,i.error))}}else t(N(17,"Indexdb object not found"))}catch(e){t(N(20,"Unexpected Exception in open",e))}}))}get(e,t){const i=Zo(this);return i?Promise.reject(i):new Promise(((i,n)=>{try{const s=this.$g$.transaction(e,"readonly"),o=s.objectStore(e);s.oncomplete=()=>{d.i("{10dc2cc}","{82638ba}")};const r=o.get(t);r.onsuccess=()=>{i(r.result)},r.onerror=()=>{n(N(32,"get method failed",s.error))}}catch(e){n(N(33,"Unexpected Exception happened in get",e))}}))}set(e,t){const i=Zo(this);return i?Promise.reject(i):new Promise(((i,n)=>{try{const s=this.$g$.transaction(e,"readwrite"),o=s.objectStore(e);s.oncomplete=()=>{d.i("{10dc2cc}","{f993875}")};const r=o.put(t);r.onsuccess=()=>{i()},r.onerror=()=>{n(N(48,"put method failed",s.error))}}catch(e){n(N(49,"Unexpected Exception happened in set",e))}}))}close(){var e;this.$h$=!0,null===(e=this.$g$)||void 0===e||e.close()}},this.$l$=this.$j$.open()}updateEventDataElements(e){var t;if($r(this.$g$,e),this.$g$.commonData){d.d("{f7c1592}","{66f209c}");for(let e of this.$u$)ir(this,e);this.$u$=[]}this.$h$.userId=null===(t=this.$g$.commonData)||void 0===t?void 0:t.userId}},this.$l$=new class{constructor(e,t){this.cmsId=this.subSessionId=this.sessionId="",this.$m$=0,this.$j$=new Map,this.$l$=0,this.$o$=e,this.$h$=t,this.$h$.$A$=this.$g$.bind(this)}$g$(e,t,i,n,s,o,r){var a;if(50<=this.$l$)var $=!1;else{var c=null!==($=this.$j$.get(t))&&void 0!==$?$:0;10<=c?$=!1:(this.$l$++,this.$j$.set(t,c+1),$=!0)}$&&(e instanceof DOMException&&(e={name:e.name,message:e.message}),no(this,{name:(e=new Le({filename:i,lineno:n,stacktrace:null!==(a=null==e?void 0:e.stack)&&void 0!==a?a:"",colno:s,handled:jt(o),category:null!=r?r:"",message:t,moduleName:"RAGNAROK",sessionId:this.sessionId,subSessionId:this.subSessionId})).name,gdprLevel:e.gdprLevel,parameters:e.parameters,ts:e.ts,clientConfig:Xs}))}$emitDebugEvent$(e,t,i,n,s){no(this,{name:(e=new Me({key1:null!=e?e:"",key2:null!=t?t:"",key3:null!=i?i:"",key4:null!=n?n:"",key5:null!=s?s:"",moduleName:"RAGNAROK",networkType:to.$g$,overrideConfigType:ut.$remoteOverrideInfo$.type,overrideConfigVersion:ut.$remoteOverrideInfo$.version,cmsId:String(this.cmsId),sessionId:this.sessionId,subSessionId:this.subSessionId})).name,gdprLevel:e.gdprLevel,ts:e.ts,parameters:e.parameters,clientConfig:Xs})}}(this,this.$o$),this.$C$=new class{constructor(e){this.subSessionId=this.sessionId="",this.$g$=0,this.$o$="",this.sleepTime=this.$h$=this.$m$=this.$l$=this.$j$=0,this.$s$=e}}(this.$l$),this.isResume=!1,this.$S$=ot,this.$P$=new class{constructor(){this.$o$=!1,this.$s$=[],this.$u$=[],this.$g$=this.$m$=this.$j$=0}initialize(e){this.$l$=e}uninitialize(){Yo(this),this.downloadAudio(),this.$l$=void 0,this.$g$=0}downloadAudio(){if(0!=this.$g$){for(let e=0;e<this.$m$;++e)xt(this.$u$[e],"audioCapture_"+e+".wmv","audio/webm")&&d.i("{4c846ba}","{c24ed3b}");this.$m$=0,this.$u$=[]}}},window.addEventListener("error",this.$ka$),e=window.zoneless,this.$m$=new class{constructor(e,t){this.$B$=null,this.$h$=0,this.$micEnabled$=!1,this.$C$=new Set,this.$D$=this.$I$=!1,this.$J$=0,this.$A$=this.$F$=this.$v$=!1,this.$j$={$noAudioInput$:0,$builtInMic$:0,$headsetMic$:0},this.$l$=new Map([["permissionDenied",0],["visibilityChange",0],["deviceChange",0]]),this.$H$=!1,this.$platformDetails$=e,this.$G$=t,this.$g$=this.$s$=null,this.paused=this.$m$=!1,this.$audioElement$=this.$videoElement$=null,B(e,!1,15)&&(this.$I$=!0)}initialize(e,t,i,n){if(!1!==ut.$micEnabled$){if(this.$s$=e,this.$B$=t,this.$videoElement$=i,this.$audioElement$=n,fo){if(null==(e=po()))return void d.w("{223689a}","{360f38b}");this.$s$.addTrack(e.getAudioTracks()[0],e),this.$micEnabled$&&uo(this)}else d.w("{223689a}","{5813c2b}");this.$D$=!0}}$o$(){var e,t,i;if(ut.$allowAudioReset$&&this.$I$){var n=null!==(t=null===(e=this.$audioElement$)||void 0===e?void 0:e.srcObject)&&void 0!==t?t:null===(i=this.$videoElement$)||void 0===i?void 0:i.srcObject;if(n){d.i("{223689a}","{ad4b8c2}");var s=n.getAudioTracks()[0];s.enabled=!1,setTimeout((()=>{s.enabled=!0}),0)}}}getMicState(){return this.$h$}shouldDefaultEnableMic(){return!(C(this.$platformDetails$)||"Tizen"===this.$platformDetails$.os||w(this.$platformDetails$))}}(this.$platformDetails$,this.$l$),this.$F$=this.$m$.$o$.bind(this.$m$),this.$L$=this.$ba$.bind(this),this.$D$=new class{constructor(e,t){var i,n;this.$C$=this.$j$=0,this.$F$=[],this.$G$=[],this.$R$=[],this.$u$=this.$v$=this.$$$=this.$D$=this.hapticsSupported=!1,this.$S$=0,this.$J$=this.$aa$=this.$ca$=this.$da$=this.$H$=this.$P$=this.$O$=this.$ba$=this.$T$=!1,this.maxSchedulingDelay=0,this.windowAddEventListener=t&&t.windowAddEventListener?t.windowAddEventListener.bind(window):window.addEventListener.bind(window),this.windowRemoveEventListener=t&&t.windowRemoveEventListener?t.windowRemoveEventListener.bind(window):window.removeEventListener.bind(window),this.$U$=this.$fa$.bind(this),this.$V$=this.$ga$.bind(this),this.$ia$=this.$W$.bind(this),this.$h$=[],this.gamepadPollInterval=100,this.$B$=[],this.$A$=[],this.$l$=[],this.$platformDetails$=e,t=e.os;const s=e.osVer;this.$O$=(e=("iOS"==t||"iPadOS"==t)&&"Safari"==e.browser)&&s.startsWith("13"),this.$P$=e&&s.startsWith("14"),this.$ba$=e&&"12-"==s,this.$H$="ChromeOS"==t,this.$da$="WebOS"==t,this.$ca$="Tizen"==t,this.$aa$="Android"==t,this.$g$={$v_index$:0,$v_enabled$:!1,$v_connected$:!1,$v_buttons$:0,$v_trigger$:0,$v_axes$:[],$v_updated$:!1},this.$qa$=new So(this.$g$),this.allowHaptics=null===(n=null!==(i=ut.allowHaptics)&&void 0!==i?i:ut.$ragnarokConfig$.allowHaptics)||void 0===n||n,d.d("{515a922}","{b0c674b}")}$isRsdmmActive$(){return this.$u$}$gamepadBitmapUpdateHandler$(){for(const e of this.$l$)e.$gamepadBitmapUpdateHandler$(this.$j$)}$fa$(e){Vo(this,e.gamepad,e.gamepad.index)&&this.$gamepadBitmapUpdateHandler$()}$ga$(e){Uo(this,e.gamepad.index,!0)&&this.$gamepadBitmapUpdateHandler$()}$M$(e){return((e=e.buttons)[0].value?4096:0)|(e[1].value?8192:0)|(e[2].value?16384:0)|(e[3].value?32768:0)|(e[4].value?256:0)|(e[5].value?512:0)|(e[8]&&e[8].value?32:0)|(e[9]&&e[9].value?16:0)|(e[10]&&e[10].value?64:0)|(e[11]&&e[11].value?128:0)|(e[12]&&e[12].value?1:0)|(e[13]&&e[13].value?2:0)|(e[14]&&e[14].value?4:0)|(e[15]&&e[15].value?8:0)}$N$(e){var t,i;e=e.buttons;let n=Math.round(255*(null===(t=e[6])||void 0===t?NaN:t.value));return(255&Math.round(255*(null===(i=e[7])||void 0===i?NaN:i.value)))<<8|255&n}$na$(e){var t,i;e=e.buttons;let n=Math.round(255*(null===(t=e[7])||void 0===t?NaN:t.value));return(255&Math.round(255*(null===(i=e[6])||void 0===i?NaN:i.value)))<<8|255&n}$K$(e,t,i){return(255&Math.round(127.5*(i.axes[t]+1)))<<8|255&Math.round(127.5*(i.axes[e]+1))}$L$(e){return e.axes}$la$(e){return[e.axes[0],-e.axes[1],e.axes[2],-e.axes[3]]}$Z$(e){return[e.axes[0],e.axes[1],e.axes[2],e.axes[5]]}$ja$(e){return[e.axes[0],e.axes[1],e.axes[3],e.axes[4]]}$ma$(e){var t,i,n,s,o,r;let a=e.buttons;return e=e.axes,(null!==(t=a[0])&&void 0!==t&&t.value?4096:0)|(null!==(i=a[1])&&void 0!==i&&i.value?8192:0)|(null!==(n=a[2])&&void 0!==n&&n.value?16384:0)|(null!==(s=a[3])&&void 0!==s&&s.value?32768:0)|(null!==(o=a[4])&&void 0!==o&&o.value?256:0)|(null!==(r=a[5])&&void 0!==r&&r.value?512:0)|(0<e[5]?1:0)|(0>e[5]?2:0)|(0>e[4]?4:0)|(0<e[4]?8:0)}$ka$(e){var t,i,n,s,o,r,a,$,c,d;let l=e.buttons;return e=this.$H$?Ko(e.axes[6],e.axes[7]):Wo(e.axes[9]),(null!==(t=l[1])&&void 0!==t&&t.value?4096:0)|(null!==(i=l[2])&&void 0!==i&&i.value?8192:0)|(null!==(n=l[0])&&void 0!==n&&n.value?16384:0)|(null!==(s=l[3])&&void 0!==s&&s.value?32768:0)|(null!==(o=l[4])&&void 0!==o&&o.value?256:0)|(null!==(r=l[5])&&void 0!==r&&r.value?512:0)|(null!==(a=l[8])&&void 0!==a&&a.value?32:0)|(null!==($=l[9])&&void 0!==$&&$.value?16:0)|(null!==(c=l[10])&&void 0!==c&&c.value?64:0)|(null!==(d=l[11])&&void 0!==d&&d.value?128:0)|e}$oa$(e){var t,i,n,s,o,r,a,$,c,d;let l=e.buttons;return e=Wo(e.axes[9]),(null!==(t=l[0])&&void 0!==t&&t.value?4096:0)|(null!==(i=l[1])&&void 0!==i&&i.value?8192:0)|(null!==(n=l[3])&&void 0!==n&&n.value?16384:0)|(null!==(s=l[4])&&void 0!==s&&s.value?32768:0)|(null!==(o=l[6])&&void 0!==o&&o.value?256:0)|(null!==(r=l[7])&&void 0!==r&&r.value?512:0)|(null!==(a=l[10])&&void 0!==a&&a.value?32:0)|(null!==($=l[11])&&void 0!==$&&$.value?16:0)|(null!==(c=l[13])&&void 0!==c&&c.value?64:0)|(null!==(d=l[14])&&void 0!==d&&d.value?128:0)|e}$pa$(e){var t,i,n,s,o,r,a,$,c,d;let l=e.buttons;return e=Ko(e.axes[6],e.axes[7]),(null!==(t=l[0])&&void 0!==t&&t.value?4096:0)|(null!==(i=l[1])&&void 0!==i&&i.value?8192:0)|(null!==(n=l[2])&&void 0!==n&&n.value?16384:0)|(null!==(s=l[3])&&void 0!==s&&s.value?32768:0)|(null!==(o=l[4])&&void 0!==o&&o.value?256:0)|(null!==(r=l[5])&&void 0!==r&&r.value?512:0)|(null!==(a=l[6])&&void 0!==a&&a.value?32:0)|(null!==($=l[7])&&void 0!==$&&$.value?16:0)|(null!==(c=l[9])&&void 0!==c&&c.value?64:0)|(null!==(d=l[10])&&void 0!==d&&d.value?128:0)|e}$virtualGamepadUpdateHandler$(){for(const e of this.$l$)e.$virtualGamepadUpdateHandler$(this.$g$.$v_buttons$,this.$g$.$v_trigger$,this.$g$.$v_index$,this.$g$.$v_axes$,this.$j$)}$W$(){var e=performance.now();this.$ea$&&(this.maxSchedulingDelay=Math.max(this.maxSchedulingDelay,e-this.$ea$-this.gamepadPollInterval)),this.$ea$=e,zo(this),e=0;for(let s of this.$h$){if(!s)continue;const o=Bt(s.$device$.timestamp);let r=s.$device$;if(Ro(this,r))if(s.$device$.timestamp<=this.$A$[r.index])this.$ha$&&5e3<=performance.now()-s.$device$.timestamp&&this.$ha$();else{this.$A$[r.index]=s.$device$.timestamp;var t,i=this.$B$[r.index],n=new yo(s);if((t=i)&&(t=i.buttons==n.buttons&&i.$triggers$==n.$triggers$)){e:{for(i=i.axes,t=0;t<i.length;t++)if(.01<Math.abs(i[t]-n.axes[t])){i=!0;break e}i=!1}t=!i}if(!t){if(this.$B$[r.index]=n,n=s.$getTriggerMapping$(r),i=s.$getButtonMapping$(r),t=s.$getAxesMapping$(r),ut.$rsdmmThumbstickToggle$)if(i&(b(this.$platformDetails$)?64:128)){if(this.$T$){this.$T$=!1;const e=performance.now();e<this.$S$+500?(xo(this),this.$S$=0):this.$S$=e}}else this.$T$=!0;for(const s of this.$l$)s.$gamepadStateUpdateHandler$(e,r.index,i,n,t,o,this.$j$,r.id);e++,Jo(s.$telemetryData$,i,n,t)}}}if(e){ct($t());for(const t of this.$l$)t.$finalizeGamepadData$(e)}this.$g$.$v_connected$&&this.$g$.$v_updated$&&(this.$virtualGamepadUpdateHandler$(),this.$g$.$v_updated$=!1,this.$s$&&Jo(this.$s$,this.$g$.$v_buttons$,this.$g$.$v_trigger$,this.$g$.$v_axes$))}getVirtualGamepadHandler(){return this.$qa$}}(this.$platformDetails$,e),ut.$gamepadTesterEnabled$&&(this.$D$.$l$.push(this.$R$),_o(this.$D$)),this.$V$=this.$da$.bind(this),fe(this.$l$),function(e){var t,i,n;if(ut.$ragnarokConfig$.sendNonEssentialMetricEvents){var s=performance.getEntriesByName("GfnJsInitStart")[0];const o=performance.getEntriesByName("platformBegin")[0],r=performance.getEntriesByName("GfnRBegin")[0],a=performance.getEntriesByType("navigation");s=Math.round(null!==(t=null==s?void 0:s.startTime)&&void 0!==t?t:-1),t=Math.round(null!==(i=null==o?void 0:o.startTime)&&void 0!==i?i:-1),io(e.$l$,"PerformanceTiming","application timings",s,t,Math.round(null!==(n=null==r?void 0:r.startTime)&&void 0!==n?n:-1),t-s),a.length?(i=a[a.length-1],io(e.$l$,"PerformanceTiming","load timings",Math.round(i.loadEventStart),Math.round(i.loadEventEnd),Math.round(i.domContentLoadedEventStart),Math.round(i.domContentLoadedEventEnd))):io(e.$l$,"PerformanceTiming","navigation timings unsupported",0,0,0,0)}}(this),function(e){if(navigator.mediaCapabilities){var t=performance.now();bn("h264").then((async i=>{if(i){i=bn("h264; profile-level-id=640033",2560,1440,60);var n=bn("h264; profile-level-id=64e033",2560,1440,60);i=An(await i),n=An(await n);const r=performance.now()-t;var s=wn(),o=bn("h264",1920,1080,120);s=An(await s),o=An(await o);const a=await Sn(yn),$=await async function(){return 117<=await Sn(yn,!1)}();d.d("{9d1820c}","{1efbc27}",a,$),io(e.$l$,"DisplayCaps","Is120FpsSupported: "+$,a,0,0,0),io(e.$l$,"MediaCapabilities","codec 5.1: "+i+" 5.1 constrained: "+n+" AV1: "+s,r,o,i|n,Math.round(window.screen.height))}else io(e.$l$,"MediaCapabilities","webrtc unsupported",performance.now()-t,-1,-1,-1)}))}else io(e.$l$,"MediaCapabilities","API unsupported",-1,-1,-1,-1)}(this),ut.$ragnarokConfig$.sendNonEssentialMetricEvents&&io(this.$l$,"PlatformDetailsExecutionTime","",this.$platformDetails$.totalTime,0,0,0),to.$h$.push((e=>{var t;null===(t=this.$g$)||void 0===t||t.setNetworkType(e)}))}$ja$(e){var t;return d.e("{9d1820c}","{8516485}",e.filename,e.lineno,e.colno),this.$l$.$g$(e.error,e.error&&e.error.message?e.error.message:e.message,e.filename,e.lineno,e.colno,!1),(null===(t=ut.$ragnarokConfig$.terminateUnhandledException)||void 0===t||t)&&Ar(this,3237093392),!1}$la$(){var e,t;this.$U$||(this.$U$=!0,Ar(this,(null!==(e=this.$I$)&&void 0!==e?e:null!==(t=this.$h$)&&void 0!==t&&t.$C$)?15867912:15867905))}$ia$(){d.i("{9d1820c}","{a9a135f}"),mr(this.$o$)}$ma$(){var e;if(d.i("{9d1820c}","{478a408}",document.visibilityState,!!this.$h$),this.$h$){var t=this.$s$.$validatedStreamParams$[0].$videoElement$,i=this.$s$.$validatedStreamParams$[0].$audioElement$,n=B(this.$platformDetails$,!1,15,4)&&ut.$allowMutingVideo$,s=B(this.$platformDetails$,!1,15,4)&&this.$micEnabled$&&ut.$allowEnableMic$;"hidden"===document.visibilityState?(this.$Z$=performance.now(),n&&(d.i("{9d1820c}","{cbd3b6e}"),t.muted=!0,i.muted=!0),yr(this)):"visible"===document.visibilityState&&(n&&(d.i("{9d1820c}","{05deefa}"),t.muted=!1,i.muted=!1),s?(t=null!==(e=ut.$ragnarokConfig$.userTerminatedMicRecorderThreshold)&&void 0!==e?e:2e3,this.$Z$-this.$m$.$J$<t?(d.i("{9d1820c}","{862bd20}"),this.$m$.$F$=!0,this.setMicRecordingEnabled(!0)):this.$micEnabled$=!1):B(this.$platformDetails$,!1,15,4)&&!this.$m$.$v$&&"Built-in Microphone"===this.$m$.$u$&&this.$m$.$A$&&co(this.$m$,"visibilityChange"))}}$ha$(e){d.d("{9d1820c}","{972bb72}",JSON.stringify(e)),no(this.$l$,e)}$ea$(e){this.emit("ActiveSessionsResult",e)}$fa$(e){this.emit("ProgressUpdate",e)}$ga$(e){this.emit("SessionUpdate",e)}initialize(e,t=ot){var i,n,s,o,r,a,$,c;if(d.i("{9d1820c}","{2569364}","Local"),d.d("{9d1820c}","{e85ad66}",navigator.userAgent),!e)return d.e("{9d1820c}","{a98b177}"),!1;if(Object.assign(this.$j$,e),null===(i=this.$g$)||void 0===i||i.uninitialize(),!this.$j$.serverAddress||S(this.$j$.serverAddress))d.d("{9d1820c}","{e2d9a04}"),this.$g$=new st;else if(this.$j$.serverAddress.startsWith("mockpm://"))d.d("{9d1820c}","{4a79d8e}"),this.$g$=new fr,this.$j$.serverAddress=this.$j$.serverAddress.replace("mockpm://","");else{if(!this.$j$.authTokenCallback)return d.e("{9d1820c}","{28d1400}"),!1;this.$g$=new nt(this.$platformDetails$,!0)}e=this.$g$,d.d("{9d1820c}","{3c652b7}"),vr(this),e.addListener("TelemetryEvent",this.$ha$.bind(this)),e.addListener("Log",this.$N$.bind(this)),e.addListener("ActiveSessionsResult",this.$ea$.bind(this)),e.addListener("ProgressUpdate",this.$fa$.bind(this)),e.addListener("SessionUpdate",this.$ga$.bind(this)),this.$j$.clientHeaders=null!==(n=this.$j$.clientHeaders)&&void 0!==n?n:new Map,(i="NATIVE"!==(n=ut.clientType||this.$j$.clientType||"BROWSER"))&&this.$j$.clientHeaders.set("nv-browser-version",this.$platformDetails$.browserFullVer);const l={deviceOs:null!==(s=ut.deviceOs)&&void 0!==s?s:this.$platformDetails$.deviceOS,deviceOsVer:this.$platformDetails$.osVer,deviceType:null!==(o=ut.deviceType)&&void 0!==o?o:this.$platformDetails$.deviceType,deviceModel:null!==(r=ut.deviceModel)&&void 0!==r?r:this.$platformDetails$.deviceModel,clientIdentification:null!==(a=this.$j$.clientIdentification)&&void 0!==a?a:"GFN-PC",clientVersion:null!==($=this.$j$.clientVersion)&&void 0!==$?$:"26.0",clientAppVersion:this.$j$.clientAppVersion,clientStreamer:null!==(c=ut.clientStreamer)&&void 0!==c?c:"WEBRTC",clientId:ut.clientId||this.$j$.clientId,browserType:i?this.$platformDetails$.browser.toUpperCase():void 0,clientPlatformName:ut.clientPlatformName||"browser",clientType:n,deviceHashId:this.$j$.deviceHashId,serverAddress:this.$j$.serverAddress,authTokenCallback:this.$j$.authTokenCallback,clientHeaders:this.$j$.clientHeaders};return e.initialize(l),e.setNetworkType(to.$g$),this.$S$=t,this.$l$.clientShutDownCallback=this.$j$.clientShutDownCallback,!0}downloadAudio(){this.$P$.downloadAudio()}updateEventDataElements(e){var t;d.i("{9d1820c}","{4008dc4}",JSON.stringify(e)),this.$o$.updateEventDataElements(e),e.telemetryEventIds&&(null===(t=this.$g$)||void 0===t||t.updateTelemetryEventIds(e.telemetryEventIds)),this.$h$&&!this.$G$&&yr(this)}getActiveSessions(){this.$g$?this.$g$.getAllActiveSessions():this.emit("ActiveSessionsResult",{sessionList:[],error:kr("ActiveSessions")})}startSession(e){jr(this,!1),(e=Rr(this,e))&&Er(this,0,e)}getSession(e){this.$g$?this.$g$.getSession(e,!1).then((e=>{var t,i;let n={sessionId:null!==(t=null==e?void 0:e.sessionId)&&void 0!==t?t:"",appId:null==e?void 0:e.appId,subSessionId:null!==(i=null==e?void 0:e.subSessionId)&&void 0!==i?i:"",state:null==e?void 0:e.state,status:null==e?void 0:e.state};this.emit("GetSessionResult",n)})).catch((t=>{var i,n;let s={sessionId:e,subSessionId:null!==(n=null===(i=this.$g$)||void 0===i?void 0:i.getSubSessionId())&&void 0!==n?n:"",error:t};this.emit("GetSessionResult",s)})):this.emit("GetSessionResult",{sessionId:"",subSessionId:"",error:kr("GetSession")})}resume(){this.resumeSession(this.$s$.$sessionParams$,this.$g$.getSessionId())}resumeSession(e,t){jr(this,!0),(e=Rr(this,e))&&Er(this,2,e,t)}stopSession(e,t){var i,n,s,o,r,a,$;this.$g$?(void 0!==t&&d.i("{9d1820c}","{ae7f61b}",y(t)),e===this.$g$.getSessionId()||void 0===e?(15867910===t?this.$O$=!0:this.$M$=!1,mo(this.$m$),this.framesDecoded=null!==(n=null===(i=this.$h$)||void 0===i?void 0:Ws(i))&&void 0!==n?n:0,go(this.$C$),i=Sr(this,{sessionId:null!==(s=this.$g$.getSessionId())&&void 0!==s?s:"",subSessionId:null!==(o=this.$g$.getSubSessionId())&&void 0!==o?o:"",error:t?{code:t}:void 0,zoneName:null!==(r=this.$g$.getZoneName())&&void 0!==r?r:"",zoneAddress:this.$g$.getZoneAddress()||this.$j$.serverAddress,gpuType:null!==(a=this.$g$.getGpuType())&&void 0!==a?a:"",isResume:this.isResume},performance.now()-this.startTime),e=null!==($=this.$g$.getSessionId())&&void 0!==$?$:"",this.$h$?(this.$B$=!1,Pr(this),this.$h$.$C$&&wr(this,i),Dr(this,null!=t?t:this.$h$.$C$?15859712:15867905),15867910===t?(d.d("{9d1820c}","{12bc45e}",e),xr(this,e)):this.sendDeleteRequest(e,this.$g$)):this.$v$?xr(this,e):this.cancelSessionSetup()):e&&this.sendDeleteRequest(e,this.$g$)):this.emit("SessionStopResult",{sessionId:"",subSessionId:"",error:kr("StopSession")})}pauseSession(e){this.stopSession(e,15867910)}sendDeleteRequest(e,t){t.sendDeleteRequest(e).then((()=>{d.d("{9d1820c}","{fee1eea}",e),xr(this,e)}),(t=>{d.e("{9d1820c}","{50e2a6e}",e),xr(this,e,t)}))}isMicSupported(){return fo}setMicRecordingEnabled(e){d.i("{9d1820c}","{f5b2f30}",e),e?(this.$micEnabled$=!0,uo(this.$m$)):(this.$micEnabled$=!1,$o(this.$m$))}getMicState(){var e;e=this.$m$,!1!==ut.$micEnabled$&&(e.$m$||3==e.$h$||2==e.$h$||6==e.$h$||7==e.$h$?ao(e,e.$h$):ro().then((t=>{0!==t&&ao(e,t)})))}shouldDefaultEnableMic(){return this.$m$.shouldDefaultEnableMic()}sendCustomMessage(e){var t;null===(t=this.$h$)||void 0===t||t.sendCustomMessage(e)}toggleUserInput(e,t){var i;null===(i=this.$h$)||void 0===i||i.toggleUserInput(e,t),this.$M$=e,this.$aa$=t}toggleRsdmm(e){xo(this.$D$,e)}getVirtualGamepadHandler(){var e;return null===(e=this.$h$)||void 0===e?void 0:e.getVirtualGamepadHandler()}setAuthInfo(e){var t;null===(t=this.$g$)||void 0===t||t.setAuthInfo(e)}sendTextInput(e){var t;null===(t=this.$h$)||void 0===t||t.sendTextInput(e)}setVirtualKeyboardState(e){var t;null===(t=this.$h$)||void 0===t||t.setVirtualKeyboardState(e)}setVideoTransforms(e,t,i){var n;null===(n=this.$h$)||void 0===n||n.setVideoTransforms(e,t,i)}toggleOnScreenStats(){var e;null===(e=this.$h$)||void 0===e||e.toggleOnScreenStats()}toggleStutterIndicator(){var e;null===(e=this.$h$)||void 0===e||e.toggleStutterIndicator()}setKeyboardLayout(e){var t;d.i("{9d1820c}","{10717a6}",e),null===(t=this.$h$)||void 0===t||t.setKeyboardLayout(e)}sendKeyEvent(e){var t;null===(t=this.$h$)||void 0===t||t.sendKeyEvent(e)}setStreamingMaxBitrate(e,t=0){var i;null===(i=this.$h$)||void 0===i||i.setStreamingMaxBitrate(t,e)}setDrcDfcState(e,t=0){var i;null===(i=this.$h$)||void 0===i||i.setDrcDfcState(t,e)}$da$(e){var t;e.detail.idle&&(null===(t=this.$h$)||void 0===t||Os(t,2,60),this.$K$=window.setTimeout((()=>{var e;null===(e=this.$h$)||void 0===e||Ps(e,15867913)}),6e4))}$ba$(){var e,t;e=this.$m$,t=this.$H$,ho(e).then((()=>{0!==t&&B(e.$platformDetails$,!1,15,4)&&!e.$v$&&"Built-in Microphone"===e.$u$&&(e.$micEnabled$||e.$A$)&&co(e,"deviceChange")})),this.$H$++}cancelSessionSetup(){!this.$h$&&this.$g$&&this.$g$.cancelSessionSetup()}},window.Ragnarok.defaultInputConfigFlags=ot,window.Ragnarok.ChooseStreamingSettings=function(e=0,t,i){return wt(e,t,St(i))},window.Ragnarok.ChooseStreamingResolution=function(e=0,t){return wt(e,t=null==t?void 0:t.map((e=>({resolution:e,frameRate:60}))),St()).resolution},window.Ragnarok.CalculateMaxBitrateKbps=At,window.Ragnarok.CalculateDataUsage=function(e,t){return t*=1e3,t=3600*(120===e?.916*t+293098:.678*t+910569)/1e9/8,30===e&&(t*=.625),Math.round(.95*t)},window.Ragnarok.InitializeUtils=function(){for(const e of Rt)e()},window.Ragnarok.IsFeatureSupported=function(e,t){if(0===e){if(w(t))t=B(t,!1,14);else{switch(e=!1,window.chrome&&(e=!0),t.browser){case"Edge_Legacy":case"Safari":e=!0}t=e}return t}return!1},window.Ragnarok.GetSupportedAudioChannelCount=function(){const e=Mt();if(e){const t=e.destination.maxChannelCount;return e.close(),d.i("{d988e7f}","{fa78e0a}",t),t}return d.w("{d988e7f}","{d018fac}"),2},window.Ragnarok.GetDeviceCapabilities=async function(e){return async function(e){var t=screen.width,i=screen.height,n=window.devicePixelRatio;return[t,i]=bt([t,i]),i={width:Math.round(t*n),height:Math.round(i*n),fps:60,scaleFactor:Math.round(100*n)},n=void 0,4&e||8&e?n={width:3840,height:2160,fps:i.fps}:2&e&&1366<=t&&(n={width:1600,height:1200,fps:i.fps}),{displayMode:i,maxAutoMode:n,maxSupportedModes:[{width:3840,height:2400,fps:120}],features:{vsync:!0,vvsync:!1,hdr:!1,reflex:!1,audioChannelCount:e=await async function(){var e=Mt();if(e){const t=e.destination.maxChannelCount;return e.close(),d.i("{d988e7f}","{fa78e0a}",t),e=await Ot(),Math.min(t,e)}return d.w("{d988e7f}","{d018fac}"),2}()}}}(St(e))},window.Ragnarok.VirtualGamepadHandler=So,window.Ragnarok.ConfigureRagnarokSettings=function(e){var t,i,n,s,o,r,a,$,c,l,u,h,p,m,f,g,v,A,b,w,S,y,k,C,_,E,T,I,P,j,R,D,x,M,L,O,B,N,F,V,U,G,H,z,W,K;if(d.i("{fbd6ce8}","{4acfb3a}",JSON.stringify(e)),e.clientConfigOverride&&(ut.clientConfigOverride=e.clientConfigOverride),e.gxtOverrideData){var J=JSON.parse(e.gxtOverrideData);if(J.params)for(var q of J.params)"ragnarok"===q.name&&(ut.$ragnarokConfig$=q.value,ut.$remoteOverrideInfo$={type:"GXT",version:q.version})}else e.remoteConfigData&&e.remoteConfigData.ragnarok&&(ut.$ragnarokConfig$=JSON.parse(e.remoteConfigData.ragnarok),ut.$remoteOverrideInfo$={type:"RCONFIG",version:null!==(J=e.remoteConfigData.version)&&void 0!==J?J:""});if(e.isInternalUser&&(ut.isInternalUser=e.isInternalUser),e.overrideData){q=new URLSearchParams(e.overrideData);let J=new URLSearchParams;for(const[e,t]of q.entries())J.append(e.toLowerCase(),t);if("lean"===(null===(t=J.get("mode"))||void 0===t?void 0:t.toLowerCase())?(ut.$leanMode$=!0,ut.$loggingEnabled$=!1,ut.$gamepadEnabled$=!1,ut.$webrtcStatsEnabled$=!1,ut.$statsUploadEnabled$=!1,ut.$micEnabled$=!1,ut.stutterIndicator=!0,ut.isInternalUser=!0):"dev"===(null===(i=J.get("mode"))||void 0===i?void 0:i.toLowerCase())&&(ut.stutterIndicator=!0,ut.isInternalUser=!0),t=e=>{e:{if(e=J.get(e))switch(e.toLowerCase()){case"enable":case"on":case"1":case"true":e=!0;break e;case"disable":case"off":case"0":case"false":e=!1;break e}e=void 0}return e},i=e=>((e=J.get(e))&&(e=Number.parseInt(e),!Number.isNaN(e))||(e=void 0),e),q=e=>((e=J.get(e))&&(e=Number.parseFloat(e),!Number.isNaN(e))||(e=void 0),e),ut.$loggingEnabled$=null!==(n=t("log"))&&void 0!==n?n:ut.$loggingEnabled$,ut.$consoleLoggingEnabled$=ut.$loggingEnabled$&&(null!==(s=t("console"))&&void 0!==s?s:ut.$consoleLoggingEnabled$),ut.$gamepadEnabled$=null!==(o=t("gamepad"))&&void 0!==o?o:ut.$gamepadEnabled$,ut.$webrtcStatsEnabled$=null!==(r=t("webrtcstats"))&&void 0!==r?r:ut.$webrtcStatsEnabled$,ut.$statsUploadEnabled$=null!==(a=t("statsupload"))&&void 0!==a?a:ut.$statsUploadEnabled$,ut.$micEnabled$=null!==($=t("mic"))&&void 0!==$?$:ut.$micEnabled$,ut.$mouseFilter$=null!==(c=t("mousefilter"))&&void 0!==c?c:ut.$mouseFilter$,ut.unadjustedMovement=null!==(l=t("unadjustedmovement"))&&void 0!==l?l:ut.unadjustedMovement,ut.maxBitrate=null!==(u=i("bitrate"))&&void 0!==u?u:ut.maxBitrate,0<ut.maxBitrate&&100>=ut.maxBitrate&&(ut.maxBitrate*=1e3),ut.$gamepadTesterEnabled$=null!==(h=t("gamepadtest"))&&void 0!==h?h:ut.$gamepadTesterEnabled$,ut.$allowSendingTelemetry$=null!==(p=t("allowtelemetry"))&&void 0!==p?p:ut.$allowSendingTelemetry$,(n=J.get("resolution"))&&(2==(o=n.toLowerCase().split("x")).length?(s=parseInt(o[0]),o=parseInt(o[1]),s&&o?(ut.$resWidth$=s,ut.$resHeight$=o):d.e("{fbd6ce8}","{c87835d}",n)):d.e("{fbd6ce8}","{c87835d}",n)),ut.fps=null!==(m=i("fps"))&&void 0!==m?m:ut.fps,ut.$gamepadRaf$=null!==(f=t("gamepadraf"))&&void 0!==f?f:ut.$gamepadRaf$,ut.gamepadPollInterval=null!==(g=i("gamepadpoll"))&&void 0!==g?g:ut.gamepadPollInterval,ut.$advancedGestures$=null!==(v=t("advancedgestures"))&&void 0!==v?v:ut.$advancedGestures$,ut.$forceTouchCapable$=null!==(A=t("forcetouchdevice"))&&void 0!==A?A:ut.$forceTouchCapable$,void 0!==(m=t("touch"))&&(ut.appLaunchMode=m?2:0,ut.$forceTouchCapable$=m),ut.$storeTouch$=null!==(b=t("storetouch"))&&void 0!==b?b:ut.$storeTouch$,ut.$storeTouchGesture$=null!==(w=t("storetouchgesture"))&&void 0!==w?w:ut.$storeTouchGesture$,ut.$touchWarp$=null!==(S=t("touchwarp"))&&void 0!==S?S:ut.$touchWarp$,ut.$latencyTest$=null!==(y=t("latency"))&&void 0!==y?y:ut.$latencyTest$,ut.deviceOs=null!==(k=J.get("deviceos"))&&void 0!==k?k:ut.deviceOs,ut.deviceType=null!==(C=J.get("devicetype"))&&void 0!==C?C:ut.deviceType,ut.clientStreamer=null!==(_=J.get("clientstreamer"))&&void 0!==_?_:ut.clientStreamer,ut.clientId=null!==(E=J.get("clientid"))&&void 0!==E?E:ut.clientId,ut.clientPlatformName=null!==(T=J.get("clientplatformname"))&&void 0!==T?T:ut.clientPlatformName,ut.clientType=null!==(I=J.get("clienttype"))&&void 0!==I?I:ut.clientType,ut.appLaunchMode=null!==(P=i("applaunchmode"))&&void 0!==P?P:ut.appLaunchMode,ut.$rsdmm$=null!==(j=t("rsdmm"))&&void 0!==j?j:ut.$rsdmm$,ut.$rsdmmThumbstickToggle$=null!==(R=t("rsdmmtoggle"))&&void 0!==R?R:ut.$rsdmmThumbstickToggle$,null===(D=t("ioswars"))||void 0===D||D||(ut.$allowAudioReset$=!1,ut.$allowAutoplayChange$=!1,ut.$allowSourceReset$=!1,ut.$allowEnableMic$=!1,ut.$allowMutingVideo$=!1),ut.$allowAudioReset$=null!==(x=t("audioreset"))&&void 0!==x?x:ut.$allowAudioReset$,ut.$allowSourceReset$=null!==(M=t("sourcereset"))&&void 0!==M?M:ut.$allowSourceReset$,ut.$allowAutoplayChange$=null!==(L=t("autoplaychange"))&&void 0!==L?L:ut.$allowAutoplayChange$,ut.bitsPerPixel=null!==(O=q("bitsperpixel"))&&void 0!==O?O:ut.bitsPerPixel,ut.bitsPerPixel1440p=null!==(B=q("bitsperpixel1440p"))&&void 0!==B?B:ut.bitsPerPixel1440p,ut.$is1440pSupported$=null!==(N=t("1440p"))&&void 0!==N?N:ut.$is1440pSupported$,ut.stutterIndicator=null!==(F=t("stutter"))&&void 0!==F?F:ut.stutterIndicator,ut.combineStreams=null!==(V=t("combinestreams"))&&void 0!==V?V:ut.combineStreams,J.has("meta")){ut.$sessionMetaData$={};for(const e of J.getAll("meta"))2===(b=e.split("~")).length&&(ut.$sessionMetaData$[b[0]]=b[1])}ut.allowHaptics=null!==(U=t("haptics"))&&void 0!==U?U:ut.allowHaptics,ut.enableAv1Support=null!==(G=t("av1"))&&void 0!==G?G:ut.enableAv1Support,ut.codecList=null!==(K="codeclist",H=K=(K=J.get(K))?K.split(","):void 0)&&void 0!==H?H:ut.codecList,ut.isInternalUser=null!==(z=t("internaluser"))&&void 0!==z?z:ut.isInternalUser,ut.hdr=null!==(W=t("hdr"))&&void 0!==W?W:ut.hdr}Re(e)},window.Ragnarok.RagnarokSettings=ut,window.Ragnarok.GridServer=nt,window.Ragnarok.PassThruServer=st,window.Ragnarok.ConfigureGridServerSettings=Re,window.Ragnarok.GridServerSettings=je,window.Ragnarok.TelemetryEventBase=De,window.Ragnarok.GridServer_GameLaunch_RequestDef=xe,window.Ragnarok.GS_FeatureDef=class extends De{constructor(e){super(e),this.name="GS_Feature",this.gdprLevel="functional"}},window.Ragnarok.GS_SystemAPICallResultDef=class extends De{constructor(e){super(e),this.name="GS_SystemAPICallResult",this.gdprLevel="functional"}},window.Ragnarok.GS_DebugInfoDef=Me,window.Ragnarok.GS_ExceptionInfoDef=Le,window.Ragnarok.GS_ClientMetricEventDef=Oe,window.Ragnarok.GS_ConnectivityCheckDef=class extends De{constructor(e){super(e),this.name="GS_ConnectivityCheck",this.gdprLevel="functional"}},window.Ragnarok.GS_Sleep_EventDef=Be,window.Ragnarok.GS_HttpCallResultDef=Ne,window.Ragnarok.GS_PropertyChange_EventDef=class extends De{constructor(e){super(e),this.name="GS_PropertyChange_Event",this.gdprLevel="functional"}},window.Ragnarok.GS_CodecError_EventDef=class extends De{constructor(e){super(e),this.name="GS_CodecError_Event",this.gdprLevel="functional"}},window.Ragnarok.GsTelemetryHandler=ze,window.Ragnarok.CHANGELIST="Local",window.Ragnarok.CLIENT_VERSION="26.0",window.Ragnarok.CLIENT_IDENTIFICATION="GFN-PC",window.Ragnarok.getPlatformDetails=function(){performance.mark("platformBegin");var e=we;return e.$Ta$||(e.$Ta$=q(e)),e.$Ta$},window.Ragnarok.performHttpRequest=j,window.Ragnarok.AddPlatformTelemetry=function(e){fe(e)},window.Ragnarok.LogImpl=c,window.Ragnarok.translatePlatformDetailsForPayload=function(e){return(null==Pe?void 0:Pe.$h$)!=e&&(Pe=new _e(e)),Pe.$m$},window.Ragnarok.translatePlatformDetailsForClientHeader=function(e){return(null==Pe?void 0:Pe.$h$)!=e&&(Pe=new _e(e)),Pe.$o$}},134:(e,t,i)=>{"use strict";var n=i(985);function s(e,t,i,s,o){var r=n.writeRtpDescription(e.kind,t);if(r+=n.writeIceParameters(e.iceGatherer.getLocalParameters()),r+=n.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===i?"actpass":o||"active"),r+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?r+="a=sendrecv\r\n":e.rtpSender?r+="a=sendonly\r\n":e.rtpReceiver?r+="a=recvonly\r\n":r+="a=inactive\r\n",e.rtpSender){var a=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=a;var $="msid:"+(s?s.id:"-")+" "+a+"\r\n";r+="a="+$,r+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+$,e.sendEncodingParameters[0].rtx&&(r+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+$,r+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return r+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+n.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(r+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+n.localCName+"\r\n"),r}function o(e,t){var i={codecs:[],headerExtensions:[],fecMechanisms:[]},n=function(e,t){e=parseInt(e,10);for(var i=0;i<t.length;i++)if(t[i].payloadType===e||t[i].preferredPayloadType===e)return t[i]},s=function(e,t,i,s){var o=n(e.parameters.apt,i),r=n(t.parameters.apt,s);return o&&r&&o.name.toLowerCase()===r.name.toLowerCase()};return e.codecs.forEach((function(n){for(var o=0;o<t.codecs.length;o++){var r=t.codecs[o];if(n.name.toLowerCase()===r.name.toLowerCase()&&n.clockRate===r.clockRate){if("rtx"===n.name.toLowerCase()&&n.parameters&&r.parameters.apt&&!s(n,r,e.codecs,t.codecs))continue;(r=JSON.parse(JSON.stringify(r))).numChannels=Math.min(n.numChannels,r.numChannels),i.codecs.push(r),r.rtcpFeedback=r.rtcpFeedback.filter((function(e){for(var t=0;t<n.rtcpFeedback.length;t++)if(n.rtcpFeedback[t].type===e.type&&n.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var n=0;n<t.headerExtensions.length;n++){var s=t.headerExtensions[n];if(e.uri===s.uri){i.headerExtensions.push(s);break}}})),i}function r(e,t,i){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(i)}function a(e,t){var i=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return i||e.addRemoteCandidate(t),!i}function $(e,t){var i=new Error(t);return i.name=e,i.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],i}e.exports=function(e,t){function i(t,i){i.addTrack(t),i.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function c(t,i,n,s){var o=new Event("track");o.track=i,o.receiver=n,o.transceiver={receiver:n},o.streams=s,e.setTimeout((function(){t._dispatchEvent("track",o)}))}var d=function(i){var s=this,o=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){s[e]=o[e].bind(o)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",i=JSON.parse(JSON.stringify(i||{})),this.usingBundle="max-bundle"===i.bundlePolicy,"negotiate"===i.rtcpMuxPolicy)throw $("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(i.rtcpMuxPolicy||(i.rtcpMuxPolicy="require"),i.iceTransportPolicy){case"all":case"relay":break;default:i.iceTransportPolicy="all"}switch(i.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:i.bundlePolicy="balanced"}if(i.iceServers=function(e,t){var i=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var n=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var s="string"==typeof n;return s&&(n=[n]),n=n.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||i?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(i=!0,!0)})),delete e.url,e.urls=s?n[0]:n,!!n.length}}))}(i.iceServers||[],t),this._iceGatherers=[],i.iceCandidatePoolSize)for(var r=i.iceCandidatePoolSize;r>0;r--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:i.iceServers,gatherPolicy:i.iceTransportPolicy}));else i.iceCandidatePoolSize=0;this._config=i,this.transceivers=[],this._sdpSessionId=n.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(d.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(d.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),d.prototype.onicecandidate=null,d.prototype.onaddstream=null,d.prototype.ontrack=null,d.prototype.onremovestream=null,d.prototype.onsignalingstatechange=null,d.prototype.oniceconnectionstatechange=null,d.prototype.onconnectionstatechange=null,d.prototype.onicegatheringstatechange=null,d.prototype.onnegotiationneeded=null,d.prototype.ondatachannel=null,d.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},d.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},d.prototype.getConfiguration=function(){return this._config},d.prototype.getLocalStreams=function(){return this.localStreams},d.prototype.getRemoteStreams=function(){return this.remoteStreams},d.prototype._createTransceiver=function(e,t){var i=this.transceivers.length>0,n={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&i)n.iceTransport=this.transceivers[0].iceTransport,n.dtlsTransport=this.transceivers[0].dtlsTransport;else{var s=this._createIceAndDtlsTransports();n.iceTransport=s.iceTransport,n.dtlsTransport=s.dtlsTransport}return t||this.transceivers.push(n),n},d.prototype.addTrack=function(t,i){if(this._isClosed)throw $("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var n;if(this.transceivers.find((function(e){return e.track===t})))throw $("InvalidAccessError","Track already exists.");for(var s=0;s<this.transceivers.length;s++)this.transceivers[s].track||this.transceivers[s].kind!==t.kind||(n=this.transceivers[s]);return n||(n=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(i)&&this.localStreams.push(i),n.track=t,n.stream=i,n.rtpSender=new e.RTCRtpSender(t,n.dtlsTransport),n.rtpSender},d.prototype.addStream=function(e){var i=this;if(t>=15025)e.getTracks().forEach((function(t){i.addTrack(t,e)}));else{var n=e.clone();e.getTracks().forEach((function(e,t){var i=n.getTracks()[t];e.addEventListener("enabled",(function(e){i.enabled=e.enabled}))})),n.getTracks().forEach((function(e){i.addTrack(e,n)}))}},d.prototype.removeTrack=function(t){if(this._isClosed)throw $("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var i=this.transceivers.find((function(e){return e.rtpSender===t}));if(!i)throw $("InvalidAccessError","Sender was not created by this connection.");var n=i.stream;i.rtpSender.stop(),i.rtpSender=null,i.track=null,i.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(n)&&this.localStreams.indexOf(n)>-1&&this.localStreams.splice(this.localStreams.indexOf(n),1),this._maybeFireNegotiationNeeded()},d.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var i=t.getSenders().find((function(t){return t.track===e}));i&&t.removeTrack(i)}))},d.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},d.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},d.prototype._createIceGatherer=function(t,i){var n=this;if(i&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var s=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(s,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var i=!e.candidate||0===Object.keys(e.candidate).length;s.state=i?"completed":"gathering",null!==n.transceivers[t].bufferedCandidateEvents&&n.transceivers[t].bufferedCandidateEvents.push(e)},s.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),s},d.prototype._gather=function(t,i){var s=this,o=this.transceivers[i].iceGatherer;if(!o.onlocalcandidate){var r=this.transceivers[i].bufferedCandidateEvents;this.transceivers[i].bufferedCandidateEvents=null,o.removeEventListener("localcandidate",this.transceivers[i].bufferCandidates),o.onlocalcandidate=function(e){if(!(s.usingBundle&&i>0)){var r=new Event("icecandidate");r.candidate={sdpMid:t,sdpMLineIndex:i};var a=e.candidate,$=!a||0===Object.keys(a).length;if($)"new"!==o.state&&"gathering"!==o.state||(o.state="completed");else{"new"===o.state&&(o.state="gathering"),a.component=1,a.ufrag=o.getLocalParameters().usernameFragment;var c=n.writeCandidate(a);r.candidate=Object.assign(r.candidate,n.parseCandidate(c)),r.candidate.candidate=c,r.candidate.toJSON=function(){return{candidate:r.candidate.candidate,sdpMid:r.candidate.sdpMid,sdpMLineIndex:r.candidate.sdpMLineIndex,usernameFragment:r.candidate.usernameFragment}}}var d=n.getMediaSections(s._localDescription.sdp);d[r.candidate.sdpMLineIndex]+=$?"a=end-of-candidates\r\n":"a="+r.candidate.candidate+"\r\n",s._localDescription.sdp=n.getDescription(s._localDescription.sdp)+d.join("");var l=s.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==s.iceGatheringState&&(s.iceGatheringState="gathering",s._emitGatheringStateChange()),$||s._dispatchEvent("icecandidate",r),l&&(s._dispatchEvent("icecandidate",new Event("icecandidate")),s.iceGatheringState="complete",s._emitGatheringStateChange())}},e.setTimeout((function(){r.forEach((function(e){o.onlocalcandidate(e)}))}),0)}},d.prototype._createIceAndDtlsTransports=function(){var t=this,i=new e.RTCIceTransport(null);i.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var n=new e.RTCDtlsTransport(i);return n.ondtlsstatechange=function(){t._updateConnectionState()},n.onerror=function(){Object.defineProperty(n,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:i,dtlsTransport:n}},d.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var i=this.transceivers[e].iceTransport;i&&(delete i.onicestatechange,delete this.transceivers[e].iceTransport);var n=this.transceivers[e].dtlsTransport;n&&(delete n.ondtlsstatechange,delete n.onerror,delete this.transceivers[e].dtlsTransport)},d.prototype._transceive=function(e,i,s){var r=o(e.localCapabilities,e.remoteCapabilities);i&&e.rtpSender&&(r.encodings=e.sendEncodingParameters,r.rtcp={cname:n.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(r.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(r)),s&&e.rtpReceiver&&r.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?r.encodings=e.recvEncodingParameters:r.encodings=[{}],r.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(r.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(r.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(r))},d.prototype.setLocalDescription=function(e){var t,i,s=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject($("TypeError",'Unsupported type "'+e.type+'"'));if(!r("setLocalDescription",e.type,s.signalingState)||s._isClosed)return Promise.reject($("InvalidStateError","Can not set local "+e.type+" in state "+s.signalingState));if("offer"===e.type)t=n.splitSections(e.sdp),i=t.shift(),t.forEach((function(e,t){var i=n.parseRtpParameters(e);s.transceivers[t].localCapabilities=i})),s.transceivers.forEach((function(e,t){s._gather(e.mid,t)}));else if("answer"===e.type){t=n.splitSections(s._remoteDescription.sdp),i=t.shift();var a=n.matchPrefix(i,"a=ice-lite").length>0;t.forEach((function(e,t){var r=s.transceivers[t],$=r.iceGatherer,c=r.iceTransport,d=r.dtlsTransport,l=r.localCapabilities,u=r.remoteCapabilities;if(!(n.isRejected(e)&&0===n.matchPrefix(e,"a=bundle-only").length||r.rejected)){var h=n.getIceParameters(e,i),p=n.getDtlsParameters(e,i);a&&(p.role="server"),s.usingBundle&&0!==t||(s._gather(r.mid,t),"new"===c.state&&c.start($,h,a?"controlling":"controlled"),"new"===d.state&&d.start(p));var m=o(l,u);s._transceive(r,m.codecs.length>0,!1)}}))}return s._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?s._updateSignalingState("have-local-offer"):s._updateSignalingState("stable"),Promise.resolve()},d.prototype.setRemoteDescription=function(s){var d=this;if(-1===["offer","answer"].indexOf(s.type))return Promise.reject($("TypeError",'Unsupported type "'+s.type+'"'));if(!r("setRemoteDescription",s.type,d.signalingState)||d._isClosed)return Promise.reject($("InvalidStateError","Can not set remote "+s.type+" in state "+d.signalingState));var l={};d.remoteStreams.forEach((function(e){l[e.id]=e}));var u=[],h=n.splitSections(s.sdp),p=h.shift(),m=n.matchPrefix(p,"a=ice-lite").length>0,f=n.matchPrefix(p,"a=group:BUNDLE ").length>0;d.usingBundle=f;var g=n.matchPrefix(p,"a=ice-options:")[0];return d.canTrickleIceCandidates=!!g&&g.substr(14).split(" ").indexOf("trickle")>=0,h.forEach((function(r,$){var c=n.splitLines(r),h=n.getKind(r),g=n.isRejected(r)&&0===n.matchPrefix(r,"a=bundle-only").length,v=c[0].substr(2).split(" ")[2],A=n.getDirection(r,p),b=n.parseMsid(r),w=n.getMid(r)||n.generateIdentifier();if(g||"application"===h&&("DTLS/SCTP"===v||"UDP/DTLS/SCTP"===v))d.transceivers[$]={mid:w,kind:h,protocol:v,rejected:!0};else{var S,y,k,C,_,E,T,I,P;!g&&d.transceivers[$]&&d.transceivers[$].rejected&&(d.transceivers[$]=d._createTransceiver(h,!0));var j,R,D=n.parseRtpParameters(r);g||(j=n.getIceParameters(r,p),(R=n.getDtlsParameters(r,p)).role="client"),T=n.parseRtpEncodingParameters(r);var x=n.parseRtcpParameters(r),M=n.matchPrefix(r,"a=end-of-candidates",p).length>0,L=n.matchPrefix(r,"a=candidate:").map((function(e){return n.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===s.type||"answer"===s.type)&&!g&&f&&$>0&&d.transceivers[$]&&(d._disposeIceAndDtlsTransports($),d.transceivers[$].iceGatherer=d.transceivers[0].iceGatherer,d.transceivers[$].iceTransport=d.transceivers[0].iceTransport,d.transceivers[$].dtlsTransport=d.transceivers[0].dtlsTransport,d.transceivers[$].rtpSender&&d.transceivers[$].rtpSender.setTransport(d.transceivers[0].dtlsTransport),d.transceivers[$].rtpReceiver&&d.transceivers[$].rtpReceiver.setTransport(d.transceivers[0].dtlsTransport)),"offer"!==s.type||g)"answer"!==s.type||g||(y=(S=d.transceivers[$]).iceGatherer,k=S.iceTransport,C=S.dtlsTransport,_=S.rtpReceiver,E=S.sendEncodingParameters,I=S.localCapabilities,d.transceivers[$].recvEncodingParameters=T,d.transceivers[$].remoteCapabilities=D,d.transceivers[$].rtcpParameters=x,L.length&&"new"===k.state&&(!m&&!M||f&&0!==$?L.forEach((function(e){a(S.iceTransport,e)})):k.setRemoteCandidates(L)),f&&0!==$||("new"===k.state&&k.start(y,j,"controlling"),"new"===C.state&&C.start(R)),!o(S.localCapabilities,S.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&S.sendEncodingParameters[0].rtx&&delete S.sendEncodingParameters[0].rtx,d._transceive(S,"sendrecv"===A||"recvonly"===A,"sendrecv"===A||"sendonly"===A),!_||"sendrecv"!==A&&"sendonly"!==A?delete S.rtpReceiver:(P=_.track,b?(l[b.stream]||(l[b.stream]=new e.MediaStream),i(P,l[b.stream]),u.push([P,_,l[b.stream]])):(l.default||(l.default=new e.MediaStream),i(P,l.default),u.push([P,_,l.default]))));else{(S=d.transceivers[$]||d._createTransceiver(h)).mid=w,S.iceGatherer||(S.iceGatherer=d._createIceGatherer($,f)),L.length&&"new"===S.iceTransport.state&&(!M||f&&0!==$?L.forEach((function(e){a(S.iceTransport,e)})):S.iceTransport.setRemoteCandidates(L)),I=e.RTCRtpReceiver.getCapabilities(h),t<15019&&(I.codecs=I.codecs.filter((function(e){return"rtx"!==e.name}))),E=S.sendEncodingParameters||[{ssrc:1001*(2*$+2)}];var O,B=!1;"sendrecv"===A||"sendonly"===A?(B=!S.rtpReceiver,_=S.rtpReceiver||new e.RTCRtpReceiver(S.dtlsTransport,h),B&&(P=_.track,b&&"-"===b.stream||(b?(l[b.stream]||(l[b.stream]=new e.MediaStream,Object.defineProperty(l[b.stream],"id",{get:function(){return b.stream}})),Object.defineProperty(P,"id",{get:function(){return b.track}}),O=l[b.stream]):(l.default||(l.default=new e.MediaStream),O=l.default)),O&&(i(P,O),S.associatedRemoteMediaStreams.push(O)),u.push([P,_,O]))):S.rtpReceiver&&S.rtpReceiver.track&&(S.associatedRemoteMediaStreams.forEach((function(t){var i=t.getTracks().find((function(e){return e.id===S.rtpReceiver.track.id}));i&&function(t,i){i.removeTrack(t),i.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}(i,t)})),S.associatedRemoteMediaStreams=[]),S.localCapabilities=I,S.remoteCapabilities=D,S.rtpReceiver=_,S.rtcpParameters=x,S.sendEncodingParameters=E,S.recvEncodingParameters=T,d._transceive(d.transceivers[$],!1,B)}}})),void 0===d._dtlsRole&&(d._dtlsRole="offer"===s.type?"active":"passive"),d._remoteDescription={type:s.type,sdp:s.sdp},"offer"===s.type?d._updateSignalingState("have-remote-offer"):d._updateSignalingState("stable"),Object.keys(l).forEach((function(t){var i=l[t];if(i.getTracks().length){if(-1===d.remoteStreams.indexOf(i)){d.remoteStreams.push(i);var n=new Event("addstream");n.stream=i,e.setTimeout((function(){d._dispatchEvent("addstream",n)}))}u.forEach((function(e){var t=e[0],n=e[1];i.id===e[2].id&&c(d,t,n,[i])}))}})),u.forEach((function(e){e[2]||c(d,e[0],e[1],[])})),e.setTimeout((function(){d&&d.transceivers&&d.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},d.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},d.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},d.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},d.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var i=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",i)}},d.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var i=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",i)}},d.prototype.createOffer=function(){var i=this;if(i._isClosed)return Promise.reject($("InvalidStateError","Can not call createOffer after close"));var o=i.transceivers.filter((function(e){return"audio"===e.kind})).length,r=i.transceivers.filter((function(e){return"video"===e.kind})).length,a=arguments[0];if(a){if(a.mandatory||a.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==a.offerToReceiveAudio&&(o=!0===a.offerToReceiveAudio?1:!1===a.offerToReceiveAudio?0:a.offerToReceiveAudio),void 0!==a.offerToReceiveVideo&&(r=!0===a.offerToReceiveVideo?1:!1===a.offerToReceiveVideo?0:a.offerToReceiveVideo)}for(i.transceivers.forEach((function(e){"audio"===e.kind?--o<0&&(e.wantReceive=!1):"video"===e.kind&&--r<0&&(e.wantReceive=!1)}));o>0||r>0;)o>0&&(i._createTransceiver("audio"),o--),r>0&&(i._createTransceiver("video"),r--);var c=n.writeSessionBoilerplate(i._sdpSessionId,i._sdpSessionVersion++);i.transceivers.forEach((function(s,o){var r=s.track,a=s.kind,$=s.mid||n.generateIdentifier();s.mid=$,s.iceGatherer||(s.iceGatherer=i._createIceGatherer(o,i.usingBundle));var c=e.RTCRtpSender.getCapabilities(a);t<15019&&(c.codecs=c.codecs.filter((function(e){return"rtx"!==e.name}))),c.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),s.remoteCapabilities&&s.remoteCapabilities.codecs&&s.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),c.headerExtensions.forEach((function(e){(s.remoteCapabilities&&s.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var d=s.sendEncodingParameters||[{ssrc:1001*(2*o+1)}];r&&t>=15019&&"video"===a&&!d[0].rtx&&(d[0].rtx={ssrc:d[0].ssrc+1}),s.wantReceive&&(s.rtpReceiver=new e.RTCRtpReceiver(s.dtlsTransport,a)),s.localCapabilities=c,s.sendEncodingParameters=d})),"max-compat"!==i._config.bundlePolicy&&(c+="a=group:BUNDLE "+i.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),c+="a=ice-options:trickle\r\n",i.transceivers.forEach((function(e,t){c+=s(e,e.localCapabilities,"offer",e.stream,i._dtlsRole),c+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===i.iceGatheringState||0!==t&&i.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,c+="a="+n.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(c+="a=end-of-candidates\r\n"))}));var d=new e.RTCSessionDescription({type:"offer",sdp:c});return Promise.resolve(d)},d.prototype.createAnswer=function(){var i=this;if(i._isClosed)return Promise.reject($("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==i.signalingState&&"have-local-pranswer"!==i.signalingState)return Promise.reject($("InvalidStateError","Can not call createAnswer in signalingState "+i.signalingState));var r=n.writeSessionBoilerplate(i._sdpSessionId,i._sdpSessionVersion++);i.usingBundle&&(r+="a=group:BUNDLE "+i.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),r+="a=ice-options:trickle\r\n";var a=n.getMediaSections(i._remoteDescription.sdp).length;i.transceivers.forEach((function(e,n){if(!(n+1>a)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?r+="m=application 0 DTLS/SCTP 5000\r\n":r+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?r+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(r+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(r+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var $;e.stream&&("audio"===e.kind?$=e.stream.getAudioTracks()[0]:"video"===e.kind&&($=e.stream.getVideoTracks()[0]),$&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var c=o(e.localCapabilities,e.remoteCapabilities);!c.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,r+=s(e,c,"answer",e.stream,i._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(r+="a=rtcp-rsize\r\n")}}));var c=new e.RTCSessionDescription({type:"answer",sdp:r});return Promise.resolve(c)},d.prototype.addIceCandidate=function(e){var t,i=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(s,o){if(!i._remoteDescription)return o($("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var r=e.sdpMLineIndex;if(e.sdpMid)for(var c=0;c<i.transceivers.length;c++)if(i.transceivers[c].mid===e.sdpMid){r=c;break}var d=i.transceivers[r];if(!d)return o($("OperationError","Can not add ICE candidate"));if(d.rejected)return s();var l=Object.keys(e.candidate).length>0?n.parseCandidate(e.candidate):{};if("tcp"===l.protocol&&(0===l.port||9===l.port))return s();if(l.component&&1!==l.component)return s();if((0===r||r>0&&d.iceTransport!==i.transceivers[0].iceTransport)&&!a(d.iceTransport,l))return o($("OperationError","Can not add ICE candidate"));var u=e.candidate.trim();0===u.indexOf("a=")&&(u=u.substr(2)),(t=n.getMediaSections(i._remoteDescription.sdp))[r]+="a="+(l.type?u:"end-of-candidates")+"\r\n",i._remoteDescription.sdp=n.getDescription(i._remoteDescription.sdp)+t.join("")}else for(var h=0;h<i.transceivers.length&&(i.transceivers[h].rejected||(i.transceivers[h].iceTransport.addRemoteCandidate({}),(t=n.getMediaSections(i._remoteDescription.sdp))[h]+="a=end-of-candidates\r\n",i._remoteDescription.sdp=n.getDescription(i._remoteDescription.sdp)+t.join(""),!i.usingBundle));h++);s()}))},d.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var i=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?i=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(i=e.rtpReceiver)})),!i)throw $("InvalidAccessError","Invalid selector.");return i.getStats()}var n=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&n.push(e[t].getStats())}))})),Promise.all(n).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var i=e[t];if(i&&i.prototype&&i.prototype.getStats){var n=i.prototype.getStats;i.prototype.getStats=function(){return n.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(i){var n;e[i].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(n=e[i]).type]||n.type,t.set(i,e[i])})),t}))}}}));var l=["createOffer","createAnswer"];return l.forEach((function(e){var t=d.prototype[e];d.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(l=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=d.prototype[e];d.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=d.prototype[e];d.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),d}},985:e=>{"use strict";var t={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},t.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},t.getDescription=function(e){var i=t.splitSections(e);return i&&i[0]},t.getMediaSections=function(e){var i=t.splitSections(e);return i.shift(),i},t.matchPrefix=function(e,i){return t.splitLines(e).filter((function(e){return 0===e.indexOf(i)}))},t.parseCandidate=function(e){for(var t,i={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},n=8;n<t.length;n+=2)switch(t[n]){case"raddr":i.relatedAddress=t[n+1];break;case"rport":i.relatedPort=parseInt(t[n+1],10);break;case"tcptype":i.tcpType=t[n+1];break;case"ufrag":i.ufrag=t[n+1],i.usernameFragment=t[n+1];break;default:i[t[n]]=t[n+1]}return i},t.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var i=e.type;return t.push("typ"),t.push(i),"host"!==i&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substr(14).split(" ")},t.parseRtpMap=function(e){var t=e.substr(9).split(" "),i={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),i.name=t[0],i.clockRate=parseInt(t[1],10),i.channels=3===t.length?parseInt(t[2],10):1,i.numChannels=i.channels,i},t.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var i=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==i?"/"+i:"")+"\r\n"},t.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},t.parseFmtp=function(e){for(var t,i={},n=e.substr(e.indexOf(" ")+1).split(";"),s=0;s<n.length;s++)i[(t=n[s].trim().split("="))[0].trim()]=t[1];return i},t.writeFmtp=function(e){var t="",i=e.payloadType;if(void 0!==e.preferredPayloadType&&(i=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var n=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?n.push(t+"="+e.parameters[t]):n.push(t)})),t+="a=fmtp:"+i+" "+n.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){var t="",i=e.payloadType;return void 0!==e.preferredPayloadType&&(i=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+i+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){var t=e.indexOf(" "),i={ssrc:parseInt(e.substr(7,t-7),10)},n=e.indexOf(":",t);return n>-1?(i.attribute=e.substr(t+1,n-t-1),i.value=e.substr(n+1)):i.attribute=e.substr(t+1),i},t.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},t.getMid=function(e){var i=t.matchPrefix(e,"a=mid:")[0];if(i)return i.substr(6)},t.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},t.getDtlsParameters=function(e,i){return{role:"auto",fingerprints:t.matchPrefix(e+i,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){var i="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){i+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),i},t.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,i){return t.matchPrefix(e+i,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,i){var n=t.matchPrefix(e+i,"a=ice-ufrag:")[0],s=t.matchPrefix(e+i,"a=ice-pwd:")[0];return n&&s?{usernameFragment:n.substr(12),password:s.substr(10)}:null},t.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},t.parseRtpParameters=function(e){for(var i={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=t.splitLines(e)[0].split(" "),s=3;s<n.length;s++){var o=n[s],r=t.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(r){var a=t.parseRtpMap(r),$=t.matchPrefix(e,"a=fmtp:"+o+" ");switch(a.parameters=$.length?t.parseFmtp($[0]):{},a.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(t.parseRtcpFb),i.codecs.push(a),a.name.toUpperCase()){case"RED":case"ULPFEC":i.fecMechanisms.push(a.name.toUpperCase())}}}return t.matchPrefix(e,"a=extmap:").forEach((function(e){i.headerExtensions.push(t.parseExtmap(e))})),i},t.writeRtpDescription=function(e,i){var n="";n+="m="+e+" ",n+=i.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=i.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",i.codecs.forEach((function(e){n+=t.writeRtpMap(e),n+=t.writeFmtp(e),n+=t.writeRtcpFb(e)}));var s=0;return i.codecs.forEach((function(e){e.maxptime>s&&(s=e.maxptime)})),s>0&&(n+="a=maxptime:"+s+"\r\n"),n+="a=rtcp-mux\r\n",i.headerExtensions&&i.headerExtensions.forEach((function(e){n+=t.writeExtmap(e)})),n},t.parseRtpEncodingParameters=function(e){var i,n=[],s=t.parseRtpParameters(e),o=-1!==s.fecMechanisms.indexOf("RED"),r=-1!==s.fecMechanisms.indexOf("ULPFEC"),a=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),$=a.length>0&&a[0].ssrc,c=t.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));c.length>0&&c[0].length>1&&c[0][0]===$&&(i=c[0][1]),s.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var t={ssrc:$,codecPayloadType:parseInt(e.parameters.apt,10)};$&&i&&(t.rtx={ssrc:i}),n.push(t),o&&((t=JSON.parse(JSON.stringify(t))).fec={ssrc:$,mechanism:r?"red+ulpfec":"red"},n.push(t))}})),0===n.length&&$&&n.push({ssrc:$});var d=t.matchPrefix(e,"b=");return d.length&&(d=0===d[0].indexOf("b=TIAS:")?parseInt(d[0].substr(7),10):0===d[0].indexOf("b=AS:")?1e3*parseInt(d[0].substr(5),10)*.95-16e3:void 0,n.forEach((function(e){e.maxBitrate=d}))),n},t.parseRtcpParameters=function(e){var i={},n=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];n&&(i.cname=n.value,i.ssrc=n.ssrc);var s=t.matchPrefix(e,"a=rtcp-rsize");i.reducedSize=s.length>0,i.compound=0===s.length;var o=t.matchPrefix(e,"a=rtcp-mux");return i.mux=o.length>0,i},t.parseMsid=function(e){var i,n=t.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(i=n[0].substr(7).split(" "))[0],track:i[1]};var s=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return s.length>0?{stream:(i=s[0].value.split(" "))[0],track:i[1]}:void 0},t.parseSctpDescription=function(e){var i,n=t.parseMLine(e),s=t.matchPrefix(e,"a=max-message-size:");s.length>0&&(i=parseInt(s[0].substr(19),10)),isNaN(i)&&(i=65536);var o=t.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substr(12),10),protocol:n.fmt,maxMessageSize:i};if(t.matchPrefix(e,"a=sctpmap:").length>0){var r=t.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(r[0],10),protocol:r[1],maxMessageSize:i}}},t.writeSctpDescription=function(e,t){var i=[];return i="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&i.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),i.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,21)},t.writeSessionBoilerplate=function(e,i,n){var s=void 0!==i?i:2;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(e||t.generateSessionId())+" "+s+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.writeMediaSection=function(e,i,n,s){var o=t.writeRtpDescription(e.kind,i);if(o+=t.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=t.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",e.direction?o+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var r="msid:"+s.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+r,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+r,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+r,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+t.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+t.localCName+"\r\n"),o},t.getDirection=function(e,i){for(var n=t.splitLines(e),s=0;s<n.length;s++)switch(n[s]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[s].substr(2)}return i?t.getDirection(i):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substr(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){var i=t.splitLines(e)[0].substr(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},t.parseOLine=function(e){var i=t.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var i=t.splitLines(e),n=0;n<i.length;n++)if(i[n].length<2||"="!==i[n].charAt(1))return!1;return!0},e.exports=t},754:e=>{"use strict";e.exports=i(142)}},n={};function s(e){var i=n[e];if(void 0!==i)return i.exports;var o=n[e]={exports:{}};return t[e](o,o.exports,s),o.exports}s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};(()=>{"use strict";s.r(o),s.d(o,{AddPlatformTelemetry:()=>Ke,CHANGELIST:()=>Ue,CLIENT_IDENTIFICATION:()=>He,CLIENT_VERSION:()=>Ge,CalculateDataUsage:()=>ge,CalculateMaxBitrateKbps:()=>fe,ChooseStreamingResolution:()=>me,ChooseStreamingSettings:()=>pe,ConfigureGridServerSettings:()=>Ee,ConfigureRagnarokSettings:()=>ye,GS_ClientMetricEventDef:()=>Me,GS_CodecError_EventDef:()=>Fe,GS_ConnectivityCheckDef:()=>Le,GS_DebugInfoDef:()=>De,GS_ExceptionInfoDef:()=>xe,GS_FeatureDef:()=>je,GS_HttpCallResultDef:()=>Be,GS_PropertyChange_EventDef:()=>Ne,GS_Sleep_EventDef:()=>Oe,GS_SystemAPICallResultDef:()=>Re,GetDeviceCapabilities:()=>we,GetSupportedAudioChannelCount:()=>be,GridApp:()=>ue,GridServer:()=>Ce,GridServerSettings:()=>Te,GridServer_GameLaunch_RequestDef:()=>Pe,GsTelemetryHandler:()=>Ve,InitializeUtils:()=>ve,IsFeatureSupported:()=>Ae,LogImpl:()=>Je,PassThruServer:()=>_e,RagnarokSettings:()=>ke,TelemetryEventBase:()=>Ie,VirtualGamepadHandler:()=>Se,defaultInputConfigFlags:()=>he,getPlatformDetails:()=>ze,performHttpRequest:()=>We,translatePlatformDetailsForClientHeader:()=>Ye,translatePlatformDetailsForPayload:()=>qe});var e={};s.r(e),s.d(e,{fixNegotiationNeeded:()=>j,shimAddTrackRemoveTrack:()=>I,shimAddTrackRemoveTrackWithNative:()=>T,shimGetDisplayMedia:()=>S,shimGetSendersWithDtmf:()=>C,shimGetStats:()=>_,shimGetUserMedia:()=>w,shimMediaStream:()=>y,shimOnTrack:()=>k,shimPeerConnection:()=>P,shimSenderReceiverGetStats:()=>E});var t={};s.r(t),s.d(t,{shimGetDisplayMedia:()=>M,shimGetUserMedia:()=>x,shimPeerConnection:()=>L,shimReplaceTrack:()=>O});var i={};s.r(i),s.d(i,{shimAddTransceiver:()=>W,shimCreateAnswer:()=>q,shimCreateOffer:()=>J,shimGetDisplayMedia:()=>N,shimGetParameters:()=>K,shimGetUserMedia:()=>B,shimOnTrack:()=>F,shimPeerConnection:()=>V,shimRTCDataChannel:()=>z,shimReceiverGetStats:()=>G,shimRemoveStream:()=>H,shimSenderGetStats:()=>U});var n={};s.r(n),s.d(n,{shimAudioContext:()=>se,shimCallbacksAPI:()=>Q,shimConstraints:()=>ee,shimCreateOfferLegacy:()=>ne,shimGetUserMedia:()=>Z,shimLocalStreamsAPI:()=>Y,shimRTCIceServerUrls:()=>te,shimRemoteStreamsAPI:()=>X,shimTrackEventTransceiver:()=>ie});var r={};s.r(r),s.d(r,{removeAllowExtmapMixed:()=>le,shimConnectionState:()=>de,shimMaxMessageSize:()=>$e,shimRTCIceCandidate:()=>ae,shimSendThrowTypeError:()=>ce});let a=!0,$=!0;function c(e,t,i){const n=e.match(t);return n&&n.length>=i&&parseInt(n[i],10)}function d(e,t,i){if(!e.RTCPeerConnection)return;const n=e.RTCPeerConnection.prototype,s=n.addEventListener;n.addEventListener=function(e,n){if(e!==t)return s.apply(this,arguments);const o=e=>{const t=i(e);t&&(n.handleEvent?n.handleEvent(t):n(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(n,o),s.apply(this,[e,o])};const o=n.removeEventListener;n.removeEventListener=function(e,i){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(i))return o.apply(this,arguments);const n=this._eventMap[t].get(i);return this._eventMap[t].delete(i),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,n])},Object.defineProperty(n,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function l(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(a=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function u(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):($=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function h(){if("object"==typeof window){if(a)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function p(e,t){$&&console.warn(e+" is deprecated, please use "+t+" instead.")}function m(e){const{navigator:t}=e,i={browser:null,version:null};if(void 0===e||!e.navigator)return i.browser="Not a browser.",i;if(t.mozGetUserMedia)i.browser="firefox",i.version=c(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)i.browser="chrome",i.version=c(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))i.browser="edge",i.version=c(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return i.browser="Not a supported browser.",i;i.browser="safari",i.version=c(t.userAgent,/AppleWebKit\/(\d+)\./,1),i.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return i}function f(e){return"[object Object]"===Object.prototype.toString.call(e)}function g(e){return f(e)?Object.keys(e).reduce((function(t,i){const n=f(e[i]),s=n?g(e[i]):e[i],o=n&&!Object.keys(s).length;return void 0===s||o?t:Object.assign(t,{[i]:s})}),{}):e}function v(e,t,i){t&&!i.has(t.id)&&(i.set(t.id,t),Object.keys(t).forEach((n=>{n.endsWith("Id")?v(e,e.get(t[n]),i):n.endsWith("Ids")&&t[n].forEach((t=>{v(e,e.get(t),i)}))})))}function A(e,t,i){const n=i?"outbound-rtp":"inbound-rtp",s=new Map;if(null===t)return s;const o=[];return e.forEach((e=>{"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((t=>{e.forEach((i=>{i.type===n&&i.trackId===t.id&&v(e,i,s)}))})),s}const b=h;function w(e){const t=e&&e.navigator;if(!t.mediaDevices)return;const i=m(e),n=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach((i=>{if("require"===i||"advanced"===i||"mediaSource"===i)return;const n="object"==typeof e[i]?e[i]:{ideal:e[i]};void 0!==n.exact&&"number"==typeof n.exact&&(n.min=n.max=n.exact);const s=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==n.ideal){t.optional=t.optional||[];let e={};"number"==typeof n.ideal?(e[s("min",i)]=n.ideal,t.optional.push(e),e={},e[s("max",i)]=n.ideal,t.optional.push(e)):(e[s("",i)]=n.ideal,t.optional.push(e))}void 0!==n.exact&&"number"!=typeof n.exact?(t.mandatory=t.mandatory||{},t.mandatory[s("",i)]=n.exact):["min","max"].forEach((e=>{void 0!==n[e]&&(t.mandatory=t.mandatory||{},t.mandatory[s(e,i)]=n[e])}))})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},s=function(e,s){if(i.version>=61)return s(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){const t=function(e,t,i){t in e&&!(i in e)&&(e[i]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=n(e.audio)}if(e&&"object"==typeof e.video){let o=e.video.facingMode;o=o&&("object"==typeof o?o:{ideal:o});const r=i.version<66;if(o&&("user"===o.exact||"environment"===o.exact||"user"===o.ideal||"environment"===o.ideal)&&(!t.mediaDevices.getSupportedConstraints||!t.mediaDevices.getSupportedConstraints().facingMode||r)){let i;if(delete e.video.facingMode,"environment"===o.exact||"environment"===o.ideal?i=["back","rear"]:"user"!==o.exact&&"user"!==o.ideal||(i=["front"]),i)return t.mediaDevices.enumerateDevices().then((t=>{let r=(t=t.filter((e=>"videoinput"===e.kind))).find((e=>i.some((t=>e.label.toLowerCase().includes(t)))));return!r&&t.length&&i.includes("back")&&(r=t[t.length-1]),r&&(e.video.deviceId=o.exact?{exact:r.deviceId}:{ideal:r.deviceId}),e.video=n(e.video),b("chrome: "+JSON.stringify(e)),s(e)}))}e.video=n(e.video)}return b("chrome: "+JSON.stringify(e)),s(e)},o=function(e){return i.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(t.getUserMedia=function(e,i,n){s(e,(e=>{t.webkitGetUserMedia(e,i,(e=>{n&&n(o(e))}))}))}.bind(t),t.mediaDevices.getUserMedia){const e=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(t){return s(t,(t=>e(t).then((e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach((e=>{e.stop()})),new DOMException("","NotFoundError");return e}),(e=>Promise.reject(o(e))))))}}}function S(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(i){return t(i).then((t=>{const n=i.video&&i.video.width,s=i.video&&i.video.height,o=i.video&&i.video.frameRate;return i.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},n&&(i.video.mandatory.maxWidth=n),s&&(i.video.mandatory.maxHeight=s),e.navigator.mediaDevices.getUserMedia(i)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}function y(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function k(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",(i=>{let n;n=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===i.track.id)):{track:i.track};const s=new Event("track");s.track=i.track,s.receiver=n,s.transceiver={receiver:n},s.streams=[t.stream],this.dispatchEvent(s)})),t.stream.getTracks().forEach((i=>{let n;n=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===i.id)):{track:i};const s=new Event("track");s.track=i,s.receiver=n,s.transceiver={receiver:n},s.streams=[t.stream],this.dispatchEvent(s)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else d(e,"track",(e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e)))}function C(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){let s=i.apply(this,arguments);return s||(s=t(this,e),this._senders.push(s)),s};const n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){n.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((e=>{this._senders.push(t(this,e))}))};const n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach((e=>{const t=this._senders.find((t=>t.track===e));t&&this._senders.splice(this._senders.indexOf(t),1)}))}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function _(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,i,n]=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof e))return t.apply(this,[]);const s=function(e){const t={};return e.result().forEach((e=>{const i={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((t=>{i[t]=e.stat(t)})),t[i.id]=i})),t},o=function(e){return new Map(Object.keys(e).map((t=>[t,e[t]])))};if(arguments.length>=2){const n=function(e){i(o(s(e)))};return t.apply(this,[n,e])}return new Promise(((e,i)=>{t.apply(this,[function(t){e(o(s(t)))},i])})).then(i,n)}}function E(e){if(!("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const i=e.RTCPeerConnection.prototype.addTrack;i&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=i.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>A(t,e.track,!0)))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),d(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>A(t,e.track,!1)))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,i,n;return this.getSenders().forEach((i=>{i.track===e&&(t?n=!0:t=i)})),this.getReceivers().forEach((t=>(t.track===e&&(i?n=!0:i=t),t.track===e))),n||t&&i?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():i?i.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function T(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((e=>this._shimmedLocalStreams[e][0]))};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,i){if(!i)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const n=t.apply(this,arguments);return this._shimmedLocalStreams[i.id]?-1===this._shimmedLocalStreams[i.id].indexOf(n)&&this._shimmedLocalStreams[i.id].push(n):this._shimmedLocalStreams[i.id]=[i,n],n};const i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")}));const t=this.getSenders();i.apply(this,arguments);const n=this.getSenders().filter((e=>-1===t.indexOf(e)));this._shimmedLocalStreams[e.id]=[e].concat(n)};const n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],n.apply(this,arguments)};const s=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((t=>{const i=this._shimmedLocalStreams[t].indexOf(e);-1!==i&&this._shimmedLocalStreams[t].splice(i,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]})),s.apply(this,arguments)}}function I(e){if(!e.RTCPeerConnection)return;const t=m(e);if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return T(e);const i=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=i.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map((e=>this._reverseStreams[e.id]))};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){const i=new e.MediaStream(t.getTracks());this._streams[t.id]=i,this._reverseStreams[i.id]=t,t=i}n.apply(this,[t])};const s=e.RTCPeerConnection.prototype.removeStream;function o(e,t){let i=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const n=e._reverseStreams[t],s=e._streams[n.id];i=i.replace(new RegExp(s.id,"g"),n.id)})),new RTCSessionDescription({type:t.type,sdp:i})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},s.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,i){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const n=[].slice.call(arguments,1);if(1!==n.length||!n[0].getTracks().find((e=>e===t)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((e=>e.track===t)))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const s=this._streams[i.id];if(s)s.addTrack(t),Promise.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{const n=new e.MediaStream([t]);this._streams[i.id]=n,this._reverseStreams[n.id]=i,this.addStream(n)}return this.getSenders().find((e=>e.track===t))},["createOffer","createAnswer"].forEach((function(t){const i=e.RTCPeerConnection.prototype[t],n={[t](){const e=arguments;return arguments.length&&"function"==typeof arguments[0]?i.apply(this,[t=>{const i=o(this,t);e[0].apply(null,[i])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):i.apply(this,arguments).then((e=>o(this,e)))}};e.RTCPeerConnection.prototype[t]=n[t]}));const r=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){let i=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const n=e._reverseStreams[t],s=e._streams[n.id];i=i.replace(new RegExp(n.id,"g"),s.id)})),new RTCSessionDescription({type:t.type,sdp:i})}(this,arguments[0]),r.apply(this,arguments)):r.apply(this,arguments)};const a=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=a.get.apply(this);return""===e.type?e:o(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach((i=>{this._streams[i].getTracks().find((t=>e.track===t))&&(t=this._streams[i])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function P(e){const t=m(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),!e.RTCPeerConnection)return;const i=0===e.RTCPeerConnection.prototype.addIceCandidate.length;t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const i=e.RTCPeerConnection.prototype[t],n={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=n[t]}));const n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return i||arguments[0]?t.version<78&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}function j(e){const t=m(e);d(e,"negotiationneeded",(e=>{const i=e.target;if(!(t.version<72||i.getConfiguration&&"plan-b"===i.getConfiguration().sdpSemantics)||"stable"===i.signalingState)return e}))}var R=s(134),D=s.n(R);function x(e){const t=e&&e.navigator,i=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return i(e).catch((e=>Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString(){return this.name}}}(e))))}}function M(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}function L(e){const t=m(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){const t=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set(e){t.set.call(this,e);const i=new Event("enabled");i.enabled=e,this.dispatchEvent(i)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);const i=D()(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=function(e,t){let i=!1;return(e=JSON.parse(JSON.stringify(e))).filter((e=>{if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&p("RTCIceServer.url","RTCIceServer.urls");const n="string"==typeof t;return n&&(t=[t]),t=t.filter((e=>{if(0===e.indexOf("stun:"))return!1;const t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!i?(i=!0,!0):t&&!i})),delete e.url,e.urls=n?t[0]:t,!!t.length}}))}(e.iceServers,t.version),h("ICE servers after filtering:",e.iceServers)),new i(e)},e.RTCPeerConnection.prototype=i.prototype}function O(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}function B(e){const t=m(e),i=e&&e.navigator,n=e&&e.MediaStreamTrack;if(i.getUserMedia=function(e,t,n){p("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),i.mediaDevices.getUserMedia(e).then(t,n)},!(t.version>55&&"autoGainControl"in i.mediaDevices.getSupportedConstraints())){const e=function(e,t,i){t in e&&!(i in e)&&(e[i]=e[t],delete e[t])},t=i.mediaDevices.getUserMedia.bind(i.mediaDevices);if(i.mediaDevices.getUserMedia=function(i){return"object"==typeof i&&"object"==typeof i.audio&&(i=JSON.parse(JSON.stringify(i)),e(i.audio,"autoGainControl","mozAutoGainControl"),e(i.audio,"noiseSuppression","mozNoiseSuppression")),t(i)},n&&n.prototype.getSettings){const t=n.prototype.getSettings;n.prototype.getSettings=function(){const i=t.apply(this,arguments);return e(i,"mozAutoGainControl","autoGainControl"),e(i,"mozNoiseSuppression","noiseSuppression"),i}}if(n&&n.prototype.applyConstraints){const t=n.prototype.applyConstraints;n.prototype.applyConstraints=function(i){return"audio"===this.kind&&"object"==typeof i&&(i=JSON.parse(JSON.stringify(i)),e(i,"autoGainControl","mozAutoGainControl"),e(i,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[i])}}}}function N(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(i){if(!i||!i.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===i.video?i.video={mediaSource:t}:i.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(i)})}function F(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function V(e){const t=m(e);if("object"!=typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;if(!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const i=e.RTCPeerConnection.prototype[t],n={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=n[t]})),t.version<68){const t=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():t.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}const i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},n=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,s,o]=arguments;return n.apply(this,[e||null]).then((e=>{if(t.version<53&&!s)try{e.forEach((e=>{e.type=i[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach(((t,n)=>{e.set(n,Object.assign({},t,{type:i[t.type]||t.type}))}))}return e})).then(s,o)}}function U(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const i=e.RTCPeerConnection.prototype.addTrack;i&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=i.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function G(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),d(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function H(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){p("removeStream","removeTrack"),this.getSenders().forEach((t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)}))})}function z(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function W(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];const e=arguments[1],i=e&&"sendEncodings"in e;i&&e.sendEncodings.forEach((e=>{if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));const n=t.apply(this,arguments);if(i){const{sender:t}=n,i=t.getParameters();"encodings"in i||(i.encodings=e.sendEncodings,t.sendEncodings=e.sendEncodings,this.setParametersPromises.push(t.setParameters(i).then((()=>{delete t.sendEncodings})).catch((()=>{delete t.sendEncodings}))))}return n})}function K(e){if("object"!=typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){var e=t.apply(this,arguments);return"sendEncodings"in this?Object.assign({},{encodings:this.sendEncodings},e):e})}function J(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function q(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function Y(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((i=>t.call(this,i,e))),e.getVideoTracks().forEach((i=>t.call(this,i,e)))},e.RTCPeerConnection.prototype.addTrack=function(e,...i){return i&&i.forEach((e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const i=e.getTracks();this.getSenders().forEach((e=>{i.includes(e.track)&&this.removeTrack(e)}))})}}function X(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach((e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)}))})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const i=new Event("addstream");i.stream=t,e.dispatchEvent(i)}))}),t.apply(e,arguments)}}}function Q(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,i=t.createOffer,n=t.createAnswer,s=t.setLocalDescription,o=t.setRemoteDescription,r=t.addIceCandidate;t.createOffer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],s=i.apply(this,[n]);return t?(s.then(e,t),Promise.resolve()):s},t.createAnswer=function(e,t){const i=arguments.length>=2?arguments[2]:arguments[0],s=n.apply(this,[i]);return t?(s.then(e,t),Promise.resolve()):s};let a=function(e,t,i){const n=s.apply(this,[e]);return i?(n.then(t,i),Promise.resolve()):n};t.setLocalDescription=a,a=function(e,t,i){const n=o.apply(this,[e]);return i?(n.then(t,i),Promise.resolve()):n},t.setRemoteDescription=a,a=function(e,t,i){const n=r.apply(this,[e]);return i?(n.then(t,i),Promise.resolve()):n},t.addIceCandidate=a}function Z(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,i=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>i(ee(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,i,n){t.mediaDevices.getUserMedia(e).then(i,n)}.bind(t))}function ee(e){return e&&void 0!==e.video?Object.assign({},e,{video:g(e.video)}):e}function te(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,i){if(e&&e.iceServers){const t=[];for(let i=0;i<e.iceServers.length;i++){let n=e.iceServers[i];!n.hasOwnProperty("urls")&&n.hasOwnProperty("url")?(p("RTCIceServer.url","RTCIceServer.urls"),n=JSON.parse(JSON.stringify(n)),n.urls=n.url,delete n.url,t.push(n)):t.push(e.iceServers[i])}e.iceServers=t}return new t(e,i)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function ie(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function ne(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find((e=>"audio"===e.receiver.track.kind));!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const i=this.getTransceivers().find((e=>"video"===e.receiver.track.kind));!1===e.offerToReceiveVideo&&i?"sendrecv"===i.direction?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":"recvonly"===i.direction&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):!0!==e.offerToReceiveVideo||i||this.addTransceiver("video")}return t.apply(this,arguments)}}function se(e){"object"!=typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var oe=s(985),re=s.n(oe);function ae(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){const i=new t(e),n=re().parseCandidate(e.candidate),s=Object.assign(i,n);return s.toJSON=function(){return{candidate:s.candidate,sdpMid:s.sdpMid,sdpMLineIndex:s.sdpMLineIndex,usernameFragment:s.usernameFragment}},s}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,d(e,"icecandidate",(t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t)))}function $e(e){if(!e.RTCPeerConnection)return;const t=m(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const i=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;const t=re().splitSections(e.sdp);return t.shift(),t.some((e=>{const t=re().parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))}(arguments[0])){const e=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const i=parseInt(t[1],10);return i!=i?-1:i}(arguments[0]),i=function(e){let i=65536;return"firefox"===t.browser&&(i=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),i}(e),n=function(e,i){let n=65536;"firefox"===t.browser&&57===t.version&&(n=65535);const s=re().matchPrefix(e.sdp,"a=max-message-size:");return s.length>0?n=parseInt(s[0].substr(19),10):"firefox"===t.browser&&-1!==i&&(n=2147483637),n}(arguments[0],e);let s;s=0===i&&0===n?Number.POSITIVE_INFINITY:0===i||0===n?Math.max(i,n):Math.min(i,n);const o={};Object.defineProperty(o,"maxMessageSize",{get:()=>s}),this._sctp=o}return i.apply(this,arguments)}}function ce(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const i=e.send;e.send=function(){const n=arguments[0],s=n.length||n.size||n.byteLength;if("open"===e.readyState&&t.sctp&&s>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return i.apply(e,arguments)}}const i=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=i.apply(this,arguments);return t(e,this),e},d(e,"datachannel",(e=>(t(e.channel,e.target),e)))}function de(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((e=>{const i=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const i=new Event("connectionstatechange",e);t.dispatchEvent(i)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),i.apply(this,arguments)}}))}function le(e){if(!e.RTCPeerConnection)return;const t=m(e);if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t.version>=605)return;const i=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter((e=>"a=extmap-allow-mixed"!==e.trim())).join("\n")),i.apply(this,arguments)}}!function({window:s}={},o={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0}){const a=h,$=m(s),d={browserDetails:$,commonShim:r,extractVersion:c,disableLog:l,disableWarnings:u};switch($.browser){case"chrome":if(!e||!P||!o.shimChrome)return a("Chrome shim is not included in this adapter release."),d;if(null===$.version)return a("Chrome shim can not determine version, not shimming."),d;a("adapter.js shimming chrome."),d.browserShim=e,w(s),y(s),P(s),k(s),I(s),C(s),_(s),E(s),j(s),ae(s),de(s),$e(s),ce(s),le(s);break;case"firefox":if(!i||!V||!o.shimFirefox)return a("Firefox shim is not included in this adapter release."),d;a("adapter.js shimming firefox."),d.browserShim=i,B(s),V(s),F(s),H(s),U(s),G(s),z(s),W(s),K(s),J(s),q(s),ae(s),de(s),$e(s),ce(s);break;case"edge":if(!t||!L||!o.shimEdge)return a("MS edge shim is not included in this adapter release."),d;a("adapter.js shimming edge."),d.browserShim=t,x(s),M(s),L(s),O(s),$e(s),ce(s);break;case"safari":if(!n||!o.shimSafari)return a("Safari shim is not included in this adapter release."),d;a("adapter.js shimming safari."),d.browserShim=n,te(s),ne(s),Q(s),Y(s),X(s),ie(s),Z(s),se(s),ae(s),$e(s),ce(s),le(s);break;default:a("Unsupported browser!")}}({window:window}),s(393);var ue=Ragnarok.GridApp,he=Ragnarok.defaultInputConfigFlags,pe=Ragnarok.ChooseStreamingSettings,me=Ragnarok.ChooseStreamingResolution,fe=Ragnarok.CalculateMaxBitrateKbps,ge=Ragnarok.CalculateDataUsage,ve=Ragnarok.InitializeUtils,Ae=Ragnarok.IsFeatureSupported,be=Ragnarok.GetSupportedAudioChannelCount,we=Ragnarok.GetDeviceCapabilities,Se=Ragnarok.VirtualGamepadHandler,ye=Ragnarok.ConfigureRagnarokSettings,ke=Ragnarok.RagnarokSettings,Ce=Ragnarok.GridServer,_e=Ragnarok.PassThruServer,Ee=Ragnarok.ConfigureGridServerSettings,Te=Ragnarok.GridServerSettings,Ie=Ragnarok.TelemetryEventBase,Pe=Ragnarok.GridServer_GameLaunch_RequestDef,je=Ragnarok.GS_FeatureDef,Re=Ragnarok.GS_SystemAPICallResultDef,De=Ragnarok.GS_DebugInfoDef,xe=Ragnarok.GS_ExceptionInfoDef,Me=Ragnarok.GS_ClientMetricEventDef,Le=Ragnarok.GS_ConnectivityCheckDef,Oe=Ragnarok.GS_Sleep_EventDef,Be=Ragnarok.GS_HttpCallResultDef,Ne=Ragnarok.GS_PropertyChange_EventDef,Fe=Ragnarok.GS_CodecError_EventDef,Ve=Ragnarok.GsTelemetryHandler,Ue=Ragnarok.CHANGELIST,Ge=Ragnarok.CLIENT_VERSION,He=Ragnarok.CLIENT_IDENTIFICATION,ze=Ragnarok.getPlatformDetails,We=Ragnarok.performHttpRequest,Ke=Ragnarok.AddPlatformTelemetry,Je=Ragnarok.LogImpl,qe=Ragnarok.translatePlatformDetailsForPayload,Ye=Ragnarok.translatePlatformDetailsForClientHeader})(),e.exports=o})()},142:(e,t,i)=>{"use strict";i.r(t),i.d(t,{DiagConsoleLogger:()=>E,DiagLogLevel:()=>h,INVALID_SPANID:()=>Z,INVALID_SPAN_CONTEXT:()=>te,INVALID_TRACEID:()=>ee,ProxyTracer:()=>Se,ProxyTracerProvider:()=>ke,ROOT_CONTEXT:()=>C,SamplingDecision:()=>fe,SpanKind:()=>ge,SpanStatusCode:()=>ve,TraceFlags:()=>W,ValueType:()=>k,baggageEntryMetadataFromString:()=>w,context:()=>je,createContextKey:()=>S,createNoopMeter:()=>z,createTraceState:()=>Pe,default:()=>Je,defaultTextMapGetter:()=>K,defaultTextMapSetter:()=>J,diag:()=>Re,isSpanContextValid:()=>pe,isValidSpanId:()=>he,isValidTraceId:()=>ue,metrics:()=>Me,propagation:()=>ze,trace:()=>Ke});var n="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof i.g?i.g:{},s="1.8.0",o=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/,r=function(e){var t=new Set([e]),i=new Set,n=e.match(o);if(!n)return function(){return!1};var s=+n[1],r=+n[2],a=+n[3];if(null!=n[4])return function(t){return t===e};function $(e){return i.add(e),!1}function c(e){return t.add(e),!0}return function(e){if(t.has(e))return!0;if(i.has(e))return!1;var n=e.match(o);if(!n)return $(e);var d=+n[1],l=+n[2],u=+n[3];return null!=n[4]||s!==d?$(e):0===s?r===l&&a<=u?c(e):$(e):r<=l?c(e):$(e)}}(s),a=s.split(".")[0],$=Symbol.for("opentelemetry.js.api."+a),c=n;function d(e,t,i,n){var o;void 0===n&&(n=!1);var r=c[$]=null!==(o=c[$])&&void 0!==o?o:{version:s};if(!n&&r[e]){var a=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return i.error(a.stack||a.message),!1}return r.version!==s?(a=new Error("@opentelemetry/api: Registration of version v"+r.version+" for "+e+" does not match previously registered API v"+s),i.error(a.stack||a.message),!1):(r[e]=t,i.debug("@opentelemetry/api: Registered a global for "+e+" v"+s+"."),!0)}function l(e){var t,i,n=null===(t=c[$])||void 0===t?void 0:t.version;if(n&&r(n))return null===(i=c[$])||void 0===i?void 0:i[e]}function u(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+s+".");var i=c[$];i&&delete i[e]}var h,p=function(){function e(e){this._namespace=e.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return m("debug",this._namespace,e)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return m("error",this._namespace,e)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return m("info",this._namespace,e)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return m("warn",this._namespace,e)},e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return m("verbose",this._namespace,e)},e}();function m(e,t,i){var n=l("diag");if(n)return i.unshift(t),n[e].apply(n,function(e,t,i){if(i||2===arguments.length)for(var n,s=0,o=t.length;s<o;s++)!n&&s in t||(n||(n=Array.prototype.slice.call(t,0,s)),n[s]=t[s]);return e.concat(n||Array.prototype.slice.call(t))}([],function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,s,o=i.call(e),r=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)r.push(n.value)}catch(e){s={error:e}}finally{try{n&&!n.done&&(i=o.return)&&i.call(o)}finally{if(s)throw s.error}}return r}(i),!1))}!function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"}(h||(h={}));var f=function(){function e(){function e(e){return function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=l("diag");if(n)return n[e].apply(n,function(e,t,i){if(i||2===arguments.length)for(var n,s=0,o=t.length;s<o;s++)!n&&s in t||(n||(n=Array.prototype.slice.call(t,0,s)),n[s]=t[s]);return e.concat(n||Array.prototype.slice.call(t))}([],function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,s,o=i.call(e),r=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)r.push(n.value)}catch(e){s={error:e}}finally{try{n&&!n.done&&(i=o.return)&&i.call(o)}finally{if(s)throw s.error}}return r}(t),!1))}}var t=this;t.setLogger=function(e,i){var n,s,o;if(void 0===i&&(i={logLevel:h.INFO}),e===t){var r=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return t.error(null!==(n=r.stack)&&void 0!==n?n:r.message),!1}"number"==typeof i&&(i={logLevel:i});var a=l("diag"),$=function(e,t){function i(i,n){var s=t[i];return"function"==typeof s&&e>=n?s.bind(t):function(){}}return e<h.NONE?e=h.NONE:e>h.ALL&&(e=h.ALL),t=t||{},{error:i("error",h.ERROR),warn:i("warn",h.WARN),info:i("info",h.INFO),debug:i("debug",h.DEBUG),verbose:i("verbose",h.VERBOSE)}}(null!==(s=i.logLevel)&&void 0!==s?s:h.INFO,e);if(a&&!i.suppressOverrideMessage){var c=null!==(o=(new Error).stack)&&void 0!==o?o:"<failed to generate stacktrace>";a.warn("Current logger will be overwritten from "+c),$.warn("Current logger will overwrite one already registered from "+c)}return d("diag",$,t,!0)},t.disable=function(){u("diag",t)},t.createComponentLogger=function(e){return new p(e)},t.verbose=e("verbose"),t.debug=e("debug"),t.info=e("info"),t.warn=e("warn"),t.error=e("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}(),g=function(){function e(e){this._entries=e?new Map(e):new Map}return e.prototype.getEntry=function(e){var t=this._entries.get(e);if(t)return Object.assign({},t)},e.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map((function(e){var t=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,s,o=i.call(e),r=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)r.push(n.value)}catch(e){s={error:e}}finally{try{n&&!n.done&&(i=o.return)&&i.call(o)}finally{if(s)throw s.error}}return r}(e,2);return[t[0],t[1]]}))},e.prototype.setEntry=function(t,i){var n=new e(this._entries);return n._entries.set(t,i),n},e.prototype.removeEntry=function(t){var i=new e(this._entries);return i._entries.delete(t),i},e.prototype.removeEntries=function(){for(var t,i,n=[],s=0;s<arguments.length;s++)n[s]=arguments[s];var o=new e(this._entries);try{for(var r=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),a=r.next();!a.done;a=r.next()){var $=a.value;o._entries.delete($)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}return o},e.prototype.clear=function(){return new e},e}(),v=Symbol("BaggageEntryMetadata"),A=f.instance();function b(e){return void 0===e&&(e={}),new g(new Map(Object.entries(e)))}function w(e){return"string"!=typeof e&&(A.error("Cannot create baggage metadata from unknown type: "+typeof e),e=""),{__TYPE__:v,toString:function(){return e}}}function S(e){return Symbol.for(e)}var y,k,C=new function e(t){var i=this;i._currentContext=t?new Map(t):new Map,i.getValue=function(e){return i._currentContext.get(e)},i.setValue=function(t,n){var s=new e(i._currentContext);return s._currentContext.set(t,n),s},i.deleteValue=function(t){var n=new e(i._currentContext);return n._currentContext.delete(t),n}},_=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}],E=function(){function e(e){return function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];if(console){var n=console[e];if("function"!=typeof n&&(n=console.log),"function"==typeof n)return n.apply(console,t)}}}for(var t=0;t<_.length;t++)this[_[t].n]=e(_[t].c)},T=(y=function(e,t){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},y(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}y(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),I=function(){function e(){}return e.prototype.createHistogram=function(e,t){return F},e.prototype.createCounter=function(e,t){return N},e.prototype.createUpDownCounter=function(e,t){return V},e.prototype.createObservableGauge=function(e,t){return G},e.prototype.createObservableCounter=function(e,t){return U},e.prototype.createObservableUpDownCounter=function(e,t){return H},e.prototype.addBatchObservableCallback=function(e,t){},e.prototype.removeBatchObservableCallback=function(e){},e}(),P=function(){},j=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return T(t,e),t.prototype.add=function(e,t){},t}(P),R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return T(t,e),t.prototype.add=function(e,t){},t}(P),D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return T(t,e),t.prototype.record=function(e,t){},t}(P),x=function(){function e(){}return e.prototype.addCallback=function(e){},e.prototype.removeCallback=function(e){},e}(),M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return T(t,e),t}(x),L=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return T(t,e),t}(x),O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return T(t,e),t}(x),B=new I,N=new j,F=new D,V=new R,U=new M,G=new L,H=new O;function z(){return B}!function(e){e[e.INT=0]="INT",e[e.DOUBLE=1]="DOUBLE"}(k||(k={}));var W,K={get:function(e,t){if(null!=e)return e[t]},keys:function(e){return null==e?[]:Object.keys(e)}},J={set:function(e,t,i){null!=e&&(e[t]=i)}},q=function(){function e(){}return e.prototype.active=function(){return C},e.prototype.with=function(e,t,i){for(var n=[],s=3;s<arguments.length;s++)n[s-3]=arguments[s];return t.call.apply(t,function(e,t,i){if(i||2===arguments.length)for(var n,s=0,o=t.length;s<o;s++)!n&&s in t||(n||(n=Array.prototype.slice.call(t,0,s)),n[s]=t[s]);return e.concat(n||Array.prototype.slice.call(t))}([i],function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,s,o=i.call(e),r=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)r.push(n.value)}catch(e){s={error:e}}finally{try{n&&!n.done&&(i=o.return)&&i.call(o)}finally{if(s)throw s.error}}return r}(n),!1))},e.prototype.bind=function(e,t){return t},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}(),Y="context",X=new q,Q=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(e){return d(Y,e,f.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(e,t,i){for(var n,s=[],o=3;o<arguments.length;o++)s[o-3]=arguments[o];return(n=this._getContextManager()).with.apply(n,function(e,t,i){if(i||2===arguments.length)for(var n,s=0,o=t.length;s<o;s++)!n&&s in t||(n||(n=Array.prototype.slice.call(t,0,s)),n[s]=t[s]);return e.concat(n||Array.prototype.slice.call(t))}([e,t,i],function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,s,o=i.call(e),r=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)r.push(n.value)}catch(e){s={error:e}}finally{try{n&&!n.done&&(i=o.return)&&i.call(o)}finally{if(s)throw s.error}}return r}(s),!1))},e.prototype.bind=function(e,t){return this._getContextManager().bind(e,t)},e.prototype._getContextManager=function(){return l(Y)||X},e.prototype.disable=function(){this._getContextManager().disable(),u(Y,f.instance())},e}();!function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"}(W||(W={}));var Z="0000000000000000",ee="00000000000000000000000000000000",te={traceId:ee,spanId:Z,traceFlags:W.NONE},ie=function(){function e(e){void 0===e&&(e=te),this._spanContext=e}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(e,t){return this},e.prototype.setAttributes=function(e){return this},e.prototype.addEvent=function(e,t){return this},e.prototype.setStatus=function(e){return this},e.prototype.updateName=function(e){return this},e.prototype.end=function(e){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(e,t){},e}(),ne=S("OpenTelemetry Context Key SPAN");function se(e){return e.getValue(ne)||void 0}function oe(){return se(Q.getInstance().active())}function re(e,t){return e.setValue(ne,t)}function ae(e){return e.deleteValue(ne)}function $e(e,t){return re(e,new ie(t))}function ce(e){var t;return null===(t=se(e))||void 0===t?void 0:t.spanContext()}var de=/^([0-9a-f]{32})$/i,le=/^[0-9a-f]{16}$/i;function ue(e){return de.test(e)&&e!==ee}function he(e){return le.test(e)&&e!==Z}function pe(e){return ue(e.traceId)&&he(e.spanId)}function me(e){return new ie(e)}var fe,ge,ve,Ae=Q.getInstance(),be=function(){function e(){}return e.prototype.startSpan=function(e,t,i){if(void 0===i&&(i=Ae.active()),Boolean(null==t?void 0:t.root))return new ie;var n,s=i&&ce(i);return"object"==typeof(n=s)&&"string"==typeof n.spanId&&"string"==typeof n.traceId&&"number"==typeof n.traceFlags&&pe(s)?new ie(s):new ie},e.prototype.startActiveSpan=function(e,t,i,n){var s,o,r;if(!(arguments.length<2)){2===arguments.length?r=t:3===arguments.length?(s=t,r=i):(s=t,o=i,r=n);var a=null!=o?o:Ae.active(),$=this.startSpan(e,s,a),c=re(a,$);return Ae.with(c,r,void 0,$)}},e}(),we=new be,Se=function(){function e(e,t,i,n){this._provider=e,this.name=t,this.version=i,this.options=n}return e.prototype.startSpan=function(e,t,i){return this._getTracer().startSpan(e,t,i)},e.prototype.startActiveSpan=function(e,t,i,n){var s=this._getTracer();return Reflect.apply(s.startActiveSpan,s,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):we},e}(),ye=new(function(){function e(){}return e.prototype.getTracer=function(e,t,i){return new be},e}()),ke=function(){function e(){}return e.prototype.getTracer=function(e,t,i){var n;return null!==(n=this.getDelegateTracer(e,t,i))&&void 0!==n?n:new Se(this,e,t,i)},e.prototype.getDelegate=function(){var e;return null!==(e=this._delegate)&&void 0!==e?e:ye},e.prototype.setDelegate=function(e){this._delegate=e},e.prototype.getDelegateTracer=function(e,t,i){var n;return null===(n=this._delegate)||void 0===n?void 0:n.getTracer(e,t,i)},e}();!function(e){e[e.NOT_RECORD=0]="NOT_RECORD",e[e.RECORD=1]="RECORD",e[e.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(fe||(fe={})),function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"}(ge||(ge={})),function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}(ve||(ve={}));var Ce="[_0-9a-z-*/]",_e=new RegExp("^(?:[a-z]"+Ce+"{0,255}|[a-z0-9]"+Ce+"{0,240}@[a-z]"+Ce+"{0,13})$"),Ee=/^[ -~]{0,255}[!-~]$/,Te=/,|=/,Ie=function(){function e(e){this._internalState=new Map,e&&this._parse(e)}return e.prototype.set=function(e,t){var i=this._clone();return i._internalState.has(e)&&i._internalState.delete(e),i._internalState.set(e,t),i},e.prototype.unset=function(e){var t=this._clone();return t._internalState.delete(e),t},e.prototype.get=function(e){return this._internalState.get(e)},e.prototype.serialize=function(){var e=this;return this._keys().reduce((function(t,i){return t.push(i+"="+e.get(i)),t}),[]).join(",")},e.prototype._parse=function(e){e.length>512||(this._internalState=e.split(",").reverse().reduce((function(e,t){var i=t.trim(),n=i.indexOf("=");if(-1!==n){var s=i.slice(0,n),o=i.slice(n+1,t.length);(function(e){return _e.test(e)})(s)&&function(e){return Ee.test(e)&&!Te.test(e)}(o)&&e.set(s,o)}return e}),new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))},e.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},e.prototype._clone=function(){var t=new e;return t._internalState=new Map(this._internalState),t},e}();function Pe(e){return new Ie(e)}var je=Q.getInstance(),Re=f.instance(),De=new(function(){function e(){}return e.prototype.getMeter=function(e,t,i){return B},e}()),xe="metrics",Me=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalMeterProvider=function(e){return d(xe,e,f.instance())},e.prototype.getMeterProvider=function(){return l(xe)||De},e.prototype.getMeter=function(e,t,i){return this.getMeterProvider().getMeter(e,t,i)},e.prototype.disable=function(){u(xe,f.instance())},e}().getInstance(),Le=function(){function e(){}return e.prototype.inject=function(e,t){},e.prototype.extract=function(e,t){return e},e.prototype.fields=function(){return[]},e}(),Oe=S("OpenTelemetry Baggage Key");function Be(e){return e.getValue(Oe)||void 0}function Ne(){return Be(Q.getInstance().active())}function Fe(e,t){return e.setValue(Oe,t)}function Ve(e){return e.deleteValue(Oe)}var Ue="propagation",Ge=new Le,He=function(){function e(){this.createBaggage=b,this.getBaggage=Be,this.getActiveBaggage=Ne,this.setBaggage=Fe,this.deleteBaggage=Ve}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalPropagator=function(e){return d(Ue,e,f.instance())},e.prototype.inject=function(e,t,i){return void 0===i&&(i=J),this._getGlobalPropagator().inject(e,t,i)},e.prototype.extract=function(e,t,i){return void 0===i&&(i=K),this._getGlobalPropagator().extract(e,t,i)},e.prototype.fields=function(){return this._getGlobalPropagator().fields()},e.prototype.disable=function(){u(Ue,f.instance())},e.prototype._getGlobalPropagator=function(){return l(Ue)||Ge},e}(),ze=He.getInstance(),We="trace",Ke=function(){function e(){this._proxyTracerProvider=new ke,this.wrapSpanContext=me,this.isSpanContextValid=pe,this.deleteSpan=ae,this.getSpan=se,this.getActiveSpan=oe,this.getSpanContext=ce,this.setSpan=re,this.setSpanContext=$e}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(e){var t=d(We,this._proxyTracerProvider,f.instance());return t&&this._proxyTracerProvider.setDelegate(e),t},e.prototype.getTracerProvider=function(){return l(We)||this._proxyTracerProvider},e.prototype.getTracer=function(e,t){return this.getTracerProvider().getTracer(e,t)},e.prototype.disable=function(){u(We,f.instance()),this._proxyTracerProvider=new ke},e}().getInstance();const Je={context:je,diag:Re,metrics:Me,propagation:ze,trace:Ke}},990:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(842),s=i(482),o=i(277);class r{static async setup(e){if(!r._stream){const t=e.streamConfig.source;try{const i={...e,...e.streamConfig};if("gfn"===t)return r._stream=new s.default,r._stream.setup(e.streamConfig,e.onUpdate,e.onStart);if("local"===t)return r._stream=new n.default,r._stream.setup(i)}catch(e){throw{action:o.eAction.start,status:o.eStatus.error,info:e}}throw console.error(`Stream:init: ${t} is an invalid source`),{action:o.eAction.start,status:o.eStatus.error,info:TypeError(`Stream:init: '${t}' is an invalid source`)}}return{action:o.eAction.start,status:o.eStatus.inProgress,info:"Starting stream"}}static async sendMessage(e){try{if(r._stream)return setTimeout((()=>{var t;return null===(t=r._stream)||void 0===t?void 0:t.sendMessage(e)}),100),console.debug(`Sent message to GFN app: ${e}`),{action:o.eAction.message,status:o.eStatus.success,info:"Message was successfully sent."};{const e="There is no stream controller. Please call the setup method.";throw console.error(`Error sending message: ${e}`),{action:o.eAction.message,status:o.eStatus.error,info:e}}}catch(e){throw console.error("Error sending message: "+e),{action:o.eAction.message,status:o.eStatus.error,info:e}}}static async start(){if(r._stream)return r._stream.start();throw{action:o.eAction.start,status:o.eStatus.error,info:"There is no stream controller. Please call the setup method."}}static async stop(){if(r._stream)return r._stream.stop().then((e=>(r._stream=null,e)));throw{action:o.eAction.stop,status:o.eStatus.error,info:"There is no stream controller. Please call the setup method."}}static async terminate(){if(r._stream)return r._stream.terminate().then((e=>("success"===(null==e?void 0:e.status)&&(r._stream=null),e)));throw{action:o.eAction.terminate,status:o.eStatus.error,info:"There is no stream controller. Please call the setup method."}}}t.default=r},482:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(277);t.default=class{constructor(){this._GFN=null,this._catalogClientId="",this._clientId="",this._cmsId=-9999}async setup(e,t,i){return this._GFN=e.GFN,this._catalogClientId=e.catalogClientId,this._clientId=e.clientId,this._cmsId=e.cmsId,this._initialize().then((async()=>{var e,s;await this._login();const o=await this._GFN.server.getServerInfo();t({action:n.eAction.authUser,status:n.eStatus.success,info:null===(e=this._GFN.currentUser)||void 0===e?void 0:e.displayName}),await this._stream(null===(s=null==o?void 0:o.defaultZone)||void 0===s?void 0:s.address),console.debug("Started streaming"),this._GFN.streamer.on("started",(()=>{i({action:n.eAction.start,status:n.eStatus.success,info:"streamready"})})),this._GFN.streamer.on("message",(e=>{console.debug(`Received message from GFN app: ${e}`);const i=JSON.parse(e);Object.keys(i).forEach((e=>{t({action:n.eAction.update,status:n.eStatus.success,info:JSON.stringify({key:e,value:i[e]})})}))}))})).catch((e=>{throw{action:n.eAction.start,status:n.eStatus.error,info:e}})),{action:n.eAction.start,status:n.eStatus.inProgress,info:"Starting stream."}}async start(){throw new Error("GFNStreamer::start is not defined.")}async stop(){throw new Error("GFNStreamer::stop is not defined.")}async terminate(){throw new Error("GFNStreamer::terminate is not defined.")}sendMessage(e){try{this._GFN.streamer.sendMessage(e)}catch(e){console.error("Error sending message: "+e)}}async _initialize(){console.debug("initialize");const e=new this._GFN.Settings({clientId:this._clientId,catalogClientId:this._catalogClientId});try{await this._GFN.initialize(e),console.debug("gfn init finished")}catch(e){console.error(`GFN Initialization Failed: ${e.message}`)}}async _login(){console.debug("login");const e=this._GFN.auth.createLoginUrl();console.debug(`login ${e}`);try{await this._GFN.auth.loginWithBrowserPopup(e),console.debug("GFN Authorization Successful!"),console.debug(`GFN Logged in username: ${this._GFN.currentUser.displayName}`);const t=await this._GFN.server.getServerInfo();this._GFN.settings.vpcId||(this._GFN.settings.vpcId=t.vpcId)}catch(e){throw console.error(`GFN Authorization Failed: ${e.message}`),e}}async _stream(e){const t=this._cmsId,i=this._GFN.streamer.detectStreamingResolution(),n={server:e,appId:t,streamParams:{width:i.width,height:i.height,fps:60},authTokenCallback:async()=>this._GFN.currentUser.authInfo.idToken.value,windowElementId:"view"};return this._GFN.streamer.start(n).then((()=>{console.debug("streamer is starting...")})).catch((e=>{console.debug(`error while starting stream. ${e}`)}))}}},842:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(318),s=i(691),o=i(727),r=i(298),a=i(277),$="message-display",c="client";class d{async setup({videoElementId:e="remote-video",audioElementId:t="remote-audio",messageElementId:i=$,urlLocation:l=null,authenticate:u=!1,onUpdate:h=null,onStart:p=null,onStop:m=null,onTerminate:f=null,onISSOUpdate:g=null,onCustomEvent:v=null}){if(!l)throw"RagnarokStreamer::setup urlLocation is required.";try{d._searchParams=new URLSearchParams(l.search);const $=await(0,n.getPlatformDetails)();u||(l.search=l.search.replace("accessToken","accessTokenUnused")),d._ragnarokApp=new r.RagnarokApp({maxSessionStartRetry:5,platformDetails:$,videoElementId:e,audioElementId:t,messageElementId:i,urlLocation:l,authProvider:new s.DummyAuth,logBuffer:new o.LogBuffer(512e3),onSessionStartResult:p?(e,t)=>p(a.StreamEventConverter.convert(e,t)):null,onProgressUpdate:h?(e,t)=>h(a.StreamEventConverter.convert(e,t)):null,onStreamStopped:null,onActiveSessionResult:null,onStreamingEvent:null,onGetSessionResult:null,onISSOUpdate:g,onCustomEvent:v}),d._searchParams.get("autolaunch")&&await d._ragnarokApp.startButtonClick()}catch(e){throw o.Log.e(c,`Some error happened: ${null==e?void 0:e.name}, ${null==e?void 0:e.message}.`),{action:a.eAction.start,status:a.eStatus.error,info:e}}return{action:a.eAction.start,status:a.eStatus.inProgress,info:"Starting stream."}}sendMessage(e){const t={messageType:"json",messageRecipient:"kit",data:e};d._ragnarokApp.sendCustomMessage(t)}async stop(){try{return d._ragnarokApp.stopButtonClick(),{action:a.eAction.stop,status:a.eStatus.inProgress,info:"Stopping stream."}}catch(e){return{action:a.eAction.stop,status:a.eStatus.error,info:"Stopping stream."}}}async start(){try{return await d._ragnarokApp.startButtonClick(),{action:a.eAction.start,status:a.eStatus.inProgress,info:"Starting stream."}}catch(e){return{action:a.eAction.start,status:a.eStatus.error,info:e}}}async terminate(){const e=d._searchParams;if(confirm("Terminating session will destroy all associated resources and is irrecoverable, unsaved changes will be lost, do you confirm you want to terminate it?")){d._ragnarokApp.stopButtonClick(!1,!0);let t=e.get("terminateVerb")||"GET";if("GET"!==t&&"DELETE"!==t){let e=`Expect the HTTP verb used to terminate session to be either GET or DELETE, but received ${t} instead.`;return o.Log.e(c,e),void(document.getElementById($).textContent=e)}let i=null;if(i="DELETE"===t?await fetch(`${e.get("backendurl")}`,{method:t,headers:{Authorization:`Bearer ${e.get("accessToken")}`,accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:`${e.get("sessionid")}`})}):await fetch(`${e.get("backendurl")}/logout?session_id=${e.get("sessionid")}&server=${e.get("nucleus")}`,{method:t,headers:{Authorization:`Bearer ${e.get("accessToken")}`}}),200!==i.status){let t=null,n=null,s=null;try{t=await i.json(),s=t.message,n=`${i.status}: ${t}`}catch(e){n=`${i.status}: ${i.statusText} ${i.url}`}return o.Log.e(c,`Session termination failed due to '${s}'`),document.getElementById($).textContent=`Session termination failed due to '${s}', please contact maintainer for further debugging.`,{action:a.eAction.terminate,status:a.eStatus.error,info:n}}return document.getElementById($).textContent="Your session has been terminated, you can safely close this window now.",{action:a.eAction.terminate,status:a.eStatus.success,info:"Session has terminated"}}return{action:a.eAction.terminate,status:a.eStatus.canceled,info:"Termination has been cancelled"}}}t.default=d},277:(e,t)=>{"use strict";var i,n,s;Object.defineProperty(t,"__esModule",{value:!0}),t.StreamEventConverter=t.eStatus=t.eAction=void 0,function(e){e.unknown="unknown",e.active="active",e.configure="configure",e.connect="connect",e.get="get",e.start="start",e.stop="stop",e.stream="stream",e.terminate="terminate",e.update="update",e.message="message",e.authUser="authUser"}(i=t.eAction||(t.eAction={})),function(e){e.unknown="unknown",e.inProgress="inProgress",e.success="success",e.canceled="canceled",e.error="error",e.warning="warning",e.waiting="waiting"}(n=t.eStatus||(t.eStatus={})),function(e){e.sessionProgressUpdateEvent="SessionProgressUpdateEvent",e.streamingEvent="StreamingEvent",e.streamUpdateEvent="StreamUpdateEvent",e.startSessionResultEvent="StartSessionResultEvent",e.streamingTerminatedEvent="StreamingTerminatedEvent",e.activeSessionResultEvent="ActiveSessionResultEvent",e.getSessionResult="GetSessionResult"}(s||(s={}));class o{static convert(e,t){return t===s.sessionProgressUpdateEvent?o.fromSessionProgressUpdateEvent(e):t===s.activeSessionResultEvent?o.fromActiveSessionResultEvent(e):t===s.streamingEvent?o.fromStreamingEvent(e):t===s.streamUpdateEvent?o.fromStreamUpdateEvent(e):t===s.getSessionResult?o.fromGetSessionResult(e):t===s.streamingTerminatedEvent?o.fromStreamingTerminatedEvent(e):t===s.startSessionResultEvent?o.fromStartSessionResultEvent(e):{action:i.unknown,status:n.unknown,info:"An unknown event has occured."}}static fromSessionProgressUpdateEvent(e){const t="StartingStreamer"===e.state?i.start:"Configuring"===e.state?i.configure:"Connecting"===e.state?i.connect:i.unknown;return{action:t,status:n.inProgress,info:`${t}ing`,sessionId:e.sessionId,subSessionId:e.subSessionId,queuePosition:e.queuePosition,eta:e.eta}}static fromStartSessionResultEvent(e){var t;return{action:i.start,status:e.error?n.error:n.success,info:(null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.description)||"",sessionId:e.sessionId,subSessionId:e.subSessionId}}static fromStreamingEvent(e){return{action:i.stream,status:n.unknown,info:"streaming"}}static fromStreamUpdateEvent(e){return{action:i.update,status:n.unknown,info:"stat-update",stats:{fps:e.fps,rtd:e.rtd,avgDecodeTime:e.avgDecodeTime,frameLoss:e.frameLoss,packetLoss:e.packetLoss,totalBandwidth:e.totalBandwidth,utilizedBandwidth:e.utilizedBandwidth,streamingResolutionHeight:e.streamingResolution.height,streamingResolutionWidth:e.streamingResolution.width}}}static fromStreamingTerminatedEvent(e){return{action:i.terminate,status:n.unknown,info:"terminating",sessionId:e.sessionId,subSessionId:e.subSessionId}}static fromActiveSessionResultEvent(e){return{action:i.active,status:n.unknown,info:"active"}}static fromGetSessionResult(e){return{action:i.get,status:n.unknown,info:"streaming",sessionId:e.sessionId,subSessionId:e.subSessionId}}}t.StreamEventConverter=o},691:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DummyAuth=void 0,t.DummyAuth=class{setDataForLoginType(e){console.log("initializing dummy auth")}getLoginUrl(){return"error"}getUserName(){return"Local"}getUserId(){return"Local"}getExternalUserId(){return"Local"}getDeviceId(){return"Local"}getIdpId(){return"Local"}checkTokenValidity(){return Promise.resolve()}respondToRedirect(e){return Promise.resolve()}getTokenCallback(){return()=>Promise.resolve("dummy")}getAuthInfo(){return Promise.resolve({type:1,token:"dummy"})}logout(){console.log("logging out of dummy auth")}startOffDeviceLogin(){return Promise.resolve({verification_uri:"",user_code:"",device_code:"",expires_in:0,interval:0})}pollOffDeviceLogin(e){return Promise.resolve()}}},727:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Log=t.LogBuffer=void 0;const n=i(318);class s{constructor(e,t){this.encoder=new TextEncoder,this.logIndex=0,this.full=!1,this.buffer=new Uint8Array(e+s.FULL_MESSAGE.length),this.maxLength=e,this.logfile=t}clear(){this.encoder=new TextEncoder,this.logIndex=0,this.full=!1}log(e){if(this.full)return;let t=this.encoder.encode(e+"\n");this.logIndex+t.byteLength>this.maxLength&&(this.full=!0,t=this.encoder.encode(s.FULL_MESSAGE)),this.buffer.set(t,this.logIndex),this.logIndex+=t.byteLength}download(){const e=document.createElement("a");e.style.display="none";const t=new Blob([new DataView(this.buffer.buffer,0,this.logIndex)],{type:"text/plain"}),i=URL.createObjectURL(t);e.href=i,this.logfile?e.download=this.logfile:e.download=`omniverse-streaming-${(new Date).toISOString()}.log`,document.body.appendChild(e),e.click(),URL.revokeObjectURL(i),document.body.removeChild(e)}setIds(e,t){this.sessionId=e,this.subSessionId=t}}t.LogBuffer=s,s.FULL_MESSAGE="Log is full\n",t.Log=new n.LogImpl},298:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RagnarokApp=void 0;const n=i(318),s=i(727),o=i(641),r=i(277),a="client";t.RagnarokApp=class{constructor({maxSessionStartRetry:e,platformDetails:t,videoElementId:i,audioElementId:n,messageElementId:o,urlLocation:r,authProvider:$,logBuffer:c,onSessionStartResult:d,onProgressUpdate:l,onStreamStopped:u,onActiveSessionResult:h,onStreamingEvent:p,onGetSessionResult:m,onISSOUpdate:f,onCustomEvent:g}){this.tracksMap=new Map,this.totalTracks=0,this.hasPlatformBeenSimulated=!1,this.hasAppLaunchBeenSimulated=!1,this.micEnabled=!1,this.sessionStartRetryLeft=0,r=r||location,this.sessionStartParams={},this.sessionId="",this.sessionsToDelete=0,this.sessionStartRetryLeft=e,this.videoElement=document.getElementById(i),this.audioElement=document.getElementById(n),this.messageElement=document.getElementById(o),this.logBuffer=c,this.authProvider=$,this.errorMap=new Map,this.buildErrorMessageMap(),this.platformDetails=t,s.Log.i(a,`Platform details: ${this.platformDetails}`),this.instantiateGridApp(),this.setupHTMLElements(),this.queryParams=new URLSearchParams(r.search),this._onProgressUpdate=l,this._onSessionStartResult=d,this._onStreamStopped=u,this._onActiveSessionResult=h,this._onStreamingEvent=p,this._onGetSessionResult=m,this._onISSOUpdate=f,this._onCustomEvent=g,s.Log.addListener("Log",this.onLogEvent.bind(this))}setupHTMLElements(){this.audioElement&&(this.audioElement.muted=!0),this.videoElement.muted=!0,this.videoElement.playsInline=!0,this.videoElement.autoplay=!0,this.videoElement.tabIndex=-1,this.videoElement.addEventListener("contextmenu",(function(e){e.preventDefault()})),this.videoElement.addEventListener("keydown",this.keyUpDownEventHandler.bind(this)),this.videoElement.addEventListener("keyup",this.keyUpDownEventHandler.bind(this)),document.addEventListener("keydown",this.keyUpDownEventHandler.bind(this)),document.addEventListener("keyup",this.keyUpDownEventHandler.bind(this))}keyUpDownEventHandler(e){73==e.keyCode&&e.ctrlKey&&e.shiftKey||67==e.keyCode&&e.shiftKey&&e.metaKey||68==e.keyCode&&e.ctrlKey&&e.shiftKey||"Tab"==e.code&&e.altKey||"ZoomToggle"==e.code||"SelectTask"==e.code||"BrightnessDown"==e.code||"BrightnessUp"==e.code||"AudioVolumeMute"==e.code||"AudioVolumeDown"==e.code||"AudioVolumeUp"==e.code||e.keyCode>=48&&e.keyCode<=57||"Backspace"==e.code||e.preventDefault(),86==e.keyCode&&e.ctrlKey&&this.pasteClipboardText()}pasteClipboardText(){navigator.clipboard&&window.isSecureContext?navigator.clipboard.readText().then((e=>{e&&(s.Log.i(a,"Sent clipboard text to the server."),this.gridApp.sendTextInput((0,o.StringToUtf8)(e)))})).catch((e=>{s.Log.e(a,"Failed to read clipboard contents: "+e)})):s.Log.i(a,"Cannot read from clipboard because in insecure context.")}copyTextToClipboard(e){navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(e).then((()=>{s.Log.i(a,"Copied clipboard text from the server: "+e)})).catch((e=>{s.Log.e(a,"Failed to write clipboard contents: "+e)})):s.Log.i(a,"Cannot write to clipboard because in insecure context.")}getQueryParam(e){return this.queryParams.get(e)}onLogEvent(e){if(this.logBuffer)"DEBUG"!==e.logLevel&&this.logBuffer.log(`${e.timeStamp} ${e.logLevel} ${e.logModule}/${e.logtag} ${e.logstr}`);else switch(e.logLevel){case"INFO":console.log(`${e.timeStamp} ${e.logLevel} ${e.logModule}/${e.logtag} ${e.logstr}`);break;case"WARN":console.warn(`${e.timeStamp} ${e.logLevel} ${e.logModule}/${e.logtag} ${e.logstr}`);break;case"DEBUG":console.debug(`${e.timeStamp} ${e.logLevel} ${e.logModule}/${e.logtag} ${e.logstr}`);break;case"ERROR":console.error(`${e.timeStamp} ${e.logLevel} ${e.logModule}/${e.logtag} ${e.logstr}`)}}updateEventDataElements(){var e;null===(e=this.gridApp)||void 0===e||e.updateEventDataElements({commonData:{clientId:"78589530426925203",clientVer:"2.0.45.34",clientVariant:"Release",eventSchemaVer:"23.0",eventSysVer:"0.12.2",deviceId:this.authProvider.getDeviceId(),userId:this.authProvider.getUserId(),externalUserId:this.authProvider.getExternalUserId(),idpId:this.authProvider.getIdpId(),integrationId:"undefined",sessionId:"92774af7-fbc1-488f-a090-ba49cfd13da2",deviceOS:this.getMappedDeviceOS(this.platformDetails.os),deviceOSVersion:this.platformDetails.osVer,deviceType:this.getMappedDeviceType(this.platformDetails.deviceType),deviceMake:"APPLE",deviceModel:"undefined",clientType:"Browser",browserType:this.getMappedBrowserName(this.platformDetails.browser),platform:"Web",eventProtocol:"1.4",deviceGdprFuncOptIn:"Full",deviceGdprTechOptIn:"None",deviceGdprBehOptIn:"None",gdprFuncOptIn:"Full",gdprTechOptIn:"Full",gdprBehOptIn:"Full"},experiments:[{id:"6376d3bf-3f62-419d-989c-2955c25f2b4e",group:"ENABLE"},{id:"feb30a68-ee9a-44a0-a717-da2d28c81e97",group:"ENABLE"},{id:"ea128779-32c7-45c1-94c8-c9374d64219d",group:"ENABLE"},{id:"ac00061b-eb8d-4d6c-978a-f3ac96f8e91a",group:"ENABLE"},{id:"21f7e7af-b5ae-4c76-b269-3cc4351671d2",group:"ENABLE"},{id:"b205ded0-6c08-4436-b818-f0bde4633f08",group:"ENABLE"},{id:"d639ef8f-c6c5-4931-8e75-451e9e075c62",group:"ENABLE"},{id:"cdce276d-d611-4ef9-ba6f-a90c3e7040d4",group:"ENABLE"},{id:"4c57b739-c860-4c5e-b3e4-9d89ff91b561",group:"ENABLE"},{id:"86bf4cf1-b717-4f72-8414-0f40d6a32656",group:"ENABLE"}],config:{server:"https://events.gfestage.nvidia.com",version:"v1.0"},telemetryEventIds:{streamingProfileGuid:"testClientStreamingProfileGuid",systemInfoGuid:"testClientSystemInfoGuid"}})}getMappedBrowserName(e){switch(e){case"Chrome":return"Chrome";case"Safari":return"Safari";case"Yandex":return"Yandex";case"Edge":return"Edge";case"Edge_Legacy":return"Edge_legacy";case"Firefox":return"Firefox";case"Samsung":return"Samsung";case"Chromium":return"Chromium";case"Opera":return"Opera";case"Brave":return"Brave";case"Silk":return"Silk";default:return"undefined"}}getMappedDeviceType(e){let t="undefined";return"CONSOLE"===e?t="Console":"TABLET"===e?t="Tablet":"PHONE"===e?t="Phone":"TV"===e?t="TV":"LAPTOP"===e?t="Laptop":"DESKTOP"===e&&(t="Desktop"),t}getMappedDeviceOS(e){switch(e.toLowerCase()){case"windows":return"Windows";case"macosx":case"macos":return"MacOS";case"chromeos":case"chrome os":return"ChromeOS";case"linux":return"Linux";case"ios":return"iOS";case"ipados":return"iPadOS";case"tizen":return"Tizen";case"webos":return"WebOS";case"xbox":return"Xbox";default:return"undefined"}}setMessageElementValue(e,t=!1){this.messageElement.textContent=e}instantiateGridApp(){s.Log.i(a,"Instantiating grid app."),this.gridApp=new n.GridApp(this.platformDetails),this.gridApp.addListener("SessionStartResult",this.onSessionStartResult.bind(this)),this.gridApp.addListener("SessionStopResult",this.onSessionStopResult.bind(this)),this.gridApp.addListener("ActiveSessionsResult",this.onActiveSessionResult.bind(this)),this.gridApp.addListener("ProgressUpdate",this.onProgressUpdate.bind(this)),this.gridApp.addListener("StreamStopped",this.onStreamStopped.bind(this)),this.gridApp.addListener("StreamingEvent",this.onStreamingEvent.bind(this)),this.gridApp.addListener("GetSessionResult",this.onGetSessionResult.bind(this)),this.gridApp.addListener("CustomMessage",this.onCustomMessage.bind(this)),this.gridApp.addListener("StreamStatsUpdate",this.onISSOUpdate.bind(this)),this.gridApp.addListener("Log",this.onLogEvent.bind(this))}buildErrorMessageMap(){this.errorMap.set(3237085185,"Error happened during request to auth provider"),this.errorMap.set(3237089281,"No internet connection."),this.errorMap.set(3237089282,"A network error occurred."),this.errorMap.set(3237089283,"Error occurred due to GetActiveSessionServerError."),this.errorMap.set(3237089284,"Unexpected exception happened."),this.errorMap.set(3237093377,"Error occurred due to AuthTokenNotUpdated."),this.errorMap.set(3237093378,"Unexpected session state while polling."),this.errorMap.set(3237093379,"Failed to parse server response."),this.errorMap.set(3237093893,"Video play failure."),this.errorMap.set(3237093380,"Grid app instance was not initialized."),this.errorMap.set(3237093643,"Session Limit Exceeded."),this.errorMap.set(3237093889,"Some generic error happened in streamer."),this.errorMap.set(3237093890,"Error happened during signin request to signaling server."),this.errorMap.set(3237093891,"Error happened in hanging get request of peer connection."),this.errorMap.set(3237093894,"Could not find valid ice candidate pair."),this.errorMap.set(3237093895,"Streaming stopped as there is no remote peer."),this.errorMap.set(3237093896,"Streaming stopped due to input channel error."),this.errorMap.set(3237093897,"Streaming stopped due to cursor channel error."),this.errorMap.set(3237093898,"Streaming stopped due to control channel error."),this.errorMap.set(3237093906,"Reconnect attempt failed after network problem or remote peer not alive."),this.errorMap.set(3237093900,"Streaming stopped as NoVideoPacketsReceivedEver."),this.errorMap.set(3237093901,"Streaming stopped as NoVideoFramesLossyNetwork."),this.errorMap.set(15868672,"Stream Disconnected from server, unknown reason."),this.errorMap.set(3237094145,"Stream Disconnected from server, NoResponce."),this.errorMap.set(3237094146,"Stream Disconnected from server, RemoteInputError."),this.errorMap.set(3237094147,"Stream Disconnected from server, FrameGrabFailed."),this.errorMap.set(3237094148,"Stream Disconnected from server, ConfigUnAvailable."),this.errorMap.set(3237094149,"Stream Disconnected from server, InvalidCommand."),this.errorMap.set(3237094150,"Stream Disconnected from server, InvalidMouseState."),this.errorMap.set(3237094151,"Stream Disconnected from server, NetworkError."),this.errorMap.set(3237094152,"Stream Disconnected from server, GameLaunchFailed."),this.errorMap.set(3237094153,"Stream Disconnected from server, VideoFirstFrameSendFailed."),this.errorMap.set(3237094154,"Stream Disconnected from server, VideoNextFrameSendFailed."),this.errorMap.set(3237094155,"Stream Disconnected from server, FrameGrabTimedOut."),this.errorMap.set(3237094156,"Stream Disconnected from server, FrameEncodeTimedOut."),this.errorMap.set(3237094157,"Stream Disconnected from server, FrameSendTimedOut."),this.errorMap.set(15868704,"Stream Disconnected from server as user quit the game."),this.errorMap.set(15868706,"Stream Disconnected from server, userLoggedinDifferenAccount."),this.errorMap.set(15868707,"Stream Disconnected from server, WindowedMode."),this.errorMap.set(15868708,"Stream Disconnected from server, UserIdle."),this.errorMap.set(15868709,"Stream Disconnected from server, UnAuthorizedProcessDetected."),this.errorMap.set(15868710,"Stream Disconnected from server, MaliciousProcessDetected."),this.errorMap.set(15868711,"Stream Disconnected from server, UnKnownProcessDetected."),this.errorMap.set(15868712,"Stream Disconnected from server, MinerProcessDetected."),this.errorMap.set(15868713,"Stream Disconnected from server, StreamingUnsupported."),this.errorMap.set(15868714,"Stream Disconnected from server, AnotherClient."),this.errorMap.set(15868736,"Stream Disconnected from server, UnknownFromPm."),this.errorMap.set(15868737,"Stream Disconnected from server, UserEntitledMinutesExceeded."),this.errorMap.set(15868738,"Stream Disconnected from server, ClientReconnectTimeLimitExceeded."),this.errorMap.set(15868739,"Stream Disconnected from server, OperatorCommandedTermination."),this.errorMap.set(15868740,"Stream Disconnected from server, ConcurrentSessionLimitExceeded."),this.errorMap.set(15868741,"Stream Disconnected from server, MaxSessionTimeLimitExceeded."),this.errorMap.set(15868742,"Stream Disconnected from server, BifrostInitiatedSessionPause."),this.errorMap.set(15868743,"Stream Disconnected from server, SystemCommandTermination."),this.errorMap.set(15868744,"Stream Disconnected from server, MultipleLogin."),this.errorMap.set(3237093636,"Session setup failed on server."),this.errorMap.set(3237093642,"You've tried to play too many games in a short period of time. Please wait a few minutes and try again."),this.errorMap.set(3237093650,"You are not entitled to play this game. Please check you entitlement."),this.errorMap.set(3237093672,"One of the micro services on Zone failed. Please check telemetry for more details."),this.errorMap.set(3237093673,"Game is currently in patching state, please try again later."),this.errorMap.set(3237093674,"Requested game is not available in the zone. Please try another zone."),this.errorMap.set(3237093688,"Requested game is under maintenance."),this.errorMap.set(3237093693,"Required instance type for the game is not available in current zone. Please try different zone."),this.errorMap.set(3237093694,"Weve reached our limit for the number of gamers who can wait for the next available rig. Please try again later"),this.errorMap.set(3237093678,"Session setup request was terminated by another client."),this.errorMap.set(15868717,"Your session ended as you do not own the requested game."),this.errorMap.set(15867908,"Your session ended as device went to sleep during streaming"),this.errorMap.set(3237093701,"Session abandoned during polling"),this.errorMap.set(15868417,"Cannot connect to server."),this.errorMap.set(15868418,"Cannot connect to server.")}getDisplayableErrorMessage(e){return this.errorMap.has(e)?this.errorMap.get(e):`No displayable error message found for error code ${e}`}handleActiveSessions(e){for(let t=0;t<e.length;t++)if(this.sessionStartParams.appId==e[t].appId&&("ready_for_connection"==e[t].state||"streaming"==e[t].state||"paused"==e[t].state))return s.Log.i(a,"Existing session found with the appid "+e[t].appId+" and SessionState "+e[t].state),this.setMessageElementValue("Resuming previous session..."),2==this.sessionStartParams.appLaunchMode&&2!=e[t].appLaunchMode&&(this.sessionStartParams.appLaunchMode=0,s.Log.w(a,"session "+e[t].sessionId+" was not launched in touch friendly mode, ignoring touch input mode.")),void this.gridApp.resumeSession(this.sessionStartParams,e[t].sessionId);this.setMessageElementValue("Stopping existing sessions"),this.sessionsToDelete=e.length;for(let t=0;t<e.length;t++)this.gridApp.stopSession(e[t].sessionId)}resetTrackInfo(){this.totalTracks=0,this.tracksMap.clear()}playTrack(e,t){let i=t.play();const n=e=>{for(const i of t.srcObject.getTracks())this.tracksMap.set(i.id,e)};i?i.then((()=>{s.Log.i(a,`${e} play succeeded.`),t instanceof HTMLVideoElement&&this.gridApp.toggleUserInput(!0),n(!0)})).catch((t=>{s.Log.e(a,`${e} play error: ${null==t?void 0:t.name} , ${null==t?void 0:t.message}`),n(!1),this.gridApp.stopSession(this.sessionId),this.setMessageElementValue("Play failed",!0)})):(t instanceof HTMLVideoElement&&this.gridApp.toggleUserInput(!0),n(!0))}playMedia(){for(let e of this.startResult.streams)for(let t of e.tracks)"video"===t.kind&&this.videoElement.srcObject?this.playTrack(t.trackId,this.videoElement):"audio"===t.kind&&this.audioElement.srcObject&&this.playTrack(t.trackId,this.audioElement)}onSessionStartResult(e){if(this.lastSessionId=e.sessionId,this.lastSubSessionId=e.subSessionId,e.error)if(3237093643==e.error.code)e.sessionList?(s.Log.i(a,"Session limit reached. Number of active sessions: "+e.sessionList.length),e.sessionList.length&&this.handleActiveSessions(e.sessionList)):(this.setMessageElementValue("Checking for existing sessions.."),this.gridApp.getActiveSessions()),this.handleLogs(e.sessionId,e.subSessionId);else if(3237093682==e.error.code)this.setMessageElementValue("There is an active session for this device belonging to another user. Please try again after sometime"),this.handleLogs(e.sessionId,e.subSessionId);else if(15867905==e.error.code||15867906==e.error.code)this.setMessageElementValue("Session setup was cancelled, please reconfigure your session.",!0);else{let t=this.getDisplayableErrorMessage(e.error.code);if(this.sessionStartRetryLeft>0){let e=`\n                        Connection attempt failed with error message '${t}'. \n                        Number of retry left: ${this.sessionStartRetryLeft}. \n                        Retry in 5 seconds...`;s.Log.e(a,e),this.setMessageElementValue("Connection in progress..."),this.sessionStartRetryLeft-=1,window.setTimeout((()=>this.startButtonClick()),5e3)}else this.setMessageElementValue(t+" "+(0,o.GetHexString)(e.error.code),!0);this.handleLogs(e.sessionId,e.subSessionId)}else{s.Log.i(a,"client: successfully set up session: "+e.sessionId),s.Log.i(a,"Should enable mic: "+this.getGridApp().shouldDefaultEnableMic()),this.sessionId=e.sessionId,this.startResult=e,s.Log.i(a,"streams: "+JSON.stringify(this.startResult.streams));for(let e of this.startResult.streams)this.totalTracks+=e.tracks.length;this.playMedia()}this._onSessionStartResult&&this._onSessionStartResult(e,"StartSessionResultEvent")}handleLogs(e,t){this.logBuffer.setIds(e,t)}onSessionStopResult(e){this.lastSessionId=e.sessionId,this.lastSubSessionId=e.subSessionId,this.sessionId==e.sessionId?(this.sessionId="",e.framesDecoded>0?s.Log.i(a,"Session stop result is normal"):this.setMessageElementValue("Zero frame decoded.",!0)):this.sessionsToDelete>0&&(this.sessionsToDelete--,0===this.sessionsToDelete&&this.begin()),this.handleLogs(e.sessionId,e.subSessionId)}onProgressUpdate(e){s.Log.i(a,JSON.stringify(e));let t="Setting up your session. state: "+e.state;"StartingStreamer"==e.state?t="Starting streamer...":"Connecting"==e.state&&(t="Connecting to streamer..."),e.queuePosition&&(t+=". QueuePosition: "+e.queuePosition),e.eta>1e3&&(t+=". ETA "+Math.round(e.eta/1e3)+"seconds"),this._onProgressUpdate&&this._onProgressUpdate(e,"SessionProgressUpdateEvent"),this.setMessageElementValue(t)}onStreamStopped(e){if(this.lastSessionId=e.sessionId,this.lastSubSessionId=e.subSessionId,this.resetTrackInfo(),e.error){let t=this.getQueryParam("resume");if(15868704==e.error.code)this.setMessageElementValue("Server disconnected intended.",!0);else if(t&&e.isResumable)s.Log.i(a,"Resuming after 15 secs"),this.setMessageElementValue("Resuming after 15 secs..."),window.setTimeout((()=>this.gridApp.getActiveSessions()),15e3);else{let t=this.getDisplayableErrorMessage(e.error.code);this.setMessageElementValue(t+" "+(0,o.GetHexString)(e.error.code),!0)}}this._onStreamStopped&&this._onStreamStopped(e,"StreamingTerminatedEvent"),this.handleLogs(e.sessionId,e.subSessionId)}onActiveSessionResult(e){e.error?(s.Log.e(a,"ActiveSession request failed. Error: "+e.error.code.toString(16).toUpperCase()),this.setMessageElementValue("Get Active session failed",!0)):(s.Log.i(a,"ActiveSession request succeeded. Number of active sessions: "+e.sessionList.length),e.sessionList.length?this.handleActiveSessions(e.sessionList):this.begin()),this._onActiveSessionResult&&this._onActiveSessionResult(e,"ActiveSessionResultEvent")}onStreamingEvent(e){s.Log.i(a,"StreamingEvent event: "+JSON.stringify(e)),e.streamingState&&"reconnecting"===e.streamingState.state&&(this.setMessageElementValue("Reconnecting...",!0),this._onStreamingEvent&&this._onStreamingEvent(e,"StreamingEvent"))}onGetSessionResult(e){e.error?(s.Log.e(a,"Cannot resume: "+e.error.code),this.setMessageElementValue(e.error.description+": "+e.error.code,!0)):(s.Log.i(a,"onGetSessionResult state: "+e.state),"initializing"==e.state||"resuming"==e.state?window.setTimeout((()=>this.gridApp.getSession(e.sessionId)),1e3):"ready_for_connection"==e.state&&this.gridApp.resumeSession(this.sessionStartParams,e.sessionId)),this._onGetSessionResult&&this._onGetSessionResult(e,"GetSessionResult")}sendCustomMessage(e){s.Log.i(a,JSON.stringify(e)),this.gridApp.sendCustomMessage(e)}onCustomMessage(e){this._onCustomEvent?(s.Log.i(a,JSON.stringify(e)),this._onCustomEvent(e)):s.Log.i(a,JSON.stringify({action:r.eAction.message,status:r.eStatus.warning,info:"Stream sent a custom message, but client has not provided an onCustomEvent handler method."}))}onISSOUpdate(e){this._onISSOUpdate&&this._onISSOUpdate(e,"StreamUpdateEvent")}downloadLogs(){this.logBuffer.download()}downloadAudioRecordings(){var e;null===(e=this.gridApp)||void 0===e||e.downloadAudio()}getPlatformOverride(e,t,i,n,s){return"clientplatformname="+e+"&clienttype="+t+"&deviceos="+i+"&devicetype="+n+"&clientstreamer="+s}getPlatformAndAppLaunchOverrides(e,t){let i,n=this.queryParams.toString(),s="";switch(e){case 0:this.hasPlatformBeenSimulated&&this.getPlatformOverride("","","","","");break;case 1:s=this.getPlatformOverride("Windows","NATIVE","WINDOWS","DESKTOP","NVIDIA-CLASSIC");break;case 2:s=this.getPlatformOverride("MacOSX","NATIVE","MACOS","DESKTOP","NVIDIA-CLASSIC");break;case 3:s=this.getPlatformOverride("Linux","NATIVE","ANDROID","TABLET","NVIDIA-CLASSIC");break;case 4:s=this.getPlatformOverride("browser","BROWSER","IOS","PHONE","WEBRTC");break;case 5:s=this.getPlatformOverride("browser","BROWSER","IPADOS","TABLET","WEBRTC");break;case 6:s=this.getPlatformOverride("browser","BROWSER","CHROMEOS","DESKTOP","WEBRTC");break;case 7:s=this.getPlatformOverride("browser","BROWSER","WINDOWS","DESKTOP","WEBRTC");break;case 8:s=this.getPlatformOverride("browser","BROWSER","MACOS","DESKTOP","WEBRTC");break;case 9:s=this.getPlatformOverride("browser","BROWSER","LINUX","DESKTOP","WEBRTC");break;case 10:s=this.getPlatformOverride("browser","BROWSER","WEBOS","TV","WEBRTC");break;case 11:s=this.getPlatformOverride("browser","BROWSER","TIZEN","TV","WEBRTC");break;case 12:s=this.getPlatformOverride("browser","BROWSER","XBOX","CONSOLE","WEBRTC")}switch(s&&(this.hasPlatformBeenSimulated=!0,n+=s+"&"),t){case 0:this.hasAppLaunchBeenSimulated&&(i=0);break;case 1:i=0;break;case 2:i=2;break;case 3:i=1}return void 0!==i&&(this.hasAppLaunchBeenSimulated=!0,n+="applaunchmode="+i+"&"),n+"webrtcstreamer=enable"}configureGridApp(e){return new Promise(((t,i)=>{this.updateEventDataElements();let n="";"undefined"!=typeof Storage&&(n=localStorage.getItem("deviceid"));let o,r={serverAddress:e,authTokenCallback:this.authProvider.getTokenCallback(),deviceHashId:n,clientShutDownCallback:void 0};switch(this.getQueryParam("cursor")){case"hw":o=1;break;case"free":o=2;break;case"sw":o=0;default:o=2}let $={cursorType:o,allowUnconfined:null!==this.getQueryParam("allowunconfined")};s.Log.i(a,"initializing gridApp with server: "+r.serverAddress),this.gridApp.initialize(r,$)?this.authProvider.getAuthInfo().then((e=>{this.gridApp.setAuthInfo(e),t()})).catch((()=>{i()})):i()}))}getGridApp(){return this.gridApp}begin(){this.gridApp.startSession(this.sessionStartParams)}async startButtonClick(){let e=this.getPlatformAndAppLaunchOverrides(0,0);const t={remoteConfigData:{ragnarok:'{"connectivityCheckTimeout": 2000, "sleepErrorsStreaming": ["0xC0F2230F"]}'},gxtOverrideData:JSON.stringify({params:[{name:"ragnarok",value:{enableCpm:!1}}]}),overrideData:e};(0,n.ConfigureRagnarokSettings)(t);let i=this.getQueryParam("server");try{let e=this.getQueryParam("resolution").split(":"),t=(0,o.ToNumber)(this.getQueryParam("fps"));const r="0";let $="en-US";"undefined"!=typeof Storage&&(localStorage.setItem("server",i),localStorage.setItem("fps",String(t)),localStorage.setItem("kbLayout",$),localStorage.setItem("bitrate",r)),this.configureGridApp(i).then((()=>{s.Log.i(a,"grid app setup completed");const c=(0,o.IsiDevice)(this.platformDetails);this.sessionStartParams={streamParams:[],appLaunchMode:c?2:0,keyboardLayout:$,shortName:"Omniverse App Streaming",accountLinked:!1};let d=parseInt(e[0]),l=parseInt(e[1]),u=t;const h=parseInt(r);if(!d||!l){const e=[{resolution:{width:3840,height:2160},frameRate:60},{resolution:{width:3440,height:1440},frameRate:60},{resolution:{width:2560,height:1600},frameRate:120},{resolution:{width:2560,height:1600},frameRate:60},{resolution:{width:2560,height:1440},frameRate:120},{resolution:{width:2560,height:1440},frameRate:60},{resolution:{width:1920,height:1200},frameRate:60},{resolution:{width:1920,height:1080},frameRate:60},{resolution:{width:1920,height:1080},frameRate:30},{resolution:{width:1920,height:1080},frameRate:120},{resolution:{width:1680,height:1050},frameRate:60},{resolution:{width:1600,height:900},frameRate:60},{resolution:{width:1280,height:1024},frameRate:60},{resolution:{width:1440,height:900},frameRate:60},{resolution:{width:1366,height:768},frameRate:60},{resolution:{width:1280,height:800},frameRate:60},{resolution:{width:1280,height:720},frameRate:60},{resolution:{width:1600,height:1200},frameRate:60},{resolution:{width:1112,height:834},frameRate:60},{resolution:{width:1024,height:768},frameRate:60},{resolution:{width:960,height:540},frameRate:60}],t=(0,n.ChooseStreamingSettings)(0,e,this.platformDetails);d=t.resolution.width,l=t.resolution.height,s.Log.i(a,"Recommended stream settings: "+d+"x"+l+"@"+t.frameRate),s.Log.i(a,"Capable stream settings: "+e)}this.sessionStartParams.streamParams.push({width:d,height:l,fps:u,maxBitrateKbps:h,drc:!1,videoTagId:this.videoElement.id,audioTagId:this.audioElement.id});const p=this.getQueryParam("signalingserver");let m=[];if(p){const e=parseInt(this.getQueryParam("signalingport")),t=(0,o.IsValidIPv4)(p)?2:5;m.push({ip:p,port:e,usage:14,appLevelProtocol:t,protocol:1})}const f=this.getQueryParam("mediaserver");if(f)if((0,o.IsIPv4Address)(f)&&!(0,o.IsValidIPv4)(f))s.Log.e(a,"mediaserver query parameter is not a valid IP. value: "+f);else{const e=parseInt(this.getQueryParam("mediaport"));m.push({ip:f,port:e,usage:2,appLevelProtocol:0,protocol:2})}if(i)this.sessionStartParams.connectionInfo=void 0,this.sessionStartParams.sessionId=void 0;else{if(!m.length){const e="Signaling server info is required in passthru use case. Please add signalingserver=<> to the query parameters";return void this.setMessageElementValue(e,!0)}this.sessionStartParams.connectionInfo=m;const e=this.getQueryParam("sessionid");e&&(this.sessionStartParams.sessionId=e)}this.sessionStartParams.accessToken=this.getQueryParam("accessToken")||"",s.Log.i(a,"Beginning"),this.begin()})).catch((e=>{const t=`Something unexpected happened: ${null==e?void 0:e.name} ${null==e?void 0:e.message}`;s.Log.e(a,t),this.setMessageElementValue(t,!0)}))}catch(e){s.Log.e(a,"Exception in start button click: "+e)}}stopButtonClick(e=!1,t=!1){this.resetTrackInfo(),this.sessionId&&(e?this.gridApp.pauseSession(this.sessionId):this.gridApp.stopSession(this.sessionId)),this.setMessageElementValue("Session is stopped.")}}},641:(e,t)=>{"use strict";function i(e){return e>>>0}function n(e){return"iPadOS"===e.os}function s(e){return"iOS"===e.os}Object.defineProperty(t,"__esModule",{value:!0}),t.KeyUpDownEventHandler=t.StringToUtf8=t.ToNumber=t.IsiDevice=t.IsiOS=t.IsTizen=t.IsWebOS=t.IsiPadOS=t.IsXbox=t.IsValidIPv4=t.IsIPv4Address=t.GetRandNumericString=t.GetHexString=t.convertToUnsignedInt=void 0,t.convertToUnsignedInt=i,t.GetHexString=function(e){return"0x"+("00000000"+(e=i(e)).toString(16).toUpperCase()).slice(-8)},t.GetRandNumericString=function(e){let t=1;for(let i=1;i<e;i++)t*=10;let i=""+Math.floor(Math.random()*t);return i=i.padEnd(e,"0"),i},t.IsIPv4Address=function(e){const t=e.split(".");if(4!==t.length)return!1;for(const e of t){const t=parseInt(e);if(isNaN(t))return!1}return!0},t.IsValidIPv4=function(e){const t=e.split(".");if(4!==t.length)return!1;for(const e of t){const t=parseInt(e);if(isNaN(t)||t<0||t>255)return!1}return!0},t.IsXbox=function(e){return"Xbox"===e.os},t.IsiPadOS=n,t.IsWebOS=function(e){return"WebOS"===e.os},t.IsTizen=function(e){return"Tizen"===e.os},t.IsiOS=s,t.IsiDevice=function(e){return s(e)||n(e)},t.ToNumber=function(e){if(e){const t=Number.parseInt(e);if(!Number.isNaN(t))return t}},t.StringToUtf8=function(e){let t=(new TextEncoder).encode(e),i=new ArrayBuffer(t.byteLength),n=new DataView(i);for(let e=0;e<t.byteLength;e++)n.setUint8(e,t[e]);return i},t.KeyUpDownEventHandler=function(e){73==e.keyCode&&e.ctrlKey&&e.shiftKey||67==e.keyCode&&e.shiftKey&&e.metaKey||68==e.keyCode&&e.ctrlKey&&e.shiftKey||"Tab"==e.code&&e.altKey||"ZoomToggle"==e.code||"SelectTask"==e.code||"BrightnessDown"==e.code||"BrightnessUp"==e.code||"AudioVolumeMute"==e.code||"AudioVolumeDown"==e.code||"AudioVolumeUp"==e.code||e.keyCode>=48&&e.keyCode<=57||"Backspace"==e.code||e.preventDefault()}}},t={};function i(n){var s=t[n];if(void 0!==s)return s.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,i),o.exports}i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};return(()=>{"use strict";var e=n;Object.defineProperty(e,"__esModule",{value:!0}),e.eStatus=e.eAction=e.AppStreamer=void 0;const t=i(990);e.AppStreamer=t.default;const s=i(277);Object.defineProperty(e,"eAction",{enumerable:!0,get:function(){return s.eAction}}),Object.defineProperty(e,"eStatus",{enumerable:!0,get:function(){return s.eStatus}})})(),n})()));